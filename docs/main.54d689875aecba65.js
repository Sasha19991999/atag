"use strict";(self.webpackChunkwashing_machine_viewer=self.webpackChunkwashing_machine_viewer||[]).push([[179],{41:()=>{function It(n){return"function"==typeof n}function gl(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const yu=gl(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function To(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class ti{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(It(i))try{i()}catch(s){e=s instanceof yu?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{d0(s)}catch(o){e=e??[],o instanceof yu?e=[...e,...o.errors]:e.push(o)}}if(e)throw new yu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)d0(e);else{if(e instanceof ti){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&To(t,e)}remove(e){const{_finalizers:t}=this;t&&To(t,e),e instanceof ti&&e._removeParent(this)}}ti.EMPTY=(()=>{const n=new ti;return n.closed=!0,n})();const c0=ti.EMPTY;function u0(n){return n instanceof ti||n&&"closed"in n&&It(n.remove)&&It(n.add)&&It(n.unsubscribe)}function d0(n){It(n)?n():n.unsubscribe()}const Ss={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},vu={setTimeout(n,e,...t){const{delegate:i}=vu;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=vu;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function h0(n){vu.setTimeout(()=>{const{onUnhandledError:e}=Ss;if(!e)throw n;e(n)})}function f0(){}const VA=Cf("C",void 0,void 0);function Cf(n,e,t){return{kind:n,value:e,error:t}}let Es=null;function _u(n){if(Ss.useDeprecatedSynchronousErrorHandling){const e=!Es;if(e&&(Es={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Es;if(Es=null,t)throw i}}else n()}class Tf extends ti{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,u0(e)&&e.add(this)):this.destination=XA}static create(e,t,i){return new yl(e,t,i)}next(e){this.isStopped?If(function GA(n){return Cf("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?If(function HA(n){return Cf("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?If(VA,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const jA=Function.prototype.bind;function Af(n,e){return jA.call(n,e)}class $A{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){xu(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){xu(i)}else xu(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){xu(t)}}}class yl extends Tf{constructor(e,t,i){let r;if(super(),It(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&Ss.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Af(e.next,s),error:e.error&&Af(e.error,s),complete:e.complete&&Af(e.complete,s)}):r=e}this.destination=new $A(r)}}function xu(n){Ss.useDeprecatedSynchronousErrorHandling?function WA(n){Ss.useDeprecatedSynchronousErrorHandling&&Es&&(Es.errorThrown=!0,Es.error=n)}(n):h0(n)}function If(n,e){const{onStoppedNotification:t}=Ss;t&&vu.setTimeout(()=>t(n,e))}const XA={closed:!0,next:f0,error:function qA(n){throw n},complete:f0},Rf="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ds(n){return n}function p0(n){return 0===n.length?Ds:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Qt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function KA(n){return n&&n instanceof Tf||function ZA(n){return n&&It(n.next)&&It(n.error)&&It(n.complete)}(n)&&u0(n)}(t)?t:new yl(t,i,r);return _u(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=m0(i))((r,s)=>{const o=new yl({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Rf](){return this}pipe(...t){return p0(t)(this)}toPromise(t){return new(t=m0(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function m0(n){var e;return null!==(e=n??Ss.Promise)&&void 0!==e?e:Promise}const JA=gl(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let yr=(()=>{class n extends Qt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new g0(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new JA}next(t){_u(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){_u(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){_u(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?c0:(this.currentObservers=null,s.push(t),new ti(()=>{this.currentObservers=null,To(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Qt;return t.source=this,t}}return n.create=(e,t)=>new g0(e,t),n})();class g0 extends yr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:c0}}function y0(n){return It(n?.lift)}function pn(n){return e=>{if(y0(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function mn(n,e,t,i,r){return new QA(n,e,t,i,r)}class QA extends Tf{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function ct(n,e){return pn((t,i)=>{let r=0;t.subscribe(mn(i,s=>{i.next(n.call(e,s,r++))}))})}function Cs(n){return this instanceof Cs?(this.v=n,this):new Cs(n)}function i1(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function x0(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const w0=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function b0(n){return It(n?.then)}function M0(n){return It(n[Rf])}function S0(n){return Symbol.asyncIterator&&It(n?.[Symbol.asyncIterator])}function E0(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const D0=function s1(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function C0(n){return It(n?.[D0])}function T0(n){return function n1(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(m,p){s.push([h,f,m,p])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof Cs?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(m){d(s[0][3],m)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Cs(t.read());if(r)return yield Cs(void 0);yield yield Cs(i)}}finally{t.releaseLock()}})}function A0(n){return It(n?.getReader)}function Pi(n){if(n instanceof Qt)return n;if(null!=n){if(M0(n))return function o1(n){return new Qt(e=>{const t=n[Rf]();if(It(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(w0(n))return function a1(n){return new Qt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(b0(n))return function l1(n){return new Qt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,h0)})}(n);if(S0(n))return I0(n);if(C0(n))return function c1(n){return new Qt(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(A0(n))return function u1(n){return I0(T0(n))}(n)}throw E0(n)}function I0(n){return new Qt(e=>{(function d1(n,e){var t,i,r,s;return function e1(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=i1(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function vr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function xn(n,e,t=1/0){return It(e)?xn((i,r)=>ct((s,o)=>e(i,s,r,o))(Pi(n(i,r))),t):("number"==typeof e&&(t=e),pn((i,r)=>function h1(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=p=>c<i?m(p):l.push(p),m=p=>{s&&e.next(p),c++;let g=!1;Pi(t(p,u++)).subscribe(mn(e,v=>{r?.(v),s?f(v):e.next(v)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<i;){const v=l.shift();o?vr(e,o,()=>m(v)):m(v)}h()}catch(v){e.error(v)}}))};return n.subscribe(mn(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function Ao(n=1/0){return xn(Ds,n)}const Zi=new Qt(n=>n.complete());function R0(n){return n&&It(n.schedule)}function Lf(n){return n[n.length-1]}function vl(n){return R0(Lf(n))?n.pop():void 0}function P0(n,e=0){return pn((t,i)=>{t.subscribe(mn(i,r=>vr(i,n,()=>i.next(r),e),()=>vr(i,n,()=>i.complete(),e),r=>vr(i,n,()=>i.error(r),e)))})}function L0(n,e=0){return pn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function N0(n,e){if(!n)throw new Error("Iterable cannot be null");return new Qt(t=>{vr(t,e,()=>{const i=n[Symbol.asyncIterator]();vr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function an(n,e){return e?function w1(n,e){if(null!=n){if(M0(n))return function g1(n,e){return Pi(n).pipe(L0(e),P0(e))}(n,e);if(w0(n))return function v1(n,e){return new Qt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(b0(n))return function y1(n,e){return Pi(n).pipe(L0(e),P0(e))}(n,e);if(S0(n))return N0(n,e);if(C0(n))return function _1(n,e){return new Qt(t=>{let i;return vr(t,e,()=>{i=n[D0](),vr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>It(i?.return)&&i.return()})}(n,e);if(A0(n))return function x1(n,e){return N0(T0(n),e)}(n,e)}throw E0(n)}(n,e):Pi(n)}function Nf(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new yl({next:()=>{i.unsubscribe(),n()}});return Pi(e(...t)).subscribe(i)}function Tt(n){for(let e in n)if(n[e]===Tt)return e;throw Error("Could not find renamed property on target object.")}function Rt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Rt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Ff(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const S1=Tt({__forward_ref__:Tt});function kf(n){return n.__forward_ref__=kf,n.toString=function(){return Rt(this())},n}function Ve(n){return Bf(n)?n():n}function Bf(n){return"function"==typeof n&&n.hasOwnProperty(S1)&&n.__forward_ref__===kf}function Uf(n){return n&&!!n.\u0275providers}class de extends Error{constructor(e,t){super(wu(e,t)),this.code=e}}function wu(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}function wt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():function Ye(n){return"string"==typeof n?n:null==n?"":String(n)}(n)}function bu(n,e){throw new de(-201,!1)}function yi(n,e){null==n&&function bt(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ge(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Yr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Mu(n){return F0(n,Su)||F0(n,B0)}function F0(n,e){return n.hasOwnProperty(e)?n[e]:null}function k0(n){return n&&(n.hasOwnProperty(zf)||n.hasOwnProperty(L1))?n[zf]:null}const Su=Tt({\u0275prov:Tt}),zf=Tt({\u0275inj:Tt}),B0=Tt({ngInjectableDef:Tt}),L1=Tt({ngInjectorDef:Tt});var He=(()=>((He=He||{})[He.Default=0]="Default",He[He.Host=1]="Host",He[He.Self=2]="Self",He[He.SkipSelf=4]="SkipSelf",He[He.Optional=8]="Optional",He))();let Vf;function vi(n){const e=Vf;return Vf=n,e}function U0(n,e,t){const i=Mu(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&He.Optional?null:void 0!==e?e:void bu(Rt(n))}const Nt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),_l={},Hf="__NG_DI_FLAG__",Eu="ngTempTokenPath",O1="ngTokenPath",F1=/\n/gm,k1="\u0275",z0="__source";let xl;function Io(n){const e=xl;return xl=n,e}function B1(n,e=He.Default){if(void 0===xl)throw new de(-203,!1);return null===xl?U0(n,void 0,e):xl.get(n,e&He.Optional?null:void 0,e)}function Fe(n,e=He.Default){return(function N1(){return Vf}()||B1)(Ve(n),e)}function dt(n,e=He.Default){return Fe(n,Du(e))}function Du(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Gf(n){const e=[];for(let t=0;t<n.length;t++){const i=Ve(n[t]);if(Array.isArray(i)){if(0===i.length)throw new de(900,!1);let r,s=He.Default;for(let o=0;o<i.length;o++){const a=i[o],l=U1(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Fe(r,s))}else e.push(Fe(i))}return e}function wl(n,e){return n[Hf]=e,n.prototype[Hf]=e,n}function U1(n){return n[Hf]}function Zr(n){return{toString:n}.toString()}var Li=(()=>((Li=Li||{})[Li.OnPush=0]="OnPush",Li[Li.Default=1]="Default",Li))(),Ki=(()=>{return(n=Ki||(Ki={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Ki;var n})();const _r={},xt=[],Cu=Tt({\u0275cmp:Tt}),Wf=Tt({\u0275dir:Tt}),jf=Tt({\u0275pipe:Tt}),H0=Tt({\u0275mod:Tt}),xr=Tt({\u0275fac:Tt}),bl=Tt({__NG_ELEMENT_ID__:Tt});let H1=0;function Ml(n){return Zr(()=>{const t=!0===n.standalone,i={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Li.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||xt,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Ki.Emulated,id:"c"+H1++,styles:n.styles||xt,_:null,setInput:null,schemas:n.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},s=n.dependencies,o=n.features;return r.inputs=j0(n.inputs,i),r.outputs=j0(n.outputs),o&&o.forEach(a=>a(r)),r.directiveDefs=s?()=>("function"==typeof s?s():s).map(G0).filter(W0):null,r.pipeDefs=s?()=>("function"==typeof s?s():s).map(kn).filter(W0):null,r})}function G0(n){return Mt(n)||En(n)}function W0(n){return null!==n}function Ts(n){return Zr(()=>({type:n.type,bootstrap:n.bootstrap||xt,declarations:n.declarations||xt,imports:n.imports||xt,exports:n.exports||xt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function j0(n,e){if(null==n)return _r;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const Fn=Ml;function Mt(n){return n[Cu]||null}function En(n){return n[Wf]||null}function kn(n){return n[jf]||null}function ii(n,e){const t=n[H0]||null;if(!t&&!0===e)throw new Error(`Type ${Rt(n)} does not have '\u0275mod' property.`);return t}const wr=0,be=1,et=2,zt=3,Ni=4,As=5,Dn=6,Po=7,jt=8,Tu=9,Au=10,nt=11,$f=12,Sl=13,$0=14,Lo=15,Cn=16,El=17,No=18,Ji=19,Dl=20,q0=21,Ot=22,qf=1,X0=2,Iu=7,Ru=8,Oo=9,Bn=10;function ri(n){return Array.isArray(n)&&"object"==typeof n[qf]}function Oi(n){return Array.isArray(n)&&!0===n[qf]}function Xf(n){return 0!=(4&n.flags)}function Cl(n){return n.componentOffset>-1}function Pu(n){return 1==(1&n.flags)}function Fi(n){return null!==n.template}function j1(n){return 0!=(256&n[et])}function Is(n,e){return n.hasOwnProperty(xr)?n[xr]:null}class X1{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Rs(){return K0}function K0(n){return n.type.prototype.ngOnChanges&&(n.setInput=Z1),Y1}function Y1(){const n=Q0(this),e=n?.current;if(e){const t=n.previous;if(t===_r)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function Z1(n,e,t,i){const r=this.declaredInputs[t],s=Q0(n)||function K1(n,e){return n[J0]=e}(n,{previous:_r,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[r];o[r]=new X1(l&&l.currentValue,e,a===_r),n[i]=e}Rs.ngInherit=!0;const J0="__ngSimpleChanges__";function Q0(n){return n[J0]||null}const _i=function(n,e,t){};function wn(n){for(;Array.isArray(n);)n=n[wr];return n}function si(n,e){return wn(e[n.index])}function n_(n,e){return n.data[e]}function oi(n,e){const t=e[n];return ri(t)?t:t[wr]}function Nu(n){return 64==(64&n[et])}function Kr(n,e){return null==e?null:n[e]}function i_(n){n[No]=0}function Zf(n,e){n[As]+=e;let t=n,i=n[zt];for(;null!==i&&(1===e&&1===t[As]||-1===e&&0===t[As]);)i[As]+=e,t=i,i=i[zt]}const Ze={lFrame:f_(null),bindingsEnabled:!0};function s_(){return Ze.bindingsEnabled}function K(){return Ze.lFrame.lView}function ht(){return Ze.lFrame.tView}function bn(){let n=o_();for(;null!==n&&64===n.type;)n=n.parent;return n}function o_(){return Ze.lFrame.currentTNode}function Qi(n,e){const t=Ze.lFrame;t.currentTNode=n,t.isParent=e}function Kf(){return Ze.lFrame.isParent}function hI(n,e){const t=Ze.lFrame;t.bindingIndex=t.bindingRootIndex=n,Qf(e)}function Qf(n){Ze.lFrame.currentDirectiveIndex=n}function u_(){return Ze.lFrame.currentQueryIndex}function tp(n){Ze.lFrame.currentQueryIndex=n}function pI(n){const e=n[be];return 2===e.type?e.declTNode:1===e.type?n[Dn]:null}function d_(n,e,t){if(t&He.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&He.Host||(r=pI(s),null===r||(s=s[Lo],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Ze.lFrame=h_();return i.currentTNode=e,i.lView=n,!0}function np(n){const e=h_(),t=n[be];Ze.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function h_(){const n=Ze.lFrame,e=null===n?null:n.child;return null===e?f_(n):e}function f_(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function p_(){const n=Ze.lFrame;return Ze.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const m_=p_;function ip(){const n=p_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function zn(){return Ze.lFrame.selectedIndex}function Ps(n){Ze.lFrame.selectedIndex=n}function Ou(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function Fu(n,e,t){g_(n,e,3,t)}function ku(n,e,t,i){(3&n[et])===t&&g_(n,e,t,i)}function rp(n,e){let t=n[et];(3&t)===e&&(t&=2047,t+=1,n[et]=t)}function g_(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[No]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[No]+=65536),(a<s||-1==s)&&(MI(n,t,e,l),n[No]=(4294901760&n[No])+l+2),l++}function MI(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[et]>>11<n[No]>>16&&(3&n[et])===e){n[et]+=2048,_i(4,a,s);try{s.call(a)}finally{_i(5,a,s)}}}else{_i(4,a,s);try{s.call(a)}finally{_i(5,a,s)}}}const Bo=-1;class Al{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function op(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];v_(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}return i}function y_(n){return 3===n||4===n||6===n}function v_(n){return 64===n.charCodeAt(0)}function Il(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||__(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function __(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function x_(n){return n!==Bo}function Bu(n){return 32767&n}function Uu(n,e){let t=function CI(n){return n>>16}(n),i=e;for(;t>0;)i=i[Lo],t--;return i}let ap=!0;function zu(n){const e=ap;return ap=n,e}const w_=255,b_=5;let TI=0;const er={};function Vu(n,e){const t=M_(n,e);if(-1!==t)return t;const i=e[be];i.firstCreatePass&&(n.injectorIndex=e.length,lp(i.data,n),lp(e,null),lp(i.blueprint,null));const r=cp(n,e),s=n.injectorIndex;if(x_(r)){const o=Bu(r),a=Uu(r,e),l=a[be].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function lp(n,e){n.push(0,0,0,0,0,0,0,0,e)}function M_(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function cp(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=R_(r),null===i)return Bo;if(t++,r=r[Lo],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return Bo}function up(n,e,t){!function AI(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(bl)&&(i=t[bl]),null==i&&(i=t[bl]=TI++);const r=i&w_;e.data[n+(r>>b_)]|=1<<r}(n,e,t)}function S_(n,e,t){if(t&He.Optional||void 0!==n)return n;bu()}function E_(n,e,t,i){if(t&He.Optional&&void 0===i&&(i=null),!(t&(He.Self|He.Host))){const r=n[Tu],s=vi(void 0);try{return r?r.get(e,i,t&He.Optional):U0(e,i,t&He.Optional)}finally{vi(s)}}return S_(i,0,t)}function D_(n,e,t,i=He.Default,r){if(null!==n){if(1024&e[et]){const o=function NI(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&1024&o[et]&&!(256&o[et]);){const a=C_(s,o,t,i|He.Self,er);if(a!==er)return a;let l=s.parent;if(!l){const c=o[q0];if(c){const u=c.get(t,er,i);if(u!==er)return u}l=R_(o),o=o[Lo]}s=l}return r}(n,e,t,i,er);if(o!==er)return o}const s=C_(n,e,t,i,er);if(s!==er)return s}return E_(e,t,i,r)}function C_(n,e,t,i,r){const s=function PI(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(bl)?n[bl]:void 0;return"number"==typeof e?e>=0?e&w_:LI:e}(t);if("function"==typeof s){if(!d_(e,n,i))return i&He.Host?S_(r,0,i):E_(e,t,i,r);try{const o=s(i);if(null!=o||i&He.Optional)return o;bu()}finally{m_()}}else if("number"==typeof s){let o=null,a=M_(n,e),l=Bo,c=i&He.Host?e[Cn][Dn]:null;for((-1===a||i&He.SkipSelf)&&(l=-1===a?cp(n,e):e[a+8],l!==Bo&&A_(i,!1)?(o=e[be],a=Bu(l),e=Uu(l,e)):a=-1);-1!==a;){const u=e[be];if(T_(s,a,u.data)){const d=RI(a,e,t,o,i,c);if(d!==er)return d}l=e[a+8],l!==Bo&&A_(i,e[be].data[a+8]===c)&&T_(s,a,e)?(o=u,a=Bu(l),e=Uu(l,e)):a=-1}}return r}function RI(n,e,t,i,r,s){const o=e[be],a=o.data[n+8],u=Hu(a,o,t,null==i?Cl(a)&&ap:i!=o&&0!=(3&a.type),r&He.Host&&s===a);return null!==u?Ls(e,o,u,a):er}function Hu(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const m=o[f];if(f<l&&t===m||f>=l&&m.type===t)return f}if(r){const f=o[l];if(f&&Fi(f)&&f.type===t)return l}return null}function Ls(n,e,t,i){let r=n[t];const s=e.data;if(function SI(n){return n instanceof Al}(r)){const o=r;o.resolving&&function E1(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new de(-200,`Circular dependency in DI detected for ${n}${t}`)}(wt(s[t]));const a=zu(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?vi(o.injectImpl):null;d_(n,i,He.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function bI(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=K0(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&vi(l),zu(a),o.resolving=!1,m_()}}return r}function T_(n,e,t){return!!(t[e+(n>>b_)]&1<<n)}function A_(n,e){return!(n&He.Self||n&He.Host&&e)}class Uo{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return D_(this._tNode,this._lView,e,Du(i),t)}}function LI(){return new Uo(bn(),K())}function dp(n){return Bf(n)?()=>{const e=dp(Ve(n));return e&&e()}:Is(n)}function R_(n){const e=n[be],t=e.type;return 2===t?e.declTNode:1===t?n[Dn]:null}const Vo="__parameters__";function Go(n,e,t){return Zr(()=>{const i=function hp(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(Vo)?l[Vo]:Object.defineProperty(l,Vo,{value:[]})[Vo];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class We{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ge({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Ns(n,e){n.forEach(t=>Array.isArray(t)?Ns(t,e):e(t))}function L_(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Wu(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}const Nl=wl(Go("Optional"),8),Ol=wl(Go("SkipSelf"),4);var Zn=(()=>((Zn=Zn||{})[Zn.Important=1]="Important",Zn[Zn.DashCase=2]="DashCase",Zn))();const xp=new Map;let oR=0;const bp="__ngContext__";function Tn(n,e){ri(e)?(n[bp]=e[Dl],function lR(n){xp.set(n[Dl],n)}(e)):n[bp]=e}let Mp;function Sp(n,e){return Mp(n,e)}function Ul(n){const e=n[zt];return Oi(e)?e[zt]:e}function Ep(n){return ex(n[Sl])}function Dp(n){return ex(n[Ni])}function ex(n){for(;null!==n&&!Oi(n);)n=n[Ni];return n}function $o(n,e,t,i,r){if(null!=i){let s,o=!1;Oi(i)?s=i:ri(i)&&(o=!0,i=i[wr]);const a=wn(i);0===n&&null!==t?null==r?ox(e,t,a):Os(e,t,a,r||null,!0):1===n&&null!==t?Os(e,t,a,r||null,!0):2===n?function Lp(n,e,t){const i=Xu(n,e);i&&function TR(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function RR(n,e,t,i,r){const s=t[Iu];s!==wn(t)&&$o(e,n,i,s,r);for(let a=Bn;a<t.length;a++){const l=t[a];zl(l[be],l,n,e,i,s)}}(e,n,s,t,r)}}function Tp(n,e,t){return n.createElement(e,t)}function nx(n,e){const t=n[Oo],i=t.indexOf(e),r=e[zt];512&e[et]&&(e[et]&=-513,Zf(r,-1)),t.splice(i,1)}function Ap(n,e){if(n.length<=Bn)return;const t=Bn+e,i=n[t];if(i){const r=i[El];null!==r&&r!==n&&nx(r,i),e>0&&(n[t-1][Ni]=i[Ni]);const s=Wu(n,Bn+e);!function xR(n,e){zl(n,e,e[nt],2,null,null),e[wr]=null,e[Dn]=null}(i[be],i);const o=s[Ji];null!==o&&o.detachView(s[be]),i[zt]=null,i[Ni]=null,i[et]&=-65}return i}function ix(n,e){if(!(128&e[et])){const t=e[nt];t.destroyNode&&zl(n,e,t,3,null,null),function MR(n){let e=n[Sl];if(!e)return Ip(n[be],n);for(;e;){let t=null;if(ri(e))t=e[Sl];else{const i=e[Bn];i&&(t=i)}if(!t){for(;e&&!e[Ni]&&e!==n;)ri(e)&&Ip(e[be],e),e=e[zt];null===e&&(e=n),ri(e)&&Ip(e[be],e),t=e&&e[Ni]}e=t}}(e)}}function Ip(n,e){if(!(128&e[et])){e[et]&=-65,e[et]|=128,function CR(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Al)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];_i(4,a,l);try{l.call(a)}finally{_i(5,a,l)}}else{_i(4,r,s);try{s.call(r)}finally{_i(5,r,s)}}}}}(n,e),function DR(n,e){const t=n.cleanup,i=e[Po];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?i[r=o]():i[r=-o].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)(0,i[s])();e[Po]=null}}(n,e),1===e[be].type&&e[nt].destroy();const t=e[El];if(null!==t&&Oi(e[zt])){t!==e[zt]&&nx(t,e);const i=e[Ji];null!==i&&i.detachView(n)}!function cR(n){xp.delete(n[Dl])}(e)}}function rx(n,e,t){return function sx(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[wr];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Ki.None||s===Ki.Emulated)return null}return si(i,t)}}(n,e.parent,t)}function Os(n,e,t,i,r){n.insertBefore(e,t,i,r)}function ox(n,e,t){n.appendChild(e,t)}function ax(n,e,t,i,r){null!==i?Os(n,e,t,i,r):ox(n,e,t)}function Xu(n,e){return n.parentNode(e)}let Rp,Fp,ux=function cx(n,e,t){return 40&n.type?si(n,t):null};function Yu(n,e,t,i){const r=rx(n,i,e),s=e[nt],a=function lx(n,e,t){return ux(n,e,t)}(i.parent||e[Dn],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)ax(s,r,t[l],a,!1);else ax(s,r,t,a,!1);void 0!==Rp&&Rp(s,i,e,t,r)}function Zu(n,e){if(null!==e){const t=e.type;if(3&t)return si(e,n);if(4&t)return Pp(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Zu(n,i);{const r=n[e.index];return Oi(r)?Pp(-1,r):wn(r)}}if(32&t)return Sp(e,n)()||wn(n[e.index]);{const i=hx(n,e);return null!==i?Array.isArray(i)?i[0]:Zu(Ul(n[Cn]),i):Zu(n,e.next)}}return null}function hx(n,e){return null!==e?n[Cn][Dn].projection[e.projection]:null}function Pp(n,e){const t=Bn+n+1;if(t<e.length){const i=e[t],r=i[be].firstChild;if(null!==r)return Zu(i,r)}return e[Iu]}function Np(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Tn(wn(a),i),t.flags|=2),32!=(32&t.flags))if(8&l)Np(n,e,t.child,i,r,s,!1),$o(e,n,r,a,s);else if(32&l){const c=Sp(t,i);let u;for(;u=c();)$o(e,n,r,u,s);$o(e,n,r,a,s)}else 16&l?fx(n,e,i,t,r,s):$o(e,n,r,a,s);t=o?t.projectionNext:t.next}}function zl(n,e,t,i,r,s){Np(t,i,n.firstChild,e,r,s,!1)}function fx(n,e,t,i,r,s){const o=t[Cn],l=o[Dn].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)$o(e,n,r,l[c],s);else Np(n,e,l,o[zt],r,s,!0)}function px(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function mx(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&op(n,e,i),null!==r&&px(n,e,r),null!==s&&function LR(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}const ed=new We("ENVIRONMENT_INITIALIZER"),Ix=new We("INJECTOR",-1),Rx=new We("INJECTOR_DEF_TYPES");class Px{get(e,t=_l){if(t===_l){const i=new Error(`NullInjectorError: No provider for ${Rt(e)}!`);throw i.name="NullInjectorError",i}return t}}function oP(...n){return{\u0275providers:Lx(0,n),\u0275fromNgModule:!0}}function Lx(n,...e){const t=[],i=new Set;let r;return Ns(e,s=>{const o=s;Hp(o,t,[],i)&&(r||(r=[]),r.push(o))}),void 0!==r&&Nx(r,t),t}function Nx(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];Gp(r,s=>{e.push(s)})}}function Hp(n,e,t,i){if(!(n=Ve(n)))return!1;let r=null,s=k0(n);const o=!s&&Mt(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=k0(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)Hp(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{Ns(s.imports,u=>{Hp(u,e,t,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&Nx(c,e)}if(!a){const c=Is(r)||(()=>new r);e.push({provide:r,useFactory:c,deps:xt},{provide:Rx,useValue:r,multi:!0},{provide:ed,useValue:()=>Fe(r),multi:!0})}const l=s.providers;null==l||a||Gp(l,u=>{e.push(u)})}}return r!==n&&void 0!==n.providers}function Gp(n,e){for(let t of n)Uf(t)&&(t=t.\u0275providers),Array.isArray(t)?Gp(t,e):e(t)}const aP=Tt({provide:String,useValue:Tt});function Wp(n){return null!==n&&"object"==typeof n&&aP in n}function Fs(n){return"function"==typeof n}const jp=new We("Set Injector scope."),td={},cP={};let $p;function nd(){return void 0===$p&&($p=new Px),$p}class Er{}class kx extends Er{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Xp(e,o=>this.processProvider(o)),this.records.set(Ix,Xo(void 0,this)),r.has("environment")&&this.records.set(Er,Xo(void 0,this));const s=this.records.get(jp);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Rx.multi,xt,He.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Io(this),i=vi(void 0);try{return e()}finally{Io(t),vi(i)}}get(e,t=_l,i=He.Default){this.assertNotDestroyed(),i=Du(i);const r=Io(this),s=vi(void 0);try{if(!(i&He.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function pP(n){return"function"==typeof n||"object"==typeof n&&n instanceof We}(e)&&Mu(e);a=l&&this.injectableDefInScope(l)?Xo(qp(e),td):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&He.Self?nd():this.parent).get(e,t=i&He.Optional&&t===_l?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Eu]=o[Eu]||[]).unshift(Rt(e)),r)throw o;return function z1(n,e,t,i){const r=n[Eu];throw e[z0]&&r.unshift(e[z0]),n.message=function V1(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==k1?n.slice(2):n;let r=Rt(e);if(Array.isArray(e))r=e.map(Rt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Rt(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(F1,"\n  ")}`}("\n"+n.message,r,t,i),n[O1]=r,n[Eu]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{vi(s),Io(r)}}resolveInjectorInitializers(){const e=Io(this),t=vi(void 0);try{const i=this.get(ed.multi,xt,He.Self);for(const r of i)r()}finally{Io(e),vi(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Rt(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new de(205,!1)}processProvider(e){let t=Fs(e=Ve(e))?e:Ve(e&&e.provide);const i=function dP(n){return Wp(n)?Xo(void 0,n.useValue):Xo(function Bx(n,e,t){let i;if(Fs(n)){const r=Ve(n);return Is(r)||qp(r)}if(Wp(n))i=()=>Ve(n.useValue);else if(function Fx(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Gf(n.deps||[]));else if(function Ox(n){return!(!n||!n.useExisting)}(n))i=()=>Fe(Ve(n.useExisting));else{const r=Ve(n&&(n.useClass||n.provide));if(!function hP(n){return!!n.deps}(n))return Is(r)||qp(r);i=()=>new r(...Gf(n.deps))}return i}(n),td)}(e);if(Fs(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=Xo(void 0,td,!0),r.factory=()=>Gf(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===td&&(t.value=cP,t.value=t.factory()),"object"==typeof t.value&&t.value&&function fP(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ve(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function qp(n){const e=Mu(n),t=null!==e?e.factory:Is(n);if(null!==t)return t;if(n instanceof We)throw new de(204,!1);if(n instanceof Function)return function uP(n){const e=n.length;if(e>0)throw function Ll(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(e,"?"),new de(204,!1);const t=function R1(n){const e=n&&(n[Su]||n[B0]);return e?(function P1(n){if(n.hasOwnProperty("name"))return n.name;(""+n).match(/^function\s*([^\s(]+)/)}(n),e):null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new de(204,!1)}function Xo(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Xp(n,e){for(const t of n)Array.isArray(t)?Xp(t,e):t&&Uf(t)?Xp(t.\u0275providers,e):e(t)}class mP{}class Ux{}class yP{resolveComponentFactory(e){throw function gP(n){const e=Error(`No component factory found for ${Rt(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let Wl=(()=>{class n{}return n.NULL=new yP,n})();function vP(){return Yo(bn(),K())}function Yo(n,e){return new Qr(si(n,e))}let Qr=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=vP,n})();function _P(n){return n instanceof Qr?n.nativeElement:n}class Vx{}let wP=(()=>{class n{}return n.\u0275prov=Ge({token:n,providedIn:"root",factory:()=>null}),n})();class rd{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const bP=new rd("15.2.1"),Yp={},Zp="ngOriginalError";function Kp(n){return n[Zp]}class Zo{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Kp(e);for(;t&&Kp(t);)t=Kp(t);return t||null}}function Dr(n){return n instanceof Function?n():n}function Gx(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const Wx="ng-template";function LP(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==Gx(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function jx(n){return 4===n.type&&n.value!==Wx}function NP(n,e,t){return e===(4!==n.type||t?n.value:Wx)}function OP(n,e,t){let i=4;const r=n.attrs||[],s=function BP(n){for(let e=0;e<n.length;e++)if(y_(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!NP(n,l,t)||""===l&&1===e.length){if(ki(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!LP(n.attrs,c,t)){if(ki(i))return!1;o=!0}continue}const d=FP(8&i?"class":l,r,jx(n),t);if(-1===d){if(ki(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==Gx(f,c,0)||2&i&&c!==h){if(ki(i))return!1;o=!0}}}}else{if(!o&&!ki(i)&&!ki(l))return!1;if(o&&ki(l))continue;o=!1,i=l|1&i}}return ki(i)||o}function ki(n){return 0==(1&n)}function FP(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function UP(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function $x(n,e,t=!1){for(let i=0;i<e.length;i++)if(OP(n,e[i],t))return!0;return!1}function qx(n,e){return n?":not("+e.trim()+")":e}function VP(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ki(o)&&(e+=qx(s,r),r=""),i=o,s=s||!ki(i);t++}return""!==r&&(e+=qx(s,r)),e}const Ke={};function Jo(n){Xx(ht(),K(),zn()+n,!1)}function Xx(n,e,t,i){if(!i)if(3==(3&e[et])){const s=n.preOrderCheckHooks;null!==s&&Fu(e,s,t)}else{const s=n.preOrderHooks;null!==s&&ku(e,s,0,t)}Ps(t)}function Jx(n,e=null,t=null,i){const r=Qx(n,e,t,i);return r.resolveInjectorInitializers(),r}function Qx(n,e=null,t=null,i,r=new Set){const s=[t||xt,oP(n)];return i=i||("object"==typeof n?void 0:Rt(n)),new kx(s,e||nd(),i||null,r)}let tr=(()=>{class n{static create(t,i){if(Array.isArray(t))return Jx({name:""},i,t,"");{const r=t.name??"";return Jx({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=_l,n.NULL=new Px,n.\u0275prov=Ge({token:n,providedIn:"any",factory:()=>Fe(Ix)}),n.__NG_ELEMENT_ID__=-1,n})();function ke(n,e=He.Default){const t=K();return null===t?Fe(n,e):D_(bn(),t,Ve(n),e)}function aw(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const o=n.data[s];tp(t[i]),o.contentQueries(2,e[s],s)}}}function od(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[wr]=r,d[et]=76|i,(null!==u||n&&1024&n[et])&&(d[et]|=1024),i_(d),d[zt]=d[Lo]=n,d[jt]=t,d[Au]=o||n&&n[Au],d[nt]=a||n&&n[nt],d[$f]=l||n&&n[$f]||null,d[Tu]=c||n&&n[Tu]||null,d[Dn]=s,d[Dl]=function aR(){return oR++}(),d[q0]=u,d[Cn]=2==e.type?n[Cn]:d,d}function ea(n,e,t,i,r){let s=n.data[e];if(null===s)s=function nm(n,e,t,i,r){const s=o_(),o=Kf(),l=n.data[e]=function fL(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function dI(){return Ze.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Tl(){const n=Ze.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Qi(s,!0),s}function jl(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function im(n,e,t){np(e);try{const i=n.viewQuery;null!==i&&fm(1,i,t);const r=n.template;null!==r&&lw(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&aw(n,e),n.staticViewQueries&&fm(2,n.viewQuery,t);const s=n.components;null!==s&&function uL(n,e){for(let t=0;t<e.length;t++)PL(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[et]&=-5,ip()}}function ad(n,e,t,i){const r=e[et];if(128!=(128&r)){np(e);try{i_(e),function l_(n){return Ze.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&lw(n,e,t,2,i);const o=3==(3&r);if(o){const c=n.preOrderCheckHooks;null!==c&&Fu(e,c,null)}else{const c=n.preOrderHooks;null!==c&&ku(e,c,0,null),rp(e,0)}if(function IL(n){for(let e=Ep(n);null!==e;e=Dp(e)){if(!e[X0])continue;const t=e[Oo];for(let i=0;i<t.length;i++){const r=t[i];512&r[et]||Zf(r[zt],1),r[et]|=512}}}(e),function AL(n){for(let e=Ep(n);null!==e;e=Dp(e))for(let t=Bn;t<e.length;t++){const i=e[t],r=i[be];Nu(i)&&ad(r,i,r.template,i[jt])}}(e),null!==n.contentQueries&&aw(n,e),o){const c=n.contentCheckHooks;null!==c&&Fu(e,c)}else{const c=n.contentHooks;null!==c&&ku(e,c,1),rp(e,1)}!function lL(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Ps(~r);else{const s=r,o=t[++i],a=t[++i];hI(o,s),a(2,e[s])}}}finally{Ps(-1)}}(n,e);const a=n.components;null!==a&&function cL(n,e){for(let t=0;t<e.length;t++)RL(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&fm(2,l,i),o){const c=n.viewCheckHooks;null!==c&&Fu(e,c)}else{const c=n.viewHooks;null!==c&&ku(e,c,2),rp(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[et]&=-41,512&e[et]&&(e[et]&=-513,Zf(e[zt],-1))}finally{ip()}}}function lw(n,e,t,i,r){const s=zn(),o=2&i;try{Ps(-1),o&&e.length>Ot&&Xx(n,e,Ot,!1),_i(o?2:0,r),t(i,r)}finally{Ps(s),_i(o?3:1,r)}}function rm(n,e,t){if(Xf(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function sm(n,e,t){s_()&&(function _L(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Cl(t)&&function DL(n,e,t){const i=si(e,n),r=cw(t),s=n[Au],o=ld(n,od(n,r,null,t.onPush?32:16,i,e,s,s.createRenderer(i,t),null,null,null));n[e.index]=o}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Vu(t,e),Tn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Ls(e,n,a,t);Tn(c,e),null!==o&&CL(0,a-r,c,l,0,o),Fi(l)&&(oi(t.index,e)[jt]=Ls(e,n,a,t))}}(n,e,t,si(t,e)),64==(64&t.flags)&&mw(n,e,t))}function om(n,e,t=si){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function cw(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=am(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function am(n,e,t,i,r,s,o,a,l,c){const u=Ot+i,d=u+r,h=function dL(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Ke);return t}(u,d),f="function"==typeof c?c():c;return h[be]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function uw(n,e,t,i){const r=function yw(n){return n[Po]||(n[Po]=[])}(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&function vw(n){return n.cleanup||(n.cleanup=[])}(n).push(i,r.length-1))}function dw(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?hw(t,e,r,s):i.hasOwnProperty(r)&&hw(t,e,i[r],s)}return t}function hw(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function fw(n,e){const t=oi(e,n);16&t[et]||(t[et]|=32)}function lm(n,e,t,i){if(s_()){const r=null===i?null:{"":-1},s=function wL(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if($x(e,o.selectors,!1))if(i||(i=[]),Fi(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),cm(n,e,a.length)}else i.unshift(o),cm(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&pw(n,e,t,o,r,a),r&&function bL(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new de(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Il(t.mergedAttrs,t.attrs)}function pw(n,e,t,i,r,s){for(let c=0;c<i.length;c++)up(Vu(t,e),n,i[c].type);!function SL(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=jl(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=Il(t.mergedAttrs,u.hostAttrs),EL(n,t,e,l,u),ML(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),a=!0),l++}!function pL(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,m=h?h.outputs:null;l=dw(d.inputs,u,l,h?h.inputs:null),c=dw(d.outputs,u,c,m);const p=null===l||null===o||jx(e)?null:TL(l,u,o);a.push(p)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function mw(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function fI(){return Ze.lFrame.currentDirectiveIndex}();try{Ps(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];Qf(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&xL(l,c)}}finally{Ps(-1),Qf(o)}}function xL(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function cm(n,e,t){e.componentOffset=t,(n.components||(n.components=[])).push(e.index)}function ML(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Fi(e)&&(t[""]=n)}}function EL(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Is(r.type)),o=new Al(s,Fi(r),ke);n.blueprint[i]=o,t[i]=o,function yL(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function vL(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,jl(n,t,r.hostVars,Ke),r)}function CL(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function TL(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){i.push(s,o[a+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function gw(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null]}function RL(n,e){const t=oi(e,n);if(Nu(t)){const i=t[be];48&t[et]?ad(i,t,i.template,t[jt]):t[As]>0&&dm(t)}}function dm(n){for(let i=Ep(n);null!==i;i=Dp(i))for(let r=Bn;r<i.length;r++){const s=i[r];if(Nu(s))if(512&s[et]){const o=s[be];ad(o,s,o.template,s[jt])}else s[As]>0&&dm(s)}const t=n[be].components;if(null!==t)for(let i=0;i<t.length;i++){const r=oi(t[i],n);Nu(r)&&r[As]>0&&dm(r)}}function PL(n,e){const t=oi(e,n),i=t[be];(function LL(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),im(i,t,t[jt])}function ld(n,e){return n[Sl]?n[$0][Ni]=e:n[Sl]=e,n[$0]=e,e}function cd(n,e,t,i=!0){const r=e[Au];r.begin&&r.begin();try{ad(n,e,n.template,t)}catch(o){throw i&&function xw(n,e){const t=n[Tu],i=t?t.get(Zo,null):null;i&&i.handleError(e)}(e,o),o}finally{r.end&&r.end()}}function fm(n,e,t){tp(0),e(n,t)}function pm(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function ud(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Ff(r,a):2==s&&(i=Ff(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function dd(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(wn(s)),Oi(s))for(let a=Bn;a<s.length;a++){const l=s[a],c=l[be].firstChild;null!==c&&dd(l[be],l,c,i)}const o=t.type;if(8&o)dd(n,e,t.child,i);else if(32&o){const a=Sp(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=hx(e,t);if(Array.isArray(a))i.push(...a);else{const l=Ul(e[Cn]);dd(l[be],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class $l{get rootNodes(){const e=this._lView,t=e[be];return dd(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[jt]}set context(e){this._lView[jt]=e}get destroyed(){return 128==(128&this._lView[et])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[zt];if(Oi(e)){const t=e[Ru],i=t?t.indexOf(this):-1;i>-1&&(Ap(e,i),Wu(t,i))}this._attachedToViewContainer=!1}ix(this._lView[be],this._lView)}onDestroy(e){uw(this._lView[be],this._lView,null,e)}markForCheck(){!function hm(n){for(;n;){n[et]|=32;const e=Ul(n);if(j1(n)&&!e)return n;n=e}return null}(this._cdRefInjectingView||this._lView)}detach(){this._lView[et]&=-65}reattach(){this._lView[et]|=64}detectChanges(){cd(this._lView[be],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new de(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function bR(n,e){zl(n,e,e[nt],2,null,null)}(this._lView[be],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new de(902,!1);this._appRef=e}}class NL extends $l{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;cd(e[be],e,e[jt],!1)}checkNoChanges(){}get context(){return null}}class ww extends Wl{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Mt(e);return new ql(t,this.ngModule)}}function bw(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class FL{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Du(i);const r=this.injector.get(e,Yp,i);return r!==Yp||t===Yp?r:this.parentInjector.get(e,t,i)}}class ql extends Ux{get inputs(){return bw(this.componentDef.inputs)}get outputs(){return bw(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function HP(n){return n.map(VP).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof Er?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new FL(e,s):e,a=o.get(Vx,null);if(null===a)throw new de(407,!1);const l=o.get(wP,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",d=i?function hL(n,e,t){return n.selectRootElement(e,t===Ki.ShadowDom)}(c,i,this.componentDef.encapsulation):Tp(c,u,function OL(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(u)),h=this.componentDef.onPush?288:272,f=am(0,null,null,1,0,null,null,null,null,null),m=od(null,f,null,h,null,null,a,c,l,o,null);let p,g;np(m);try{const v=this.componentDef;let _,y=null;v.findHostDirectiveDefs?(_=[],y=new Map,v.findHostDirectiveDefs(v,_,y),_.push(v)):_=[v];const x=function BL(n,e){const t=n[be],i=Ot;return n[i]=e,ea(t,i,2,"#host",null)}(m,d),b=function UL(n,e,t,i,r,s,o,a){const l=r[be];!function zL(n,e,t,i){for(const r of n)e.mergedAttrs=Il(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(ud(e,e.mergedAttrs,!0),null!==t&&mx(i,t,e))}(i,n,e,o);const c=s.createRenderer(e,t),u=od(r,cw(t),null,t.onPush?32:16,r[n.index],n,s,c,a||null,null,null);return l.firstCreatePass&&cm(l,n,i.length-1),ld(r,u),r[n.index]=u}(x,d,v,_,m,a,c);g=n_(f,Ot),d&&function HL(n,e,t,i){if(i)op(n,t,["ng-version",bP.full]);else{const{attrs:r,classes:s}=function GP(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!ki(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&op(n,t,r),s&&s.length>0&&px(n,t,s.join(" "))}}(c,v,d,i),void 0!==t&&function GL(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(g,this.ngContentSelectors,t),p=function VL(n,e,t,i,r,s){const o=bn(),a=r[be],l=si(o,r);pw(a,r,o,t,null,i);for(let u=0;u<t.length;u++)Tn(Ls(r,a,o.directiveStart+u,o),r);mw(a,r,o),l&&Tn(l,r);const c=Ls(r,a,o.directiveStart+o.componentOffset,o);if(n[jt]=r[jt]=c,null!==s)for(const u of s)u(c,e);return rm(a,o,n),c}(b,v,_,y,m,[WL]),im(f,m,null)}finally{ip()}return new kL(this.componentType,p,Yo(g,m),m,g)}}class kL extends mP{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new NL(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){const s=this._rootLView;pm(s[be],s,r,e,t),fw(s,this._tNode.index)}}get injector(){return new Uo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function WL(){const n=bn();Ou(K()[be],n)}function ua(n,e,t,i,r,s,o,a){const l=K(),c=ht(),u=n+Ot,d=c.firstCreatePass?function rN(n,e,t,i,r,s,o,a,l){const c=e.consts,u=ea(e,n,4,o||null,Kr(c,a));lm(e,t,u,Kr(c,l)),Ou(e,u);const d=u.tViews=am(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Qi(d,!1);const h=l[nt].createComment("");Yu(c,l,h,d),Tn(h,l),ld(l,l[u]=gw(h,l,h,d)),Pu(d)&&sm(c,l,d),null!=o&&om(l,d,a)}function Bs(n,e,t){const i=K();return function An(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}(i,function ko(){return Ze.lFrame.bindingIndex++}(),e)&&function li(n,e,t,i,r,s,o,a){const l=si(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(pm(n,t,u,i,r),Cl(e)&&fw(t,e.index)):3&e.type&&(i=function mL(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(ht(),function kt(){const n=Ze.lFrame;return n_(n.tView,n.selectedIndex)}(),i,n,e,i[nt],t,!1),Bs}function vm(n,e,t,i,r){const o=r?"class":"style";pm(n,t,e.inputs[o],o,i)}function Ae(n,e,t,i){const r=K(),s=ht(),o=Ot+n,a=r[nt],l=s.firstCreatePass?function aN(n,e,t,i,r,s){const o=e.consts,l=ea(e,n,2,i,Kr(o,r));return lm(e,t,l,Kr(o,s)),null!==l.attrs&&ud(l,l.attrs,!1),null!==l.mergedAttrs&&ud(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=r[o]=Tp(a,e,function wI(){return Ze.lFrame.currentNamespace}()),u=Pu(l);return Qi(l,!0),mx(a,c,l),32!=(32&l.flags)&&Yu(s,r,c,l),0===function iI(){return Ze.lFrame.elementDepthCount}()&&Tn(c,r),function rI(){Ze.lFrame.elementDepthCount++}(),u&&(sm(s,r,l),rm(s,l,r)),null!==i&&om(r,l),Ae}function ie(){let n=bn();Kf()?function Jf(){Ze.lFrame.isParent=!1}():(n=n.parent,Qi(n,!1));const e=n;!function sI(){Ze.lFrame.elementDepthCount--}();const t=ht();return t.firstCreatePass&&(Ou(t,n),Xf(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function EI(n){return 0!=(8&n.flags)}(e)&&vm(t,e,K(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function DI(n){return 0!=(16&n.flags)}(e)&&vm(t,e,K(),e.stylesWithoutHost,!1),ie}function es(n,e,t,i){return Ae(n,e,t,i),ie(),es}function pd(n){return!!n&&"function"==typeof n.then}const Uw=function Bw(n){return!!n&&"function"==typeof n.subscribe};function se(n,e=""){const t=K(),i=ht(),r=n+Ot,s=i.firstCreatePass?ea(i,r,1,e,null):i.data[r],o=t[r]=function Cp(n,e){return n.createText(e)}(t[nt],e);Yu(i,t,o,s),Qi(s,!1)}const fa="en-US";let Fb=fa;class pa{}class lM{}class cM extends pa{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ww(this);const i=ii(e);this._bootstrapComponents=Dr(i.bootstrap),this._r3Injector=Qx(e,t,[{provide:pa,useValue:this},{provide:Wl,useValue:this.componentFactoryResolver}],Rt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Nm extends lM{constructor(e){super(),this.moduleType=e}create(e){return new cM(this.moduleType,e)}}class nO extends pa{constructor(e,t,i){super(),this.componentFactoryResolver=new ww(this),this.instance=null;const r=new kx([...e,{provide:pa,useValue:this},{provide:Wl,useValue:this.componentFactoryResolver}],t||nd(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function wd(n,e,t=null){return new nO(n,e,t).injector}let iO=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=Lx(0,t.type),r=i.length>0?wd([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Ge({token:n,providedIn:"environment",factory:()=>new n(Fe(Er))}),n})();function uM(n){n.getStandaloneInjector=e=>e.get(iO).getOrCreateStandaloneInjector(n)}function Fm(n){return e=>{setTimeout(n,void 0,e)}}const Hn=class AO extends yr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Fm(s),r&&(r=Fm(r)),o&&(o=Fm(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof ti&&e.add(a),a}};function IO(){return this._results[Symbol.iterator]()}class km{get changes(){return this._changes||(this._changes=new Hn)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=km.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=IO)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function xi(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function FI(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Tr=(()=>{class n{}return n.__NG_ELEMENT_ID__=LO,n})();const RO=Tr,PO=class extends RO{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tViews,r=od(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[El]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[Ji];return null!==o&&(r[Ji]=o.createEmbeddedView(i)),im(i,r,e),new $l(r)}};function LO(){return bd(bn(),K())}function bd(n,e){return 4&n.type?new PO(e,n,Yo(n,e)):null}let zi=(()=>{class n{}return n.__NG_ELEMENT_ID__=NO,n})();function NO(){return SM(bn(),K())}const OO=zi,bM=class extends OO{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Yo(this._hostTNode,this._hostLView)}get injector(){return new Uo(this._hostTNode,this._hostLView)}get parentInjector(){const e=cp(this._hostTNode,this._hostLView);if(x_(e)){const t=Uu(e,this._hostLView),i=Bu(e);return new Uo(t[be].data[i+8],t)}return new Uo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=MM(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Bn}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const o=e.createEmbeddedView(t||{},s);return this.insert(o,r),o}createComponent(e,t,i,r,s){const o=e&&!function Pl(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.environmentInjector||d.ngModuleRef}const l=o?e:new ql(Mt(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(Er,null);h&&(s=h)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[be];if(function nI(n){return Oi(n[zt])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[zt],h=new bM(d,d[Dn],d[zt]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function SR(n,e,t,i){const r=Bn+i,s=t.length;i>0&&(t[r-1][Ni]=e),i<s-Bn?(e[Ni]=t[r],L_(t,Bn+i,e)):(t.push(e),e[Ni]=null),e[zt]=t;const o=e[El];null!==o&&t!==o&&function ER(n,e){const t=n[Oo];e[Cn]!==e[zt][zt][Cn]&&(n[X0]=!0),null===t?n[Oo]=[e]:t.push(e)}(o,e);const a=e[Ji];null!==a&&a.insertView(n),e[et]|=64}(r,i,o,s);const a=Pp(s,o),l=i[nt],c=Xu(l,o[Iu]);return null!==c&&function wR(n,e,t,i,r,s){i[wr]=r,i[Dn]=e,zl(n,i,t,1,r,s)}(r,o[Dn],l,i,c,a),e.attachToViewContainerRef(),L_(Bm(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=MM(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Ap(this._lContainer,t);i&&(Wu(Bm(this._lContainer),t),ix(i[be],i))}detach(e){const t=this._adjustIndex(e,-1),i=Ap(this._lContainer,t);return i&&null!=Wu(Bm(this._lContainer),t)?new $l(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function MM(n){return n[Ru]}function Bm(n){return n[Ru]||(n[Ru]=[])}function SM(n,e){let t;const i=e[n.index];if(Oi(i))t=i;else{let r;if(8&n.type)r=wn(i);else{const s=e[nt];r=s.createComment("");const o=si(n,e);Os(s,Xu(s,o),r,function AR(n,e){return n.nextSibling(e)}(s,o),!1)}e[n.index]=t=gw(i,e,r,n),ld(e,t)}return new bM(t,n,e)}class Um{constructor(e){this.queryList=e,this.matches=null}clone(){return new Um(this.queryList)}setDirty(){this.queryList.setDirty()}}class zm{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new zm(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==IM(e,t).matches&&this.queries[t].setDirty()}}class EM{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Vm{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Vm(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Hm{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Hm(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,FO(t,s)),this.matchTNodeWithReadOption(e,t,Hu(t,e,s,!1,!1))}else i===Tr?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Hu(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Qr||r===zi||r===Tr&&4&t.type)this.addMatch(t.index,-2);else{const s=Hu(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function FO(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function BO(n,e,t,i){return-1===t?function kO(n,e){return 11&n.type?Yo(n,e):4&n.type?bd(n,e):null}(e,n):-2===t?function UO(n,e,t){return t===Qr?Yo(e,n):t===Tr?bd(e,n):t===zi?SM(e,n):void 0}(n,e,i):Ls(n,n[be],t,e)}function DM(n,e,t,i){const r=e[Ji].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:BO(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function Gm(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=DM(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=Bn;d<u.length;d++){const h=u[d];h[El]===h[zt]&&Gm(h[be],h,c,i)}if(null!==u[Oo]){const d=u[Oo];for(let h=0;h<d.length;h++){const f=d[h];Gm(f[be],f,c,i)}}}}}return i}function Md(n){const e=K(),t=ht(),i=u_();tp(i+1);const r=IM(t,i);if(n.dirty&&function tI(n){return 4==(4&n[et])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Gm(t,e,i,[]):DM(t,e,r,i);n.reset(s,_P),n.notifyOnChanges()}return!0}return!1}function Wm(n,e,t){const i=ht();i.firstCreatePass&&(function AM(n,e,t){null===n.queries&&(n.queries=new Vm),n.queries.track(new Hm(e,t))}(i,new EM(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function TM(n,e,t){const i=new km(4==(4&t));uw(n,e,i,i.destroy),null===e[Ji]&&(e[Ji]=new zm),e[Ji].queries.push(new Um(i))}(i,K(),e)}function Sd(){return function zO(n,e){return n[Ji].queries[e].queryList}(K(),u_())}function IM(n,e){return n.queries.getByIndex(e)}function Dd(...n){}const Cd=new We("Application Initializer");let Td=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Dd,this.reject=Dd,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(pd(s))t.push(s);else if(Uw(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Fe(Cd,8))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const rc=new We("AppId",{providedIn:"root",factory:function XM(){return`${Zm()}${Zm()}${Zm()}`}});function Zm(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const YM=new We("Platform Initializer"),ZM=new We("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),KM=new We("appBootstrapListener");let l3=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Ar=new We("LocaleId",{providedIn:"root",factory:()=>dt(Ar,He.Optional|He.SkipSelf)||function c3(){return typeof $localize<"u"&&$localize.locale||fa}()});class d3{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let JM=(()=>{class n{compileModuleSync(t){return new Nm(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Dr(ii(t).declarations).reduce((o,a)=>{const l=Mt(a);return l&&o.push(new ql(l)),o},[]);return new d3(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const p3=(()=>Promise.resolve(0))();function Km(n){typeof Zone>"u"?p3.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class $t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Hn(!1),this.onMicrotaskEmpty=new Hn(!1),this.onStable=new Hn(!1),this.onError=new Hn(!1),typeof Zone>"u")throw new de(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function m3(){let n=Nt.requestAnimationFrame,e=Nt.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function v3(n){const e=()=>{!function y3(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Nt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Qm(n),n.isCheckStableRunning=!0,Jm(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Qm(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return tS(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),nS(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return tS(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),nS(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Qm(n),Jm(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!$t.isInAngularZone())throw new de(909,!1)}static assertNotInAngularZone(){if($t.isInAngularZone())throw new de(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,g3,Dd,Dd);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const g3={};function Jm(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Qm(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function tS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function nS(n){n._nesting--,Jm(n)}class _3{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Hn,this.onMicrotaskEmpty=new Hn,this.onStable=new Hn,this.onError=new Hn}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const iS=new We(""),Ad=new We("");let ng,eg=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,ng||(function x3(n){ng=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$t.assertNotInAngularZone(),Km(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Km(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Fe($t),Fe(tg),Fe(Ad))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),tg=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return ng?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),ns=null;const rS=new We("AllowMultipleToken"),ig=new We("PlatformDestroyListeners"),Ir=!1;class sS{constructor(e,t){this.name=e,this.token=t}}function aS(n,e,t=[]){const i=`Platform: ${e}`,r=new We(i);return(s=[])=>{let o=rg();if(!o||o.injector.get(rS,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function M3(n){if(ns&&!ns.get(rS,!1))throw new de(400,!1);ns=n;const e=n.get(cS);(function oS(n){const e=n.get(YM,null);e&&e.forEach(t=>t())})(n)}(function lS(n=[],e){return tr.create({name:e,providers:[{provide:jp,useValue:"platform"},{provide:ig,useValue:new Set([()=>ns=null])},...n]})}(a,i))}return function E3(n){const e=rg();if(!e)throw new de(401,!1);return e}()}}function rg(){return ns?.get(cS)??null}let cS=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function dS(n,e){let t;return t="noop"===n?new _3:("zone.js"===n?void 0:n)||new $t(e),t}(i?.ngZone,function uS(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),s=[{provide:$t,useValue:r}];return r.run(()=>{const o=tr.create({providers:s,parent:this.injector,name:t.moduleType.name}),a=t.create(o),l=a.injector.get(Zo,null);if(!l)throw new de(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Rd(this._modules,a),c.unsubscribe()})}),function hS(n,e,t){try{const i=t();return pd(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(l,r,()=>{const c=a.injector.get(Td);return c.runInitializers(),c.donePromise.then(()=>(function kb(n){yi(n,"Expected localeId to be defined"),"string"==typeof n&&(Fb=n.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Ar,fa)||fa),this._moduleDoBootstrap(a),a))})})}bootstrapModule(t,i=[]){const r=fS({},i);return function w3(n,e,t){const i=new Nm(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(Id);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new de(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new de(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(ig,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Fe(tr))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function fS(n,e){return Array.isArray(e)?e.reduce(fS,n):{...n,...e}}let Id=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,i,r){this._zone=t,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Qt(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new Qt(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{$t.assertNotInAngularZone(),Km(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{$t.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=function b1(...n){const e=vl(n),t=function m1(n,e){return"number"==typeof Lf(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Pi(i[0]):Ao(t)(an(i,e)):Zi}(s,o.pipe(function M1(n={}){const{connector:e=(()=>new yr),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},m=()=>{const p=o;f(),p?.unsubscribe()};return pn((p,g)=>{c++,!d&&!u&&h();const v=l=l??e();g.add(()=>{c--,0===c&&!d&&!u&&(a=Nf(m,r))}),v.subscribe(g),!o&&c>0&&(o=new yl({next:_=>v.next(_),error:_=>{d=!0,h(),a=Nf(f,t,_),v.error(_)},complete:()=>{u=!0,h(),a=Nf(f,i),v.complete()}}),Pi(p).subscribe(o))})(s)}}()))}bootstrap(t,i){const r=t instanceof Ux;if(!this._injector.get(Td).done){!r&&function Ro(n){const e=Mt(n)||En(n)||kn(n);return null!==e&&e.standalone}(t);throw new de(405,Ir)}let o;o=r?t:this._injector.get(Wl).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function b3(n){return n.isBoundToModule}(o)?void 0:this._injector.get(pa),c=o.create(tr.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(iS,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Rd(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new de(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Rd(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(KM,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Rd(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new de(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(Fe($t),Fe(Er),Fe(Zo))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Rd(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let sg=(()=>{class n{}return n.__NG_ELEMENT_ID__=C3,n})();function C3(n){return function T3(n,e,t){if(Cl(n)&&!t){const i=oi(n.index,e);return new $l(i,i)}return 47&n.type?new $l(e[Cn],e):null}(bn(),K(),16==(16&n))}const V3=aS(null,"core",[]);let H3=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Fe(Id))},n.\u0275mod=Ts({type:n}),n.\u0275inj=Yr({}),n})(),dg=null;function Hs(){return dg}class j3{}const Jn=new We("DocumentToken");let hg=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return function $3(){return Fe(SS)}()},providedIn:"platform"}),n})();const q3=new We("Location Initialized");let SS=(()=>{class n extends hg{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Hs().getBaseHref(this._doc)}onPopState(t){const i=Hs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Hs().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){ES()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){ES()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Fe(Jn))},n.\u0275prov=Ge({token:n,factory:function(){return function X3(){return new SS(Fe(Jn))}()},providedIn:"platform"}),n})();function ES(){return!!window.history.pushState}function fg(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function DS(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Rr(n){return n&&"?"!==n[0]?"?"+n:n}let Gs=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return dt(TS)},providedIn:"root"}),n})();const CS=new We("appBaseHref");let TS=(()=>{class n extends Gs{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??dt(Jn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return fg(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Rr(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Rr(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Rr(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(Fe(hg),Fe(CS,8))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Y3=(()=>{class n extends Gs{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=fg(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Rr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Rr(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(Fe(hg),Fe(CS,8))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),pg=(()=>{class n{constructor(t){this._subject=new Hn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function J3(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(DS(AS(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Rr(i))}normalize(t){return n.stripTrailingSlash(function K3(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,AS(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Rr(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Rr(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Rr,n.joinWithSlash=fg,n.stripTrailingSlash=DS,n.\u0275fac=function(t){return new(t||n)(Fe(Gs))},n.\u0275prov=Ge({token:n,factory:function(){return function Z3(){return new pg(Fe(Gs))}()},providedIn:"root"}),n})();function AS(n){return n.replace(/\/index.html$/,"")}let HS=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new VF,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){GS("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){GS("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(ke(zi),ke(Tr))},n.\u0275dir=Fn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class VF{constructor(){this.$implicit=null,this.ngIf=null}}function GS(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Rt(e)}'.`)}let hk=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Ts({type:n}),n.\u0275inj=Yr({}),n})();let gk=(()=>{class n{}return n.\u0275prov=Ge({token:n,providedIn:"root",factory:()=>new yk(Fe(Jn),window)}),n})();class yk{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function vk(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=qS(this.window.history)||qS(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function qS(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class $k extends j3{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Rg extends $k{static makeCurrent(){!function W3(n){dg||(dg=n)}(new Rg)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function qk(){return cc=cc||document.querySelector("base"),cc?cc.getAttribute("href"):null}();return null==t?null:function Xk(n){$d=$d||document.createElement("a"),$d.setAttribute("href",n);const e=$d.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){cc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function OF(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let $d,cc=null;const JS=new We("TRANSITION_ID"),Zk=[{provide:Cd,useFactory:function Yk(n,e,t){return()=>{t.get(Td).donePromise.then(()=>{const i=Hs(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[JS,Jn,tr],multi:!0}];let Jk=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const qd=new We("EventManagerPlugins");let Xd=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Fe(qd),Fe($t))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();class QS{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Hs().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let eE=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),uc=(()=>{class n extends eE{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(Fe(Jn))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const Pg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Lg=/%COMP%/g,iE=new We("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function rE(n,e){return e.flat(100).map(t=>t.replace(Lg,n))}function sE(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Ng=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new Og(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof lE?r.applyToHost(t):r instanceof Fg&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.eventManager,a=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(i.encapsulation){case Ki.Emulated:s=new lE(o,a,i,this.appId,l);break;case Ki.ShadowDom:return new sB(o,a,t,i);default:s=new Fg(o,a,i,l)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Fe(Xd),Fe(uc),Fe(rc),Fe(iE))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();class Og{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Pg[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(aE(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(aE(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=Pg[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=Pg[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Zn.DashCase|Zn.Important)?e.style.setProperty(t,i,r&Zn.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Zn.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,sE(i)):this.eventManager.addEventListener(e,t,sE(i))}}function aE(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class sB extends Og{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=rE(r.id,r.styles);for(const o of s){const a=document.createElement("style");a.textContent=o,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Fg extends Og{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=rE(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class lE extends Fg{constructor(e,t,i,r,s){const o=r+"-"+i.id;super(e,t,i,s,o),this.contentAttr=function nB(n){return"_ngcontent-%COMP%".replace(Lg,n)}(o),this.hostAttr=function iB(n){return"_nghost-%COMP%".replace(Lg,n)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let oB=(()=>{class n extends QS{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Fe(Jn))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const cE=["alt","control","meta","shift"],aB={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},lB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let cB=(()=>{class n extends QS{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Hs().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),cE.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=aB[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),cE.forEach(o=>{o!==r&&(0,lB[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(Fe(Jn))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();const fB=aS(V3,"browser",[{provide:ZM,useValue:"browser"},{provide:YM,useValue:function uB(){Rg.makeCurrent()},multi:!0},{provide:Jn,useFactory:function hB(){return function kR(n){Fp=n}(document),document},deps:[]}]),hE=new We(""),fE=[{provide:Ad,useClass:class Kk{addToWindow(e){Nt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Nt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Nt.getAllAngularRootElements=()=>e.getAllRootElements(),Nt.frameworkStabilizers||(Nt.frameworkStabilizers=[]),Nt.frameworkStabilizers.push(i=>{const r=Nt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?Hs().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:iS,useClass:eg,deps:[$t,tg,Ad]},{provide:eg,useClass:eg,deps:[$t,tg,Ad]}],pE=[{provide:jp,useValue:"root"},{provide:Zo,useFactory:function dB(){return new Zo},deps:[]},{provide:qd,useClass:oB,multi:!0,deps:[Jn,$t,ZM]},{provide:qd,useClass:cB,multi:!0,deps:[Jn]},{provide:Ng,useClass:Ng,deps:[Xd,uc,rc,iE]},{provide:Vx,useExisting:Ng},{provide:eE,useExisting:uc},{provide:uc,useClass:uc,deps:[Jn]},{provide:Xd,useClass:Xd,deps:[qd,$t]},{provide:class _k{},useClass:Jk,deps:[]},[]];let pB=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:rc,useValue:t.appId},{provide:JS,useExisting:rc},Zk]}}}return n.\u0275fac=function(t){return new(t||n)(Fe(hE,12))},n.\u0275mod=Ts({type:n}),n.\u0275inj=Yr({providers:[...pE,...fE],imports:[hk,H3]}),n})(),mE=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(Fe(Jn))},n.\u0275prov=Ge({token:n,factory:function(t){let i=null;return i=t?new t:function gB(){return new mE(Fe(Jn))}(),i},providedIn:"root"}),n})();function Ue(...n){return an(n,vl(n))}typeof window<"u"&&window;class Si extends yr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const Yd=gl(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:SB}=Array,{getPrototypeOf:EB,prototype:DB,keys:CB}=Object;const{isArray:IB}=Array;function vE(...n){const e=vl(n),t=function p1(n){return It(Lf(n))?n.pop():void 0}(n),{args:i,keys:r}=function TB(n){if(1===n.length){const e=n[0];if(SB(e))return{args:e,keys:null};if(function AB(n){return n&&"object"==typeof n&&EB(n)===DB}(e)){const t=CB(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}(n);if(0===i.length)return an([],e);const s=new Qt(function NB(n,e,t=Ds){return i=>{_E(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)_E(e,()=>{const c=an(n[l],e);let u=!1;c.subscribe(mn(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>function LB(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}(r,o):Ds));return t?s.pipe(function PB(n){return ct(e=>function RB(n,e){return IB(e)?n(...e):n(e)}(n,e))}(t)):s}function _E(n,e,t){n?vr(t,n,e):e()}function Ug(...n){return function OB(){return Ao(1)}()(an(n,vl(n)))}function xE(n){return new Qt(e=>{Pi(n()).subscribe(e)})}function dc(n,e){const t=It(n)?n:()=>n,i=r=>r.error(t());return new Qt(e?r=>e.schedule(i,0,r):i)}function zg(){return pn((n,e)=>{let t=null;n._refCount++;const i=mn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class wE extends Qt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,y0(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ti;const t=this.getSubject();e.add(this.source.subscribe(mn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ti.EMPTY)}return e}refCount(){return zg()(this)}}function or(n,e){return pn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(mn(i,l=>{r?.unsubscribe();let c=0;const u=s++;Pi(n(l,u)).subscribe(r=mn(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function hc(n){return n<=0?()=>Zi:pn((e,t)=>{let i=0;e.subscribe(mn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function rs(n,e){return pn((t,i)=>{let r=0;t.subscribe(mn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Zd(n){return pn((e,t)=>{let i=!1;e.subscribe(mn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function bE(n=kB){return pn((e,t)=>{let i=!1;e.subscribe(mn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function kB(){return new Yd}function ss(n,e){const t=arguments.length>=2;return i=>i.pipe(n?rs((r,s)=>n(r,s,i)):Ds,hc(1),t?Zd(e):bE(()=>new Yd))}function Ws(n,e){return It(e)?xn(n,e,1):xn(n,1)}function In(n,e,t){const i=It(n)||e||t?{next:n,error:e,complete:t}:n;return i?pn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(mn(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Ds}function os(n){return pn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(mn(t,void 0,void 0,o=>{s=Pi(n(o,os(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function ME(n,e){return pn(function BB(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(mn(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}function Vg(n){return n<=0?()=>Zi:pn((e,t)=>{let i=[];e.subscribe(mn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function SE(n,e){const t=arguments.length>=2;return i=>i.pipe(n?rs((r,s)=>n(r,s,i)):Ds,Vg(1),t?Zd(e):bE(()=>new Yd))}function Hg(n){return pn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Je="primary",fc=Symbol("RouteTitle");class VB{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ya(n){return new VB(n)}function HB(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function ar(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!EE(n[r],e[r]))return!1;return!0}function EE(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function DE(n){return Array.prototype.concat.apply([],n)}function CE(n){return n.length>0?n[n.length-1]:null}function Mn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function as(n){return Uw(n)?n:pd(n)?an(Promise.resolve(n)):Ue(n)}const Kd=!1,WB={exact:function IE(n,e,t){if(!js(n.segments,e.segments)||!Jd(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!IE(n.children[i],e.children[i],t))return!1;return!0},subset:RE},TE={exact:function jB(n,e){return ar(n,e)},subset:function $B(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>EE(n[t],e[t]))},ignored:()=>!0};function AE(n,e,t){return WB[t.paths](n.root,e.root,t.matrixParams)&&TE[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function RE(n,e,t){return PE(n,e,e.segments,t)}function PE(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!js(r,t)||e.hasChildren()||!Jd(r,t,i))}if(n.segments.length===t.length){if(!js(n.segments,t)||!Jd(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!RE(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(js(n.segments,r)&&Jd(n.segments,r,i)&&n.children[Je])&&PE(n.children[Je],e,s,i)}}function Jd(n,e,t){return e.every((i,r)=>TE[t](n[r].parameters,i.parameters))}class ls{constructor(e=new rt([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ya(this.queryParams)),this._queryParamMap}toString(){return YB.serialize(this)}}class rt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Mn(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Qd(this)}}class pc{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ya(this.parameters)),this._parameterMap}toString(){return OE(this)}}function js(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let mc=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return new Gg},providedIn:"root"}),n})();class Gg{parse(e){const t=new rU(e);return new ls(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${gc(e.root,!0)}`,i=function JB(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${eh(t)}=${eh(r)}`).join("&"):`${eh(t)}=${eh(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function ZB(n){return encodeURI(n)}(e.fragment)}`:""}`}}const YB=new Gg;function Qd(n){return n.segments.map(e=>OE(e)).join("/")}function gc(n,e){if(!n.hasChildren())return Qd(n);if(e){const t=n.children[Je]?gc(n.children[Je],!1):"",i=[];return Mn(n.children,(r,s)=>{s!==Je&&i.push(`${s}:${gc(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function XB(n,e){let t=[];return Mn(n.children,(i,r)=>{r===Je&&(t=t.concat(e(i,r)))}),Mn(n.children,(i,r)=>{r!==Je&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Je?[gc(n.children[Je],!1)]:[`${r}:${gc(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Je]?`${Qd(n)}/${t[0]}`:`${Qd(n)}/(${t.join("//")})`}}function LE(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function eh(n){return LE(n).replace(/%3B/gi,";")}function Wg(n){return LE(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function th(n){return decodeURIComponent(n)}function NE(n){return th(n.replace(/\+/g,"%20"))}function OE(n){return`${Wg(n.path)}${function KB(n){return Object.keys(n).map(e=>`;${Wg(e)}=${Wg(n[e])}`).join("")}(n.parameters)}`}const QB=/^[^\/()?;=#]+/;function nh(n){const e=n.match(QB);return e?e[0]:""}const eU=/^[^=?&#]+/,nU=/^[^&#]+/;class rU{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new rt([],{}):new rt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Je]=new rt(e,t)),i}parseSegment(){const e=nh(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new de(4009,Kd);return this.capture(e),new pc(th(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=nh(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=nh(this.remaining);r&&(i=r,this.capture(i))}e[th(t)]=th(i)}parseQueryParam(e){const t=function tU(n){const e=n.match(eU);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function iU(n){const e=n.match(nU);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=NE(t),s=NE(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=nh(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new de(4010,Kd);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Je);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[Je]:new rt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new de(4011,Kd)}}function jg(n){return n.segments.length>0?new rt([],{[Je]:n}):n}function ih(n){const e={};for(const i of Object.keys(n.children)){const s=ih(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function sU(n){if(1===n.numberOfChildren&&n.children[Je]){const e=n.children[Je];return new rt(n.segments.concat(e.segments),e.children)}return n}(new rt(n.segments,e))}function $s(n){return n instanceof ls}const $g=!1;function oU(n,e,t,i,r){if(0===t.length)return va(e.root,e.root,e.root,i,r);const s=function zE(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new UE(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Mn(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new UE(t,e,i)}(t);return s.toRoot()?va(e.root,e.root,new rt([],{}),i,r):function o(l){const c=function lU(n,e,t,i){if(n.isAbsolute)return new _a(e.root,!0,0);if(-1===i)return new _a(t,t===e.root,0);return function VE(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new de(4005,$g&&"Invalid number of '../'");r=i.segments.length}return new _a(i,!1,r-s)}(t,i+(yc(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,l),u=c.processChildren?xa(c.segmentGroup,c.index,s.commands):qg(c.segmentGroup,c.index,s.commands);return va(e.root,c.segmentGroup,u,i,r)}(n.snapshot?._lastPathIndex)}function yc(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function vc(n){return"object"==typeof n&&null!=n&&n.outlets}function va(n,e,t,i,r){let o,s={};i&&Mn(i,(l,c)=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`}),o=n===e?t:BE(n,e,t);const a=jg(ih(o));return new ls(a,s,r)}function BE(n,e,t){const i={};return Mn(n.children,(r,s)=>{i[s]=r===e?t:BE(r,e,t)}),new rt(n.segments,i)}class UE{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&yc(i[0]))throw new de(4003,$g&&"Root segment cannot have matrix parameters");const r=i.find(vc);if(r&&r!==CE(i))throw new de(4004,$g&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class _a{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function qg(n,e,t){if(n||(n=new rt([],{})),0===n.segments.length&&n.hasChildren())return xa(n,e,t);const i=function uU(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(vc(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!GE(l,c,o))return s;i+=2}else{if(!GE(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new rt(n.segments.slice(0,i.pathIndex),{});return s.children[Je]=new rt(n.segments.slice(i.pathIndex),n.children),xa(s,0,r)}return i.match&&0===r.length?new rt(n.segments,{}):i.match&&!n.hasChildren()?Xg(n,e,t):i.match?xa(n,0,r):Xg(n,e,t)}function xa(n,e,t){if(0===t.length)return new rt(n.segments,{});{const i=function cU(n){return vc(n[0])?n[0].outlets:{[Je]:n}}(t),r={};return!i[Je]&&n.children[Je]&&1===n.numberOfChildren&&0===n.children[Je].segments.length?xa(n.children[Je],e,t):(Mn(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=qg(n.children[o],e,s))}),Mn(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new rt(n.segments,r))}}function Xg(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(vc(s)){const l=dU(s.outlets);return new rt(i,l)}if(0===r&&yc(t[0])){i.push(new pc(n.segments[e].path,HE(t[0]))),r++;continue}const o=vc(s)?s.outlets[Je]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&yc(a)?(i.push(new pc(o,HE(a))),r+=2):(i.push(new pc(o,{})),r++)}return new rt(i,{})}function dU(n){const e={};return Mn(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Xg(new rt([],{}),0,t))}),e}function HE(n){const e={};return Mn(n,(t,i)=>e[i]=`${t}`),e}function GE(n,e,t){return n==t.path&&ar(e,t.parameters)}const _c="imperative";class lr{constructor(e,t){this.id=e,this.url=t}}class Yg extends lr{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class qs extends lr{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class rh extends lr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class sh extends lr{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class Zg extends lr{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class hU extends lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fU extends lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pU extends lr{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class mU extends lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class gU extends lr{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yU{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class vU{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class _U{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xU{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wU{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bU{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class WE{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let EU=(()=>{class n{createUrlTree(t,i,r,s,o,a){return oU(t||i.root,r,s,o,a)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})(),CU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(e){return EU.\u0275fac(e)},providedIn:"root"}),n})();class jE{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Kg(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Kg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Jg(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Jg(e,this._root).map(t=>t.value)}}function Kg(n,e){if(n===e.value)return e;for(const t of e.children){const i=Kg(n,t);if(i)return i}return null}function Jg(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Jg(n,t);if(i.length)return i.unshift(e),i}return[]}class Lr{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function wa(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class $E extends jE{constructor(e,t){super(e),this.snapshot=t,Qg(this,e)}toString(){return this.snapshot.toString()}}function qE(n,e){const t=function TU(n,e){const o=new oh([],{},{},"",{},Je,e,null,n.root,-1,{});return new YE("",new Lr(o,[]))}(n,e),i=new Si([new pc("",{})]),r=new Si({}),s=new Si({}),o=new Si({}),a=new Si(""),l=new ba(i,r,o,a,s,Je,e,t.root);return l.snapshot=t.root,new $E(new Lr(l,[]),t)}class ba{constructor(e,t,i,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.title=this.data?.pipe(ct(c=>c[fc]))??Ue(void 0),this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ct(e=>ya(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ct(e=>ya(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function XE(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function AU(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class oh{get title(){return this.data?.[fc]}constructor(e,t,i,r,s,o,a,l,c,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ya(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ya(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class YE extends jE{constructor(e,t){super(t),this.url=e,Qg(this,t)}toString(){return ZE(this._root)}}function Qg(n,e){e.value._routerState=n,e.children.forEach(t=>Qg(n,t))}function ZE(n){const e=n.children.length>0?` { ${n.children.map(ZE).join(", ")} } `:"";return`${n.value}${e}`}function ey(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ar(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),ar(e.params,t.params)||n.params.next(t.params),function GB(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ar(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),ar(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function ty(n,e){const t=ar(n.params,e.params)&&function qB(n,e){return js(n,e)&&n.every((t,i)=>ar(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||ty(n.parent,e.parent))}function xc(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function RU(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return xc(n,i,r);return xc(n,i)})}(n,e,t);return new Lr(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>xc(n,a)),o}}const i=function PU(n){return new ba(new Si(n.url),new Si(n.params),new Si(n.queryParams),new Si(n.fragment),new Si(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>xc(n,s));return new Lr(i,r)}}const ny="ngNavigationCancelingError";function KE(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=$s(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=JE(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function JE(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[ny]=!0,i.cancellationCode=e,t&&(i.url=t),i}function QE(n){return eD(n)&&$s(n.url)}function eD(n){return n&&n[ny]}class LU{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new wc,this.attachRef=null}}let wc=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new LU,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ah=!1;let lh=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Je,this.activateEvents=new Hn,this.deactivateEvents=new Hn,this.attachEvents=new Hn,this.detachEvents=new Hn,this.parentContexts=dt(wc),this.location=dt(zi),this.changeDetector=dt(sg),this.environmentInjector=dt(Er)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new de(4012,ah);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new de(4012,ah);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new de(4012,ah);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new de(4013,ah);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new NU(t,a,r.injector);if(i&&function OU(n){return!!n.resolveComponentFactory}(i)){const c=i.resolveComponentFactory(o);this.activated=r.createComponent(c,r.length,l)}else this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Fn({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Rs]}),n})();class NU{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===ba?this.route:e===wc?this.childContexts:this.parent.get(e,t)}}let iy=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ml({type:n,selectors:[["ng-component"]],standalone:!0,features:[uM],decls:1,vars:0,template:function(t,i){1&t&&es(0,"router-outlet")},dependencies:[lh],encapsulation:2}),n})();function tD(n,e){return n.providers&&!n._injector&&(n._injector=wd(n.providers,e,`Route: ${n.path}`)),n._injector??e}function sy(n){const e=n.children&&n.children.map(sy),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Je&&(t.component=iy),t}function Ei(n){return n.outlet||Je}function nD(n,e){const t=n.filter(i=>Ei(i)===e);return t.push(...n.filter(i=>Ei(i)!==e)),t}function bc(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class zU{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),ey(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=wa(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Mn(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=wa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=wa(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=wa(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new bU(s.value.snapshot))}),e.children.length&&this.forwardEvent(new xU(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(ey(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),ey(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=bc(r.snapshot),l=a?.get(Wl)??null;o.attachRef=null,o.route=r,o.resolver=l,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class iD{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class ch{constructor(e,t){this.component=e,this.route=t}}function VU(n,e,t){const i=n._root;return Mc(i,e?e._root:null,t,[i.value])}function Ma(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function I1(n){return null!==Mu(n)}(n)?e.get(n):n:i}function Mc(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=wa(e);return n.children.forEach(o=>{(function GU(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function WU(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!js(n.url,e.url);case"pathParamsOrQueryParamsChange":return!js(n.url,e.url)||!ar(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ty(n,e)||!ar(n.queryParams,e.queryParams);default:return!ty(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new iD(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Mc(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new ch(a.outlet.component,o))}else o&&Sc(e,a,r),r.canActivateChecks.push(new iD(i)),Mc(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Mn(s,(o,a)=>Sc(o,t.getContext(a),r)),r}function Sc(n,e,t){const i=wa(n),r=n.value;Mn(i,(s,o)=>{Sc(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new ch(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function Ec(n){return"function"==typeof n}function oy(n){return n instanceof Yd||"EmptyError"===n?.name}const uh=Symbol("INITIAL_VALUE");function Sa(){return or(n=>vE(n.map(e=>e.pipe(hc(1),function FB(...n){const e=vl(n);return pn((t,i)=>{(e?Ug(n,t,e):Ug(n,t)).subscribe(i)})}(uh)))).pipe(ct(e=>{for(const t of e)if(!0!==t){if(t===uh)return uh;if(!1===t||t instanceof ls)return t}return!0}),rs(e=>e!==uh),hc(1)))}function rD(n){return function YA(...n){return p0(n)}(In(e=>{if($s(e))throw KE(0,e)}),ct(e=>!0===e))}const ay={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function sD(n,e,t,i,r){const s=ly(n,e,t);return s.matched?function az(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Ue(r.map(o=>{const a=Ma(o,n);return as(function ZU(n){return n&&Ec(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(Sa(),rD()):Ue(!0)}(i=tD(e,i),e,t).pipe(ct(o=>!0===o?s:{...ay})):Ue(s)}function ly(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...ay}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||HB)(t,n,e);if(!r)return{...ay};const s={};Mn(r.posParams,(a,l)=>{s[l]=a.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function dh(n,e,t,i){if(t.length>0&&function uz(n,e,t){return t.some(i=>hh(n,e,i)&&Ei(i)!==Je)}(n,t,i)){const s=new rt(e,function cz(n,e,t,i){const r={};r[Je]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Ei(s)!==Je){const o=new rt([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[Ei(s)]=o}return r}(n,e,i,new rt(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function dz(n,e,t){return t.some(i=>hh(n,e,i))}(n,t,i)){const s=new rt(n.segments,function lz(n,e,t,i,r){const s={};for(const o of i)if(hh(n,t,o)&&!r[Ei(o)]){const a=new rt([],{});a._sourceSegment=n,a._segmentIndexShift=e.length,s[Ei(o)]=a}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new rt(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function hh(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function oD(n,e,t,i){return!!(Ei(n)===i||i!==Je&&hh(e,t,n))&&("**"===n.path||ly(e,n,t).matched)}function aD(n,e,t){return 0===e.length&&!n.children[t]}const fh=!1;class ph{constructor(e){this.segmentGroup=e||null}}class lD{constructor(e){this.urlTree=e}}function Dc(n){return dc(new ph(n))}function cD(n){return dc(new lD(n))}class mz{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=dh(this.urlTree.root,[],[],this.config).segmentGroup,t=new rt(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Je).pipe(ct(s=>this.createUrlTree(ih(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(os(s=>{if(s instanceof lD)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof ph?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Je).pipe(ct(r=>this.createUrlTree(ih(r),e.queryParams,e.fragment))).pipe(os(r=>{throw r instanceof ph?this.noMatchError(r):r}))}noMatchError(e){return new de(4002,fh)}createUrlTree(e,t,i){const r=jg(e);return new ls(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(ct(s=>new rt([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return an(r).pipe(Ws(s=>{const o=i.children[s],a=nD(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(ct(l=>({segment:l,outlet:s})))}),ME((s,o)=>(s[o.outlet]=o.segment,s),{}),SE())}expandSegment(e,t,i,r,s,o){return an(i).pipe(Ws(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(os(c=>{if(c instanceof ph)return Ue(null);throw c}))),ss(a=>!!a),os((a,l)=>{if(oy(a))return aD(t,r,s)?Ue(new rt([],{})):Dc(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return oD(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):Dc(t):Dc(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?cD(s):this.lineralizeSegments(i,s).pipe(xn(o=>{const a=new rt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=ly(t,r,s);if(!a)return Dc(t);const d=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?cD(d):this.lineralizeSegments(r,d).pipe(xn(h=>this.expandSegment(e,t,i,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=tD(i,e),i.loadChildren?(i._loadedRoutes?Ue({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(ct(a=>(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,new rt(r,{})))):Ue(new rt(r,{}))):sD(t,i,r,e).pipe(or(({matched:o,consumedSegments:a,remainingSegments:l})=>o?this.getChildConfig(e=i._injector??e,i,r).pipe(xn(u=>{const d=u.injector??e,h=u.routes,{segmentGroup:f,slicedSegments:m}=dh(t,a,l,h),p=new rt(f.segments,f.children);if(0===m.length&&p.hasChildren())return this.expandChildren(d,h,p).pipe(ct(y=>new rt(a,y)));if(0===h.length&&0===m.length)return Ue(new rt(a,{}));const g=Ei(i)===s;return this.expandSegment(d,p,h,m,g?Je:s,!0).pipe(ct(_=>new rt(a.concat(_.segments),_.children)))})):Dc(t)))}getChildConfig(e,t,i){return t.children?Ue({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Ue({routes:t._loadedRoutes,injector:t._loadedInjector}):function oz(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Ue(!0):Ue(r.map(o=>{const a=Ma(o,n);return as(function $U(n){return n&&Ec(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(Sa(),rD())}(e,t,i).pipe(xn(r=>r?this.configLoader.loadChildren(e,t).pipe(In(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function fz(n){return dc(JE(fh,3))}())):Ue({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ue(i);if(r.numberOfChildren>1||!r.children[Je])return e.redirectTo,dc(new de(4e3,fh));r=r.children[Je]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new ls(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Mn(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Mn(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,i,r)}),new rt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new de(4001,fh);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class yz{}class xz{constructor(e,t,i,r,s,o,a){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a}recognize(){const e=dh(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Je).pipe(ct(t=>{if(null===t)return null;const i=new oh([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Je,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Lr(i,t),s=new YE(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=XE(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return an(Object.keys(i.children)).pipe(Ws(r=>{const s=i.children[r],o=nD(t,r);return this.processSegmentGroup(e,o,s,r)}),ME((r,s)=>r&&s?(r.push(...s),r):null),function UB(n,e=!1){return pn((t,i)=>{let r=0;t.subscribe(mn(i,s=>{const o=n(s,r++);(o||e)&&i.next(s),!o&&i.complete()}))})}(r=>null!==r),Zd(null),SE(),ct(r=>{if(null===r)return null;const s=dD(r);return function wz(n){n.sort((e,t)=>e.value.outlet===Je?-1:t.value.outlet===Je?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return an(t).pipe(Ws(o=>this.processSegmentAgainstRoute(o._injector??e,o,i,r,s)),ss(o=>!!o),os(o=>{if(oy(o))return aD(i,r,s)?Ue([]):Ue(null);throw o}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!oD(t,i,r,s))return Ue(null);let o;if("**"===t.path){const a=r.length>0?CE(r).parameters:{},l=fD(i)+r.length;o=Ue({snapshot:new oh(r,a,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,pD(t),Ei(t),t.component??t._loadedComponent??null,t,hD(i),l,mD(t)),consumedSegments:[],remainingSegments:[]})}else o=sD(i,t,r,e).pipe(ct(({matched:a,consumedSegments:l,remainingSegments:c,parameters:u})=>{if(!a)return null;const d=fD(i)+l.length;return{snapshot:new oh(l,u,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,pD(t),Ei(t),t.component??t._loadedComponent??null,t,hD(i),d,mD(t)),consumedSegments:l,remainingSegments:c}}));return o.pipe(or(a=>{if(null===a)return Ue(null);const{snapshot:l,consumedSegments:c,remainingSegments:u}=a;e=t._injector??e;const d=t._loadedInjector??e,h=function bz(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:f,slicedSegments:m}=dh(i,c,u,h.filter(g=>void 0===g.redirectTo));if(0===m.length&&f.hasChildren())return this.processChildren(d,h,f).pipe(ct(g=>null===g?null:[new Lr(l,g)]));if(0===h.length&&0===m.length)return Ue([new Lr(l,[])]);const p=Ei(t)===s;return this.processSegment(d,h,f,m,p?Je:s).pipe(ct(g=>null===g?null:[new Lr(l,g)]))}))}}function Mz(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function dD(n){const e=[],t=new Set;for(const i of n){if(!Mz(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=dD(i.children);e.push(new Lr(i.value,r))}return e.filter(i=>!t.has(i))}function hD(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function fD(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function pD(n){return n.data||{}}function mD(n){return n.resolve||{}}function gD(n){return"string"==typeof n.title||null===n.title}function cy(n){return or(e=>{const t=n(e);return t?an(t).pipe(ct(()=>e)):Ue(e)})}const Ea=new We("ROUTES");let uy=(()=>{class n{constructor(t,i){this.injector=t,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ue(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=as(t.loadComponent()).pipe(ct(vD),In(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Hg(()=>{this.componentLoaders.delete(t)})),r=new wE(i,()=>new yr).pipe(zg());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ue({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(ct(a=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,c,u=!1;Array.isArray(a)?c=a:(l=a.create(t).injector,c=DE(l.get(Ea,[],He.Self|He.Optional)));return{routes:c.map(sy),injector:l}}),Hg(()=>{this.childrenLoaders.delete(i)})),o=new wE(s,()=>new yr).pipe(zg());return this.childrenLoaders.set(i,o),o}loadModuleFactoryOrRoutes(t){return as(t()).pipe(ct(vD),xn(r=>r instanceof lM||Array.isArray(r)?Ue(r):an(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(Fe(tr),Fe(JM))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function vD(n){return function Pz(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let gh=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new yr,this.configLoader=dt(uy),this.environmentInjector=dt(Er),this.urlSerializer=dt(mc),this.rootContexts=dt(wc),this.navigationId=0,this.afterPreactivation=()=>Ue(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new vU(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new yU(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new Si({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:_c,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(rs(i=>0!==i.id),ct(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),or(i=>{let r=!1,s=!1;return Ue(i).pipe(In(o=>{this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),or(o=>{const a=t.browserUrlTree.toString(),l=!t.navigated||o.extractedUrl.toString()!==a||a!==t.currentUrlTree.toString();if(!l&&"reload"!==(o.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const u="";return this.events.next(new sh(o.id,t.serializeUrl(i.rawUrl),u,0)),t.rawUrlTree=o.rawUrl,o.resolve(null),Zi}if(t.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return _D(o.source)&&(t.browserUrlTree=o.extractedUrl),Ue(o).pipe(or(u=>{const d=this.transitions?.getValue();return this.events.next(new Yg(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),d!==this.transitions?.getValue()?Zi:Promise.resolve(u)}),function gz(n,e,t,i){return or(r=>function pz(n,e,t,i,r){return new mz(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(ct(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),In(u=>{this.currentNavigation={...this.currentNavigation,finalUrl:u.urlAfterRedirects},i.urlAfterRedirects=u.urlAfterRedirects}),function Ez(n,e,t,i,r){return xn(s=>function _z(n,e,t,i,r,s,o="emptyOnly"){return new xz(n,e,t,i,r,o,s).recognize().pipe(or(a=>null===a?function vz(n){return new Qt(e=>e.error(n))}(new yz):Ue(a)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe(ct(o=>({...s,targetSnapshot:o}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),In(u=>{if(i.targetSnapshot=u.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!u.extras.skipLocationChange){const h=t.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl);t.setBrowserUrl(h,u)}t.browserUrlTree=u.urlAfterRedirects}const d=new hU(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(l&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:u,extractedUrl:d,source:h,restoredState:f,extras:m}=o,p=new Yg(u,this.urlSerializer.serialize(d),h,f);this.events.next(p);const g=qE(d,this.rootComponentType).snapshot;return Ue(i={...o,targetSnapshot:g,urlAfterRedirects:d,extras:{...m,skipLocationChange:!1,replaceUrl:!1}})}{const u="";return this.events.next(new sh(o.id,t.serializeUrl(i.extractedUrl),u,1)),t.rawUrlTree=o.rawUrl,o.resolve(null),Zi}}),In(o=>{const a=new fU(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),ct(o=>i={...o,guards:VU(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),function JU(n,e){return xn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Ue({...t,guardsResult:!0}):function QU(n,e,t,i){return an(n).pipe(xn(r=>function sz(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Ue(s.map(a=>{const l=bc(e)??r,c=Ma(a,l);return as(function YU(n){return n&&Ec(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):l.runInContext(()=>c(n,e,t,i))).pipe(ss())})).pipe(Sa()):Ue(!0)}(r.component,r.route,t,e,i)),ss(r=>!0!==r,!0))}(o,i,r,n).pipe(xn(a=>a&&function jU(n){return"boolean"==typeof n}(a)?function ez(n,e,t,i){return an(e).pipe(Ws(r=>Ug(function nz(n,e){return null!==n&&e&&e(new _U(n)),Ue(!0)}(r.route.parent,i),function tz(n,e){return null!==n&&e&&e(new wU(n)),Ue(!0)}(r.route,i),function rz(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function HU(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>xE(()=>Ue(o.guards.map(l=>{const c=bc(o.node)??t,u=Ma(l,c);return as(function XU(n){return n&&Ec(n.canActivateChild)}(u)?u.canActivateChild(i,n):c.runInContext(()=>u(i,n))).pipe(ss())})).pipe(Sa())));return Ue(s).pipe(Sa())}(n,r.path,t),function iz(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Ue(!0);const r=i.map(s=>xE(()=>{const o=bc(e)??t,a=Ma(s,o);return as(function qU(n){return n&&Ec(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(ss())}));return Ue(r).pipe(Sa())}(n,r.route,t))),ss(r=>!0!==r,!0))}(i,s,n,e):Ue(a)),ct(a=>({...t,guardsResult:a})))})}(this.environmentInjector,o=>this.events.next(o)),In(o=>{if(i.guardsResult=o.guardsResult,$s(o.guardsResult))throw KE(0,o.guardsResult);const a=new pU(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),rs(o=>!!o.guardsResult||(t.restoreHistory(o),this.cancelNavigationTransition(o,"",3),!1)),cy(o=>{if(o.guards.canActivateChecks.length)return Ue(o).pipe(In(a=>{const l=new mU(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),or(a=>{let l=!1;return Ue(a).pipe(function Dz(n,e){return xn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Ue(t);let s=0;return an(r).pipe(Ws(o=>function Cz(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!gD(r)&&(s[fc]=r.title),function Tz(n,e,t,i){const r=function Az(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Ue({});const s={};return an(r).pipe(xn(o=>function Iz(n,e,t,i){const r=bc(e)??i,s=Ma(n,r);return as(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[o],e,t,i).pipe(ss(),In(a=>{s[o]=a}))),Vg(1),function zB(n){return ct(()=>n)}(s),os(o=>oy(o)?Zi:dc(o)))}(s,n,e,i).pipe(ct(o=>(n._resolvedData=o,n.data=XE(n,t).resolve,r&&gD(r)&&(n.data[fc]=r.title),null)))}(o.route,i,n,e)),In(()=>s++),Vg(1),xn(o=>s===r.length?Ue(t):Zi))})}(t.paramsInheritanceStrategy,this.environmentInjector),In({next:()=>l=!0,complete:()=>{l||(t.restoreHistory(a),this.cancelNavigationTransition(a,"",2))}}))}),In(a=>{const l=new gU(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}))}),cy(o=>{const a=l=>{const c=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&c.push(this.configLoader.loadComponent(l.routeConfig).pipe(In(u=>{l.component=u}),ct(()=>{})));for(const u of l.children)c.push(...a(u));return c};return vE(a(o.targetSnapshot.root)).pipe(Zd(),hc(1))}),cy(()=>this.afterPreactivation()),ct(o=>{const a=function IU(n,e,t){const i=xc(n,e._root,t?t._root:void 0);return new $E(i,e)}(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return i={...o,targetRouterState:a}}),In(o=>{t.currentUrlTree=o.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),t.routerState=o.targetRouterState,"deferred"===t.urlUpdateStrategy&&(o.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,o),t.browserUrlTree=o.urlAfterRedirects)}),((n,e,t)=>ct(i=>(new zU(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o)),In({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new qs(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Hg(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),os(o=>{if(s=!0,eD(o)){QE(o)||(t.navigated=!0,t.restoreHistory(i,!0));const a=new rh(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode);if(this.events.next(a),QE(o)){const l=t.urlHandlingStrategy.merge(o.url,t.rawUrlTree),c={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||_D(i.source)};t.scheduleNavigation(l,_c,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const a=new Zg(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);this.events.next(a);try{i.resolve(t.errorHandler(o))}catch(l){i.reject(l)}}return Zi}))}))}cancelNavigationTransition(t,i,r){const s=new rh(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function _D(n){return n!==_c}let xD=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===Je);return i}getResolvedTitleForRoute(t){return t.data[fc]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return dt(Lz)},providedIn:"root"}),n})(),Lz=(()=>{class n extends xD{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(Fe(mE))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Nz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return dt(Fz)},providedIn:"root"}),n})();class Oz{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Fz=(()=>{class n extends Oz{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=function I_(n){return Zr(()=>{const e=n.prototype.constructor,t=e[xr]||dp(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[xr]||dp(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}(n)))(i||n)}}(),n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const yh=new We("",{providedIn:"root",factory:()=>({})});let Bz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:function(){return dt(Uz)},providedIn:"root"}),n})(),Uz=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function zz(n){throw n}function Vz(n,e,t){return e.parse("/")}const Hz={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Gz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ci=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=dt(l3),this.isNgZoneEnabled=!1,this.options=dt(yh,{optional:!0})||{},this.errorHandler=this.options.errorHandler||zz,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Vz,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=dt(Bz),this.routeReuseStrategy=dt(Nz),this.urlCreationStrategy=dt(CU),this.titleStrategy=dt(xD),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=DE(dt(Ea,{optional:!0})??[]),this.navigationTransitions=dt(gh),this.urlSerializer=dt(mc),this.location=dt(pg),this.isNgZoneEnabled=dt($t)instanceof $t&&$t.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new ls,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=qE(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),_c,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(sy),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let u=null;switch(a){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}return null!==u&&(u=this.removeEmptyProps(u)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,u,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=$s(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,_c,null,i)}navigate(t,i={skipLocationChange:!1}){return function Wz(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new de(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...Hz}:!1===i?{...Gz}:i,$s(t))return AE(this.currentUrlTree,t,r);const s=this.parseUrl(t);return AE(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c,u;return o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h}),u="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:u,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const r=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===r?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===r&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(r)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class wD{}let qz=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(rs(t=>t instanceof qs),Ws(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=wd(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?r.push(this.preloadConfig(o,s)):(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return an(r).pipe(Ao())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Ue(null);const s=r.pipe(xn(o=>null===o?Ue(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?an([s,this.loader.loadComponent(i)]).pipe(Ao()):s})}}return n.\u0275fac=function(t){return new(t||n)(Fe(ci),Fe(JM),Fe(Er),Fe(wD),Fe(uy))},n.\u0275prov=Ge({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const fy=new We("");let bD=(()=>{class n{constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Yg?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof qs&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof WE&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new WE(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){!function ow(){throw new Error("invalid")}()},n.\u0275prov=Ge({token:n,factory:n.\u0275fac}),n})();var ui=(()=>((ui=ui||{})[ui.COMPLETE=0]="COMPLETE",ui[ui.FAILED=1]="FAILED",ui[ui.REDIRECTING=2]="REDIRECTING",ui))();const Da=!1;function cs(n,e){return{\u0275kind:n,\u0275providers:e}}const py=new We("",{providedIn:"root",factory:()=>!1});function SD(){const n=dt(tr);return e=>{const t=n.get(Id);if(e!==t.components[0])return;const i=n.get(ci),r=n.get(ED);1===n.get(my)&&i.initialNavigation(),n.get(DD,null,He.Optional)?.setUpPreloading(),n.get(fy,null,He.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.unsubscribe())}}const ED=new We(Da?"bootstrap done indicator":"",{factory:()=>new yr}),my=new We(Da?"initial navigation":"",{providedIn:"root",factory:()=>1});function Jz(){let n=[];return n=Da?[{provide:ed,multi:!0,useFactory:()=>{const e=dt(ci);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function MU(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],cs(1,n)}const DD=new We(Da?"router preloader":"");function Qz(n){return cs(0,[{provide:DD,useExisting:qz},{provide:wD,useExisting:n}])}const Cc=!1,CD=new We(Cc?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),eV=[pg,{provide:mc,useClass:Gg},ci,wc,{provide:ba,useFactory:function MD(n){return n.routerState.root},deps:[ci]},uy,Cc?{provide:py,useValue:!0}:[]];function tV(){return new sS("Router",ci)}let TD=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[eV,Cc&&i?.enableTracing?Jz().\u0275providers:[],{provide:Ea,multi:!0,useValue:t},{provide:CD,useFactory:sV,deps:[[ci,new Nl,new Ol]]},{provide:yh,useValue:i||{}},i?.useHash?{provide:Gs,useClass:Y3}:{provide:Gs,useClass:TS},{provide:fy,useFactory:()=>{const n=dt(gk),e=dt($t),t=dt(yh),i=dt(gh),r=dt(mc);return t.scrollOffset&&n.setOffset(t.scrollOffset),new bD(r,i,n,e,t)}},i?.preloadingStrategy?Qz(i.preloadingStrategy).\u0275providers:[],{provide:sS,multi:!0,useFactory:tV},i?.initialNavigation?oV(i):[],[{provide:AD,useFactory:SD},{provide:KM,multi:!0,useExisting:AD}]]}}static forChild(t){return{ngModule:n,providers:[{provide:Ea,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(Fe(CD,8))},n.\u0275mod=Ts({type:n}),n.\u0275inj=Yr({imports:[iy]}),n})();function sV(n){if(Cc&&n)throw new de(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function oV(n){return["disabled"===n.initialNavigation?cs(3,[{provide:Cd,multi:!0,useFactory:()=>{const e=dt(ci);return()=>{e.setUpLocationChangeListener()}}},{provide:my,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?cs(2,[{provide:my,useValue:0},{provide:Cd,multi:!0,deps:[tr],useFactory:e=>{const t=e.get(q3,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(ci),s=e.get(ED);(function Xz(n,e){n.events.pipe(rs(t=>t instanceof qs||t instanceof rh||t instanceof Zg||t instanceof sh),ct(t=>t instanceof qs||t instanceof sh?ui.COMPLETE:t instanceof rh&&(0===t.code||1===t.code)?ui.REDIRECTING:ui.FAILED),rs(t=>t!==ui.REDIRECTING),hc(1)).subscribe(()=>{e()})})(r,()=>{i(!0)}),e.get(gh).afterPreactivation=()=>(i(!0),s.closed?Ue(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const AD=new We(Cc?"Router Initializer":"");class Ca{}Ca.\u0275fac=function(e){return new(e||Ca)},Ca.\u0275mod=Ts({type:Ca}),Ca.\u0275inj=Yr({imports:[TD.forRoot([]),TD]});class Xs{constructor(){this.subject=new Si(0),this.selectedInfo$=this.subject.asObservable()}setInfo(e){this.subject.next(e)}}function ID(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}Xs.\u0275fac=function(e){return new(e||Xs)},Xs.\u0275prov=Ge({token:Xs,factory:Xs.\u0275fac,providedIn:"root"});const gy="150",Ta={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Aa={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},uV=0,RD=1,dV=2,PD=1,hV=2,Tc=3,Nr=0,di=1,Or=2,us=0,Ia=1,LD=2,ND=3,OD=4,fV=5,Ra=100,pV=101,mV=102,FD=103,kD=104,gV=200,yV=201,vV=202,_V=203,BD=204,UD=205,xV=206,wV=207,bV=208,MV=209,SV=210,EV=0,DV=1,CV=2,yy=3,TV=4,AV=5,IV=6,RV=7,vh=0,PV=1,LV=2,Fr=0,NV=1,OV=2,FV=3,kV=4,BV=5,Ys=301,Zs=302,_h=303,xh=304,Ac=306,Ks=1e3,Rn=1001,Ic=1002,Yt=1003,wh=1004,Rc=1005,Ht=1006,_y=1007,kr=1008,Js=1009,UV=1010,zV=1011,zD=1012,VV=1013,Qs=1014,ds=1015,Pc=1016,HV=1017,GV=1018,Pa=1020,WV=1021,Di=1023,jV=1024,$V=1025,eo=1026,La=1027,qV=1028,XV=1029,YV=1030,ZV=1031,KV=1033,xy=33776,wy=33777,by=33778,My=33779,VD=35840,HD=35841,GD=35842,WD=35843,JV=36196,jD=37492,$D=37496,qD=37808,XD=37809,YD=37810,ZD=37811,KD=37812,JD=37813,QD=37814,eC=37815,tC=37816,nC=37817,iC=37818,rC=37819,sC=37820,oC=37821,Sy=36492,QV=36283,aC=36284,lC=36285,cC=36286,Lc=2300,Na=2301,iH=0,dC=1,Cy=2,to=3e3,St=3001,sH=3201,no=0,oH=1,cr="srgb",Nc="srgb-linear",hC="display-p3",fC="300 es",Ay=1035;class io{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Pn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];const ro=Math.PI/180,Oc=180/Math.PI;function hi(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Pn[255&n]+Pn[n>>8&255]+Pn[n>>16&255]+Pn[n>>24&255]+"-"+Pn[255&e]+Pn[e>>8&255]+"-"+Pn[e>>16&15|64]+Pn[e>>24&255]+"-"+Pn[63&t|128]+Pn[t>>8&255]+"-"+Pn[t>>16&255]+Pn[t>>24&255]+Pn[255&i]+Pn[i>>8&255]+Pn[i>>16&255]+Pn[i>>24&255]).toLowerCase()}function Zt(n,e,t){return Math.max(e,Math.min(t,n))}function Iy(n,e){return(n%e+e)%e}function Fc(n,e,t){return(1-t)*n+t*e}function Ry(n){return 0==(n&n-1)&&0!==n}function mC(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function gC(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Br(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function At(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}const wH_radToDeg=function _H(n){return n*Oc};class X{constructor(e=0,t=0){X.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ln{constructor(){Ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],m=i[8],p=r[0],g=r[3],v=r[6],_=r[1],y=r[4],x=r[7],b=r[2],M=r[5],A=r[8];return s[0]=o*p+a*_+l*b,s[3]=o*g+a*y+l*M,s[6]=o*v+a*x+l*A,s[1]=c*p+u*_+d*b,s[4]=c*g+u*y+d*M,s[7]=c*v+u*x+d*A,s[2]=h*p+f*_+m*b,s[5]=h*g+f*y+m*M,s[8]=h*v+f*x+m*A,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,m=t*d+i*h+r*f;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return e[0]=d*p,e[1]=(r*c-u*i)*p,e[2]=(a*i-r*o)*p,e[3]=h*p,e[4]=(u*t-r*l)*p,e[5]=(r*s-a*t)*p,e[6]=f*p,e[7]=(i*l-c*t)*p,e[8]=(o*t-i*s)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Py.makeScale(e,t)),this}rotate(e){return this.premultiply(Py.makeRotation(-e)),this}translate(e,t){return this.premultiply(Py.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Py=new Ln;function yC(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function kc(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;class Sn{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],m=s[o+2],p=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=m,void(e[t+3]=p);if(d!==p||l!==h||c!==f||u!==m){let g=1-a;const v=l*h+c*f+u*m+d*p,_=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){const b=Math.sqrt(y),M=Math.atan2(b,v*_);g=Math.sin(g*M)/b,a=Math.sin(a*M)/b}const x=a*_;if(l=l*g+h*x,c=c*g+f*x,u=u*g+m*x,d=d*g+p*x,g===1-a){const b=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=b,c*=b,u*=b,d*=b}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],m=s[o+3];return e[t]=a*m+u*d+l*f-c*h,e[t+1]=l*m+u*h+c*d-a*f,e[t+2]=c*m+u*f+a*h-l*d,e[t+3]=u*m-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),m=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d-h*f*m;break;case"YXZ":this._x=h*u*d+c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d+h*f*m;break;case"ZXY":this._x=h*u*d-c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d-h*f*m;break;case"ZYX":this._x=h*u*d-c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d+h*f*m;break;case"YZX":this._x=h*u*d+c*f*m,this._y=c*f*d+h*u*m,this._z=c*u*m-h*f*d,this._w=c*u*d-h*f*m;break;case"XZY":this._x=h*u*d-c*f*m,this._y=c*f*d-h*u*m,this._z=c*u*m+h*f*d,this._w=c*u*d+h*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Zt(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{constructor(e=0,t=0,i=0){D.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(vC.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(vC.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Ly.copy(this).projectOnVector(e),this.sub(Ly)}reflect(e){return this.sub(Ly.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Zt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ly=new D,vC=new Sn;function Ba(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function Ny(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const MH=(new Ln).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),SH=(new Ln).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),hs=new D,CH={[Nc]:n=>n,[cr]:n=>n.convertSRGBToLinear(),[hC]:function EH(n){return n.convertSRGBToLinear(),hs.set(n.r,n.g,n.b).applyMatrix3(SH),n.setRGB(hs.x,hs.y,hs.z)}},TH={[Nc]:n=>n,[cr]:n=>n.convertLinearToSRGB(),[hC]:function DH(n){return hs.set(n.r,n.g,n.b).applyMatrix3(MH),n.setRGB(hs.x,hs.y,hs.z).convertLinearToSRGB()}},Wn={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return Nc},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(!1===this.enabled||e===t||!e||!t)return n;const i=CH[e],r=TH[t];if(void 0===i||void 0===r)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let Ua;class _C{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ua&&(Ua=kc("canvas")),Ua.width=e.width,Ua.height=e.height;const i=Ua.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Ua}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=kc("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Ba(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Ba(t[i]/255)):Ba(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class za{constructor(e=null){this.isSource=!0,this.uuid=hi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(Oy(r[o].isDataTexture?r[o].image:r[o]))}else s=Oy(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Oy(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?_C.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let AH=0,Wi=(()=>{class n extends io{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Rn,s=Rn,o=Ht,a=kr,l=Di,c=Js,u=n.DEFAULT_ANISOTROPY,d=to){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:AH++}),this.uuid=hi(),this.name="",this.source=new za(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new X(0,0),this.repeat=new X(1,1),this.center=new X(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ks:t.x=t.x-Math.floor(t.x);break;case Rn:t.x=t.x<0?0:1;break;case Ic:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ks:t.y=t.y-Math.floor(t.y);break;case Rn:t.y=t.y<0?0:1;break;case Ic:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class Dt{constructor(e=0,t=0,i=0,r=1){Dt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],m=l[9],p=l[2],g=l[6],v=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-p)<.01&&Math.abs(m-g)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+p)<.1&&Math.abs(m+g)<.1&&Math.abs(c+f+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,x=(f+1)/2,b=(v+1)/2,M=(u+h)/4,A=(d+p)/4,w=(m+g)/4;return y>x&&y>b?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=M/i,s=A/i):x>b?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=M/r,s=w/r):b<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),i=A/s,r=w/s),this.set(i,r,s,t),this}let _=Math.sqrt((g-m)*(g-m)+(d-p)*(d-p)+(h-u)*(h-u));return Math.abs(_)<.001&&(_=1),this.x=(g-m)/_,this.y=(d-p)/_,this.z=(h-u)/_,this.w=Math.acos((c+f+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class so extends io{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Dt(0,0,e,t),this.scissorTest=!1,this.viewport=new Dt(0,0,e,t),this.texture=new Wi({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:Ht,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new za(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Fy extends Wi{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Yt,this.minFilter=Yt,this.wrapR=Rn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class xC extends Wi{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Yt,this.minFilter=Yt,this.wrapR=Rn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class fs{constructor(e=new D(1/0,1/0,1/0),t=new D(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],h=e[l+2];u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),h=e.getZ(l);u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=oo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)oo.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(oo)}else null===i.boundingBox&&i.computeBoundingBox(),ky.copy(i.boundingBox),ky.applyMatrix4(e.matrixWorld),this.union(ky);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,oo),oo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Bc),Sh.subVectors(this.max,Bc),Va.subVectors(e.a,Bc),Ha.subVectors(e.b,Bc),Ga.subVectors(e.c,Bc),ps.subVectors(Ha,Va),ms.subVectors(Ga,Ha),ao.subVectors(Va,Ga);let t=[0,-ps.z,ps.y,0,-ms.z,ms.y,0,-ao.z,ao.y,ps.z,0,-ps.x,ms.z,0,-ms.x,ao.z,0,-ao.x,-ps.y,ps.x,0,-ms.y,ms.x,0,-ao.y,ao.x,0];return!(!By(t,Va,Ha,Ga,Sh)||(t=[1,0,0,0,1,0,0,0,1],!By(t,Va,Ha,Ga,Sh)))&&(Eh.crossVectors(ps,ms),t=[Eh.x,Eh.y,Eh.z],By(t,Va,Ha,Ga,Sh))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,oo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(oo).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ur[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ur[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ur[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ur[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ur[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ur[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ur[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ur[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ur)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ur=[new D,new D,new D,new D,new D,new D,new D,new D],oo=new D,ky=new fs,Va=new D,Ha=new D,Ga=new D,ps=new D,ms=new D,ao=new D,Bc=new D,Sh=new D,Eh=new D,lo=new D;function By(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){lo.fromArray(n,s);const a=r.x*Math.abs(lo.x)+r.y*Math.abs(lo.y)+r.z*Math.abs(lo.z),l=e.dot(lo),c=t.dot(lo),u=i.dot(lo);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const IH=new fs,Uc=new D,Uy=new D;class co{constructor(e=new D,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):IH.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Uc.subVectors(e,this.center);const t=Uc.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Uc,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Uy.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Uc.copy(e.center).add(Uy)),this.expandByPoint(Uc.copy(e.center).sub(Uy))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const zr=new D,zy=new D,Dh=new D,gs=new D,Vy=new D,Ch=new D,Hy=new D;class Th{constructor(e=new D,t=new D(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,zr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=zr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(zr.copy(this.origin).addScaledVector(this.direction,t),zr.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){zy.copy(e).add(t).multiplyScalar(.5),Dh.copy(t).sub(e).normalize(),gs.copy(this.origin).sub(zy);const s=.5*e.distanceTo(t),o=-this.direction.dot(Dh),a=gs.dot(this.direction),l=-gs.dot(Dh),c=gs.lengthSq(),u=Math.abs(1-o*o);let d,h,f,m;if(u>0)if(d=o*l-a,h=o*a-l,m=s*u,d>=0)if(h>=-m)if(h<=m){const p=1/u;d*=p,h*=p,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-m?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=m?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(zy).addScaledVector(Dh,h),f}intersectSphere(e,t){zr.subVectors(e.center,this.origin);const i=zr.dot(this.direction),r=zr.dot(zr)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,zr)}intersectTriangle(e,t,i,r,s){Vy.subVectors(t,e),Ch.subVectors(i,e),Hy.crossVectors(Vy,Ch);let a,o=this.direction.dot(Hy);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}gs.subVectors(this.origin,e);const l=a*this.direction.dot(Ch.crossVectors(gs,Ch));if(l<0)return null;const c=a*this.direction.dot(Vy.cross(gs));if(c<0||l+c>o)return null;const u=-a*gs.dot(Hy);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Xe{constructor(){Xe.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,s,o,a,l,c,u,d,h,f,m,p,g){const v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=u,v[10]=d,v[14]=h,v[3]=f,v[7]=m,v[11]=p,v[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Xe).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Wa.setFromMatrixColumn(e,0).length(),s=1/Wa.setFromMatrixColumn(e,1).length(),o=1/Wa.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,m=a*u,p=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+m*c,t[5]=h-p*c,t[9]=-a*l,t[2]=p-h*c,t[6]=m+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,m=c*u,p=c*d;t[0]=h+p*a,t[4]=m*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-m,t[6]=p+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,m=c*u,p=c*d;t[0]=h-p*a,t[4]=-o*d,t[8]=m+f*a,t[1]=f+m*a,t[5]=o*u,t[9]=p-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,m=a*u,p=a*d;t[0]=l*u,t[4]=m*c-f,t[8]=h*c+p,t[1]=l*d,t[5]=p*c+h,t[9]=f*c-m,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*u,t[4]=p-h*d,t[8]=m*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+m,t[10]=h-p*d}else if("XZY"===e.order){const h=o*l,f=o*c,m=a*l,p=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+p,t[5]=o*u,t[9]=f*d-m,t[2]=m*d-f,t[6]=a*u,t[10]=p*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(RH,e,PH)}lookAt(e,t,i){const r=this.elements;return fi.subVectors(e,t),0===fi.lengthSq()&&(fi.z=1),fi.normalize(),ys.crossVectors(i,fi),0===ys.lengthSq()&&(1===Math.abs(i.z)?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),ys.crossVectors(i,fi)),ys.normalize(),Ah.crossVectors(fi,ys),r[0]=ys.x,r[4]=Ah.x,r[8]=fi.x,r[1]=ys.y,r[5]=Ah.y,r[9]=fi.y,r[2]=ys.z,r[6]=Ah.z,r[10]=fi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],m=i[2],p=i[6],g=i[10],v=i[14],_=i[3],y=i[7],x=i[11],b=i[15],M=r[0],A=r[4],w=r[8],S=r[12],R=r[1],O=r[5],H=r[9],N=r[13],P=r[2],z=r[6],Y=r[10],ne=r[14],j=r[3],J=r[7],te=r[11],_e=r[15];return s[0]=o*M+a*R+l*P+c*j,s[4]=o*A+a*O+l*z+c*J,s[8]=o*w+a*H+l*Y+c*te,s[12]=o*S+a*N+l*ne+c*_e,s[1]=u*M+d*R+h*P+f*j,s[5]=u*A+d*O+h*z+f*J,s[9]=u*w+d*H+h*Y+f*te,s[13]=u*S+d*N+h*ne+f*_e,s[2]=m*M+p*R+g*P+v*j,s[6]=m*A+p*O+g*z+v*J,s[10]=m*w+p*H+g*Y+v*te,s[14]=m*S+p*N+g*ne+v*_e,s[3]=_*M+y*R+x*P+b*j,s[7]=_*A+y*O+x*z+b*J,s[11]=_*w+y*H+x*Y+b*te,s[15]=_*S+y*N+x*ne+b*_e,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],m=e[12],p=e[13],g=e[14],v=e[15],_=d*g*c-p*h*c+p*l*f-a*g*f-d*l*v+a*h*v,y=m*h*c-u*g*c-m*l*f+o*g*f+u*l*v-o*h*v,x=u*p*c-m*d*c+m*a*f-o*p*f-u*a*v+o*d*v,b=m*d*l-u*p*l-m*a*h+o*p*h+u*a*g-o*d*g,M=t*_+i*y+r*x+s*b;if(0===M)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/M;return e[0]=_*A,e[1]=(p*h*s-d*g*s-p*r*f+i*g*f+d*r*v-i*h*v)*A,e[2]=(a*g*s-p*l*s+p*r*c-i*g*c-a*r*v+i*l*v)*A,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*A,e[4]=y*A,e[5]=(u*g*s-m*h*s+m*r*f-t*g*f-u*r*v+t*h*v)*A,e[6]=(m*l*s-o*g*s-m*r*c+t*g*c+o*r*v-t*l*v)*A,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*A,e[8]=x*A,e[9]=(m*d*s-u*p*s-m*i*f+t*p*f+u*i*v-t*d*v)*A,e[10]=(o*p*s-m*a*s+m*i*c-t*p*c-o*i*v+t*a*v)*A,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*A,e[12]=b*A,e[13]=(u*p*r-m*d*r+m*i*h-t*p*h-u*i*g+t*d*g)*A,e[14]=(m*a*r-o*p*r-m*i*l+t*p*l+o*i*g-t*a*g)*A,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*A,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,m=s*d,p=o*u,g=o*d,v=a*d,_=l*c,y=l*u,x=l*d,b=i.x,M=i.y,A=i.z;return r[0]=(1-(p+v))*b,r[1]=(f+x)*b,r[2]=(m-y)*b,r[3]=0,r[4]=(f-x)*M,r[5]=(1-(h+v))*M,r[6]=(g+_)*M,r[7]=0,r[8]=(m+y)*A,r[9]=(g-_)*A,r[10]=(1-(h+p))*A,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Wa.set(r[0],r[1],r[2]).length();const o=Wa.set(r[4],r[5],r[6]).length(),a=Wa.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ji.copy(this);const c=1/s,u=1/o,d=1/a;return ji.elements[0]*=c,ji.elements[1]*=c,ji.elements[2]*=c,ji.elements[4]*=u,ji.elements[5]*=u,ji.elements[6]*=u,ji.elements[8]*=d,ji.elements[9]*=d,ji.elements[10]*=d,t.setFromRotationMatrix(ji),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),d=(t+e)*l,h=(i+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Wa=new D,ji=new Xe,RH=new D(0,0,0),PH=new D(1,1,1),ys=new D,Ah=new D,fi=new D,wC=new Xe,bC=new Sn;let LH=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],m=s[10];switch(i){case"XYZ":this._y=Math.asin(Zt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Zt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(Zt(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-Zt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,m),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Zt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-Zt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return wC.makeRotationFromQuaternion(t),this.setFromRotationMatrix(wC,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return bC.setFromEuler(this),this.setFromQuaternion(bC,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class Gy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let NH=0;const MC=new D,ja=new Sn,Vr=new Xe,Ih=new D,zc=new D,OH=new D,FH=new Sn,SC=new D(1,0,0),EC=new D(0,1,0),DC=new D(0,0,1),kH={type:"added"},CC={type:"removed"};let dn=(()=>{class n extends io{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:NH++}),this.uuid=hi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new D,i=new LH,r=new Sn,s=new D(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Xe},normalMatrix:{value:new Ln}}),this.matrix=new Xe,this.matrixWorld=new Xe,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Gy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return ja.setFromAxisAngle(t,i),this.quaternion.multiply(ja),this}rotateOnWorldAxis(t,i){return ja.setFromAxisAngle(t,i),this.quaternion.premultiply(ja),this}rotateX(t){return this.rotateOnAxis(SC,t)}rotateY(t){return this.rotateOnAxis(EC,t)}rotateZ(t){return this.rotateOnAxis(DC,t)}translateOnAxis(t,i){return MC.copy(t).applyQuaternion(this.quaternion),this.position.add(MC.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(SC,t)}translateY(t){return this.translateOnAxis(EC,t)}translateZ(t){return this.translateOnAxis(DC,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Vr.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?Ih.copy(t):Ih.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),zc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vr.lookAt(zc,Ih,this.up):Vr.lookAt(Ih,zc,this.up),this.quaternion.setFromRotationMatrix(Vr),s&&(Vr.extractRotation(s.matrixWorld),ja.setFromRotationMatrix(Vr),this.quaternion.premultiply(ja.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(kH)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(CC)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(CC)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Vr.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Vr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Vr),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i){let r=[];this[t]===i&&r.push(this);for(let s=0,o=this.children.length;s<o;s++){const a=this.children[s].getObjectsByProperty(t,i);a.length>0&&(r=r.concat(a))}return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zc,t,OH),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zc,FH,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++){const o=i[r];(!0===o.matrixWorldAutoUpdate||!0===t)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&!0===r.matrixWorldAutoUpdate&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++){const l=s[o];!0===l.matrixWorldAutoUpdate&&l.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),m=a(t.animations),p=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),m.length>0&&(r.animations=m),p.length>0&&(r.nodes=p)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new D(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const $i=new D,Hr=new D,Wy=new D,Gr=new D,$a=new D,qa=new D,TC=new D,jy=new D,$y=new D,qy=new D;class qi{constructor(e=new D,t=new D,i=new D){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),$i.subVectors(e,t),r.cross($i);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){$i.subVectors(r,t),Hr.subVectors(i,t),Wy.subVectors(e,t);const o=$i.dot($i),a=$i.dot(Hr),l=$i.dot(Wy),c=Hr.dot(Hr),u=Hr.dot(Wy),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,m=(o*u-a*l)*h;return s.set(1-f-m,m,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Gr),Gr.x>=0&&Gr.y>=0&&Gr.x+Gr.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Gr),l.set(0,0),l.addScaledVector(s,Gr.x),l.addScaledVector(o,Gr.y),l.addScaledVector(a,Gr.z),l}static isFrontFacing(e,t,i,r){return $i.subVectors(i,t),Hr.subVectors(e,t),$i.cross(Hr).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return $i.subVectors(this.c,this.b),Hr.subVectors(this.a,this.b),.5*$i.cross(Hr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return qi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return qi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return qi.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return qi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return qi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;$a.subVectors(r,i),qa.subVectors(s,i),jy.subVectors(e,i);const l=$a.dot(jy),c=qa.dot(jy);if(l<=0&&c<=0)return t.copy(i);$y.subVectors(e,r);const u=$a.dot($y),d=qa.dot($y);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector($a,o);qy.subVectors(e,s);const f=$a.dot(qy),m=qa.dot(qy);if(m>=0&&f<=m)return t.copy(s);const p=f*c-l*m;if(p<=0&&c>=0&&m<=0)return a=c/(c-m),t.copy(i).addScaledVector(qa,a);const g=u*m-f*d;if(g<=0&&d-u>=0&&f-m>=0)return TC.subVectors(s,r),a=(d-u)/(d-u+(f-m)),t.copy(r).addScaledVector(TC,a);const v=1/(g+p+h);return o=p*v,a=h*v,t.copy(i).addScaledVector($a,o).addScaledVector(qa,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let BH=0;class Xi extends io{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:BH++}),this.uuid=hi(),this.name="",this.type="Material",this.blending=Ia,this.side=Nr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=BD,this.blendDst=UD,this.blendEquation=Ra,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=yy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Ia&&(i.blending=this.blending),this.side!==Nr&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}const AC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yi={h:0,s:0,l:0},Rh={h:0,s:0,l:0};function Xy(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class ge{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=cr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Wn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Wn.workingColorSpace){return this.r=e,this.g=t,this.b=i,Wn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Wn.workingColorSpace){if(e=Iy(e,1),t=Zt(t,0,1),i=Zt(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=Xy(o,s,e+1/3),this.g=Xy(o,s,e),this.b=Xy(o,s,e-1/3)}return Wn.toWorkingColorSpace(this,r),this}setStyle(e,t=cr){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Wn.toWorkingColorSpace(this,t),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Wn.toWorkingColorSpace(this,t),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,u=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,c,u,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Wn.toWorkingColorSpace(this,t),this;if(6===o)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Wn.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=cr){const i=AC[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ba(e.r),this.g=Ba(e.g),this.b=Ba(e.b),this}copyLinearToSRGB(e){return this.r=Ny(e.r),this.g=Ny(e.g),this.b=Ny(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=cr){return Wn.fromWorkingColorSpace(Nn.copy(this),e),Zt(255*Nn.r,0,255)<<16^Zt(255*Nn.g,0,255)<<8^Zt(255*Nn.b,0,255)<<0}getHexString(e=cr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Wn.workingColorSpace){Wn.fromWorkingColorSpace(Nn.copy(this),t);const i=Nn.r,r=Nn.g,s=Nn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Wn.workingColorSpace){return Wn.fromWorkingColorSpace(Nn.copy(this),t),e.r=Nn.r,e.g=Nn.g,e.b=Nn.b,e}getStyle(e=cr){Wn.fromWorkingColorSpace(Nn.copy(this),e);const t=Nn.r,i=Nn.g,r=Nn.b;return e!==cr?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${255*t|0},${255*i|0},${255*r|0})`}offsetHSL(e,t,i){return this.getHSL(Yi),Yi.h+=e,Yi.s+=t,Yi.l+=i,this.setHSL(Yi.h,Yi.s,Yi.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Yi),e.getHSL(Rh);const i=Fc(Yi.h,Rh.h,t),r=Fc(Yi.s,Rh.s,t),s=Fc(Yi.l,Rh.l,t);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Nn=new ge;ge.NAMES=AC;class Ci extends Xi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const rn=new D,Ph=new X;class Gt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)Ph.fromBufferAttribute(this,t),Ph.applyMatrix3(e),this.setXY(t,Ph.x,Ph.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)rn.fromBufferAttribute(this,t),rn.applyMatrix3(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)rn.fromBufferAttribute(this,t),rn.applyMatrix4(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)rn.fromBufferAttribute(this,t),rn.applyNormalMatrix(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)rn.fromBufferAttribute(this,t),rn.transformDirection(e),this.setXYZ(t,rn.x,rn.y,rn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Br(t,this.array)),t}setX(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Br(t,this.array)),t}setY(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Br(t,this.array)),t}setZ(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Br(t,this.array)),t}setW(e,t){return this.normalized&&(t=At(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),i=At(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array),s=At(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class IC extends Gt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class RC extends Gt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class De extends Gt{constructor(e,t,i){super(new Float32Array(e),t,i)}}let UH=0;const Ti=new Xe,Yy=new dn,Xa=new D,pi=new fs,Vc=new fs,gn=new D;class st extends io{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:UH++}),this.uuid=hi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(yC(e)?RC:IC)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new Ln).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ti.makeRotationFromQuaternion(e),this.applyMatrix4(Ti),this}rotateX(e){return Ti.makeRotationX(e),this.applyMatrix4(Ti),this}rotateY(e){return Ti.makeRotationY(e),this.applyMatrix4(Ti),this}rotateZ(e){return Ti.makeRotationZ(e),this.applyMatrix4(Ti),this}translate(e,t,i){return Ti.makeTranslation(e,t,i),this.applyMatrix4(Ti),this}scale(e,t,i){return Ti.makeScale(e,t,i),this.applyMatrix4(Ti),this}lookAt(e){return Yy.lookAt(e),Yy.updateMatrix(),this.applyMatrix4(Yy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xa).negate(),this.translate(Xa.x,Xa.y,Xa.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new De(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new fs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new D(-1/0,-1/0,-1/0),new D(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)pi.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(gn.addVectors(this.boundingBox.min,pi.min),this.boundingBox.expandByPoint(gn),gn.addVectors(this.boundingBox.max,pi.max),this.boundingBox.expandByPoint(gn)):(this.boundingBox.expandByPoint(pi.min),this.boundingBox.expandByPoint(pi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new co);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new D,1/0);if(e){const i=this.boundingSphere.center;if(pi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Vc.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(gn.addVectors(pi.min,Vc.min),pi.expandByPoint(gn),gn.addVectors(pi.max,Vc.max),pi.expandByPoint(gn)):(pi.expandByPoint(Vc.min),pi.expandByPoint(Vc.max));pi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)gn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(gn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)gn.fromBufferAttribute(a,c),l&&(Xa.fromBufferAttribute(e,c),gn.add(Xa)),r=Math.max(r,i.distanceToSquared(gn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Gt(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let R=0;R<a;R++)c[R]=new D,u[R]=new D;const d=new D,h=new D,f=new D,m=new X,p=new X,g=new X,v=new D,_=new D;function y(R,O,H){d.fromArray(r,3*R),h.fromArray(r,3*O),f.fromArray(r,3*H),m.fromArray(o,2*R),p.fromArray(o,2*O),g.fromArray(o,2*H),h.sub(d),f.sub(d),p.sub(m),g.sub(m);const N=1/(p.x*g.y-g.x*p.y);isFinite(N)&&(v.copy(h).multiplyScalar(g.y).addScaledVector(f,-p.y).multiplyScalar(N),_.copy(f).multiplyScalar(p.x).addScaledVector(h,-g.x).multiplyScalar(N),c[R].add(v),c[O].add(v),c[H].add(v),u[R].add(_),u[O].add(_),u[H].add(_))}let x=this.groups;0===x.length&&(x=[{start:0,count:i.length}]);for(let R=0,O=x.length;R<O;++R){const H=x[R],N=H.start;for(let z=N,Y=N+H.count;z<Y;z+=3)y(i[z+0],i[z+1],i[z+2])}const b=new D,M=new D,A=new D,w=new D;function S(R){A.fromArray(s,3*R),w.copy(A);const O=c[R];b.copy(O),b.sub(A.multiplyScalar(A.dot(O))).normalize(),M.crossVectors(w,O);const N=M.dot(u[R])<0?-1:1;l[4*R]=b.x,l[4*R+1]=b.y,l[4*R+2]=b.z,l[4*R+3]=N}for(let R=0,O=x.length;R<O;++R){const H=x[R],N=H.start;for(let z=N,Y=N+H.count;z<Y;z+=3)S(i[z+0]),S(i[z+1]),S(i[z+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new Gt(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new D,s=new D,o=new D,a=new D,l=new D,c=new D,u=new D,d=new D;if(e)for(let h=0,f=e.count;h<f;h+=3){const m=e.getX(h+0),p=e.getX(h+1),g=e.getX(h+2);r.fromBufferAttribute(t,m),s.fromBufferAttribute(t,p),o.fromBufferAttribute(t,g),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,m),l.fromBufferAttribute(i,p),c.fromBufferAttribute(i,g),a.add(u),l.add(u),c.add(u),i.setXYZ(m,a.x,a.y,a.z),i.setXYZ(p,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)gn.fromBufferAttribute(e,t),gn.normalize(),e.setXYZ(t,gn.x,gn.y,gn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,m=0;for(let p=0,g=l.length;p<g;p++){f=a.isInterleavedBufferAttribute?l[p]*a.data.stride+a.offset:l[p]*u;for(let v=0;v<u;v++)h[m++]=c[f++]}return new Gt(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new st,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const PC=new Xe,ur=new Th,Lh=new co,LC=new D,Hc=new D,Gc=new D,Wc=new D,Zy=new D,Nh=new D,Oh=new X,Fh=new X,kh=new X,Ky=new D,Bh=new D;class On extends dn{constructor(e=new st,t=new Ci){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){Nh.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l];0!==u&&(Zy.fromBufferAttribute(s[l],e),Nh.addScaledVector(o?Zy:Zy.sub(t),u))}t.add(Nh)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),Lh.copy(i.boundingSphere),Lh.applyMatrix4(s),ur.copy(e.ray).recast(e.near),!1===Lh.containsPoint(ur.origin)&&(null===ur.intersectSphere(Lh,LC)||ur.origin.distanceToSquared(LC)>(e.far-e.near)**2))||(PC.copy(s).invert(),ur.copy(e.ray).applyMatrix4(PC),null!==i.boundingBox&&!1===ur.intersectsBox(i.boundingBox)))return;let o;const a=i.index,l=i.attributes.position,c=i.attributes.uv,u=i.attributes.uv2,d=i.groups,h=i.drawRange;if(null!==a)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const p=d[f],g=r[p.materialIndex];for(let y=Math.max(p.start,h.start),x=Math.min(a.count,Math.min(p.start+p.count,h.start+h.count));y<x;y+=3){const b=a.getX(y),M=a.getX(y+1),A=a.getX(y+2);o=Uh(this,g,e,ur,c,u,b,M,A),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=p.materialIndex,t.push(o))}}else for(let p=Math.max(0,h.start),g=Math.min(a.count,h.start+h.count);p<g;p+=3){const v=a.getX(p),_=a.getX(p+1),y=a.getX(p+2);o=Uh(this,r,e,ur,c,u,v,_,y),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let f=0,m=d.length;f<m;f++){const p=d[f],g=r[p.materialIndex];for(let y=Math.max(p.start,h.start),x=Math.min(l.count,Math.min(p.start+p.count,h.start+h.count));y<x;y+=3)o=Uh(this,g,e,ur,c,u,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),o.face.materialIndex=p.materialIndex,t.push(o))}else for(let p=Math.max(0,h.start),g=Math.min(l.count,h.start+h.count);p<g;p+=3)o=Uh(this,r,e,ur,c,u,p,p+1,p+2),o&&(o.faceIndex=Math.floor(p/3),t.push(o))}}function Uh(n,e,t,i,r,s,o,a,l){n.getVertexPosition(o,Hc),n.getVertexPosition(a,Gc),n.getVertexPosition(l,Wc);const c=function zH(n,e,t,i,r,s,o,a){let l;if(l=e.side===di?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,e.side===Nr,a),null===l)return null;Bh.copy(a),Bh.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Bh);return c<t.near||c>t.far?null:{distance:c,point:Bh.clone(),object:n}}(n,e,t,i,Hc,Gc,Wc,Ky);if(c){r&&(Oh.fromBufferAttribute(r,o),Fh.fromBufferAttribute(r,a),kh.fromBufferAttribute(r,l),c.uv=qi.getUV(Ky,Hc,Gc,Wc,Oh,Fh,kh,new X)),s&&(Oh.fromBufferAttribute(s,o),Fh.fromBufferAttribute(s,a),kh.fromBufferAttribute(s,l),c.uv2=qi.getUV(Ky,Hc,Gc,Wc,Oh,Fh,kh,new X));const u={a:o,b:a,c:l,normal:new D,materialIndex:0};qi.getNormal(Hc,Gc,Wc,u.normal),c.face=u}return c}class Ya extends st{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function m(p,g,v,_,y,x,b,M,A,w,S){const R=x/A,O=b/w,H=x/2,N=b/2,P=M/2,z=A+1,Y=w+1;let ne=0,j=0;const J=new D;for(let te=0;te<Y;te++){const _e=te*O-N;for(let V=0;V<z;V++)J[p]=(V*R-H)*_,J[g]=_e*y,J[v]=P,c.push(J.x,J.y,J.z),J[p]=0,J[g]=0,J[v]=M>0?1:-1,u.push(J.x,J.y,J.z),d.push(V/A),d.push(1-te/w),ne+=1}for(let te=0;te<w;te++)for(let _e=0;_e<A;_e++){const Q=h+_e+z*(te+1),oe=h+(_e+1)+z*(te+1),k=h+(_e+1)+z*te;l.push(h+_e+z*te,Q,k),l.push(Q,oe,k),j+=6}a.addGroup(f,j,S),f+=j,h+=ne}m("z","y","x",-1,-1,i,t,e,o,s,0),m("z","y","x",1,-1,i,t,-e,o,s,1),m("x","z","y",1,1,e,i,t,r,o,2),m("x","z","y",1,-1,e,i,-t,r,o,3),m("x","y","z",1,-1,e,t,i,r,s,4),m("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new De(c,3)),this.setAttribute("normal",new De(u,3)),this.setAttribute("uv",new De(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ya(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Za(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function jn(n){const e={};for(let t=0;t<n.length;t++){const i=Za(n[t]);for(const r in i)e[r]=i[r]}return e}function NC(n){return null===n.getRenderTarget()&&n.outputEncoding===St?cr:Nc}const HH={clone:Za,merge:jn};class vs extends Xi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Za(e.uniforms),this.uniformsGroups=function VH(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Jy extends dn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Xe,this.projectionMatrix=new Xe,this.projectionMatrixInverse=new Xe}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class yn extends Jy{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Oc*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*ro*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Oc*Math.atan(Math.tan(.5*ro*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*ro*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class jH extends dn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new yn(-90,1,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new yn(-90,1,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new yn(-90,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new yn(-90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new yn(-90,1,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new yn(-90,1,e,t);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),d=e.toneMapping,h=e.xr.enabled;e.toneMapping=Fr,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=d,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class zh extends Wi{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:Ys,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class $H extends so{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new zh([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Ht}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Ya(5,5,5),s=new vs({name:"CubemapFromEquirect",uniforms:Za(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:di,blending:us});s.uniforms.tEquirect.value=t;const o=new On(r,s),a=t.minFilter;return t.minFilter===kr&&(t.minFilter=Ht),new jH(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const Qy=new D,qH=new D,XH=new Ln;class uo{constructor(e=new D(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Qy.subVectors(i,t).cross(qH.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(Qy),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||XH.getNormalMatrix(e),r=this.coplanarPoint(Qy).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Qa=new co,Vh=new D;class ev{constructor(e=new uo,t=new uo,i=new uo,r=new uo,s=new uo,o=new uo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],m=i[10],p=i[11],g=i[12],v=i[13],_=i[14],y=i[15];return t[0].setComponents(a-r,d-l,p-h,y-g).normalize(),t[1].setComponents(a+r,d+l,p+h,y+g).normalize(),t[2].setComponents(a+s,d+c,p+f,y+v).normalize(),t[3].setComponents(a-s,d-c,p-f,y-v).normalize(),t[4].setComponents(a-o,d-u,p-m,y-_).normalize(),t[5].setComponents(a+o,d+u,p+m,y+_).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Qa.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Qa)}intersectsSprite(e){return Qa.center.set(0,0,0),Qa.radius=.7071067811865476,Qa.applyMatrix4(e.matrixWorld),this.intersectsSphere(Qa)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Vh.x=r.normal.x>0?e.max.x:e.min.x,Vh.y=r.normal.y>0?e.max.y:e.min.y,Vh.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Vh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function OC(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function YH(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let m;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)m=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");m=5131}else m=5123;else if(d instanceof Int16Array)m=5122;else if(d instanceof Uint32Array)m=5125;else if(d instanceof Int32Array)m=5124;else if(d instanceof Int8Array)m=5120;else if(d instanceof Uint8Array)m=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);m=5121}return{buffer:f,type:m,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}(d.buffer,c,u),d.version=c.version)}}}class Hh extends st{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],m=[],p=[],g=[];for(let v=0;v<u;v++){const _=v*h-o;for(let y=0;y<c;y++)m.push(y*d-s,-_,0),p.push(0,0,1),g.push(y/a),g.push(1-v/l)}for(let v=0;v<l;v++)for(let _=0;_<a;_++){const x=_+c*(v+1),b=_+1+c*(v+1),M=_+1+c*v;f.push(_+c*v,x,M),f.push(x,b,M)}this.setIndex(f),this.setAttribute("position",new De(m,3)),this.setAttribute("normal",new De(p,3)),this.setAttribute("uv",new De(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hh(e.width,e.height,e.widthSegments,e.heightSegments)}}const it={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\t\n\t\tvec2 lodFudge = pow( 1.95, lod ) / fullSize;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec2 fullSize = vec2( textureSize( sampler, 0 ) );\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ue={common:{diffuse:{value:new ge(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ln},uv2Transform:{value:new Ln},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new X(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ge(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ge(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ln}},sprite:{diffuse:{value:new ge(16777215)},opacity:{value:1},center:{value:new X(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ln}}},dr={basic:{uniforms:jn([ue.common,ue.specularmap,ue.envmap,ue.aomap,ue.lightmap,ue.fog]),vertexShader:it.meshbasic_vert,fragmentShader:it.meshbasic_frag},lambert:{uniforms:jn([ue.common,ue.specularmap,ue.envmap,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.fog,ue.lights,{emissive:{value:new ge(0)}}]),vertexShader:it.meshlambert_vert,fragmentShader:it.meshlambert_frag},phong:{uniforms:jn([ue.common,ue.specularmap,ue.envmap,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.fog,ue.lights,{emissive:{value:new ge(0)},specular:{value:new ge(1118481)},shininess:{value:30}}]),vertexShader:it.meshphong_vert,fragmentShader:it.meshphong_frag},standard:{uniforms:jn([ue.common,ue.envmap,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.roughnessmap,ue.metalnessmap,ue.fog,ue.lights,{emissive:{value:new ge(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:it.meshphysical_vert,fragmentShader:it.meshphysical_frag},toon:{uniforms:jn([ue.common,ue.aomap,ue.lightmap,ue.emissivemap,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.gradientmap,ue.fog,ue.lights,{emissive:{value:new ge(0)}}]),vertexShader:it.meshtoon_vert,fragmentShader:it.meshtoon_frag},matcap:{uniforms:jn([ue.common,ue.bumpmap,ue.normalmap,ue.displacementmap,ue.fog,{matcap:{value:null}}]),vertexShader:it.meshmatcap_vert,fragmentShader:it.meshmatcap_frag},points:{uniforms:jn([ue.points,ue.fog]),vertexShader:it.points_vert,fragmentShader:it.points_frag},dashed:{uniforms:jn([ue.common,ue.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:it.linedashed_vert,fragmentShader:it.linedashed_frag},depth:{uniforms:jn([ue.common,ue.displacementmap]),vertexShader:it.depth_vert,fragmentShader:it.depth_frag},normal:{uniforms:jn([ue.common,ue.bumpmap,ue.normalmap,ue.displacementmap,{opacity:{value:1}}]),vertexShader:it.meshnormal_vert,fragmentShader:it.meshnormal_frag},sprite:{uniforms:jn([ue.sprite,ue.fog]),vertexShader:it.sprite_vert,fragmentShader:it.sprite_frag},background:{uniforms:{uvTransform:{value:new Ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:it.background_vert,fragmentShader:it.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:it.backgroundCube_vert,fragmentShader:it.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:it.cube_vert,fragmentShader:it.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:it.equirect_vert,fragmentShader:it.equirect_frag},distanceRGBA:{uniforms:jn([ue.common,ue.displacementmap,{referencePosition:{value:new D},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:it.distanceRGBA_vert,fragmentShader:it.distanceRGBA_frag},shadow:{uniforms:jn([ue.lights,ue.fog,{color:{value:new ge(0)},opacity:{value:1}}]),vertexShader:it.shadow_vert,fragmentShader:it.shadow_frag}};dr.physical={uniforms:jn([dr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new X(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ge(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new X},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ge(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ge(1,1,1)},specularColorMap:{value:null}}]),vertexShader:it.meshphysical_vert,fragmentShader:it.meshphysical_frag};const Gh={r:0,b:0,g:0};function XG(n,e,t,i,r,s,o){const a=new ge(0);let c,u,l=!0===s?0:1,d=null,h=0,f=null;function p(g,v){g.getRGB(Gh,NC(n)),i.buffers.color.setClear(Gh.r,Gh.g,Gh.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(g,v=1){a.set(g),l=v,p(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,p(a,l)},render:function m(g,v){let _=!1,y=!0===v.isScene?v.background:null;y&&y.isTexture&&(y=(v.backgroundBlurriness>0?t:e).get(y));const x=n.xr,b=x.getSession&&x.getSession();b&&"additive"===b.environmentBlendMode&&(y=null),null===y?p(a,l):y&&y.isColor&&(p(y,1),_=!0),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===Ac)?(void 0===u&&(u=new On(new Ya(1,1,1),new vs({name:"BackgroundCubeMaterial",uniforms:Za(dr.backgroundCube.uniforms),vertexShader:dr.backgroundCube.vertexShader,fragmentShader:dr.backgroundCube.fragmentShader,side:di,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,A,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=y.encoding!==St,(d!==y||h!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(void 0===c&&(c=new On(new Hh(2,2),new vs({name:"BackgroundMaterial",uniforms:Za(dr.background.uniforms),vertexShader:dr.background.vertexShader,fragmentShader:dr.background.fragmentShader,side:Nr,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=y,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=y.encoding!==St,!0===y.matrixAutoUpdate&&y.updateMatrix(),c.material.uniforms.uvTransform.value.copy(y.matrix),(d!==y||h!==y.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=y,h=y.version,f=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}}}function YG(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(P){return i.isWebGL2?n.bindVertexArray(P):s.bindVertexArrayOES(P)}function m(P){return i.isWebGL2?n.deleteVertexArray(P):s.deleteVertexArrayOES(P)}function g(P){const z=[],Y=[],ne=[];for(let j=0;j<r;j++)z[j]=0,Y[j]=0,ne[j]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:Y,attributeDivisors:ne,object:P,attributes:{},index:null}}function y(){const P=c.newAttributes;for(let z=0,Y=P.length;z<Y;z++)P[z]=0}function x(P){b(P,0)}function b(P,z){const ne=c.enabledAttributes,j=c.attributeDivisors;c.newAttributes[P]=1,0===ne[P]&&(n.enableVertexAttribArray(P),ne[P]=1),j[P]!==z&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,z),j[P]=z)}function M(){const P=c.newAttributes,z=c.enabledAttributes;for(let Y=0,ne=z.length;Y<ne;Y++)z[Y]!==P[Y]&&(n.disableVertexAttribArray(Y),z[Y]=0)}function A(P,z,Y,ne,j,J){!0!==i.isWebGL2||5124!==Y&&5125!==Y?n.vertexAttribPointer(P,z,Y,ne,j,J):n.vertexAttribIPointer(P,z,Y,j,J)}function H(){N(),u=!0,c!==l&&(c=l,f(c.object))}function N(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(P,z,Y,ne,j){let J=!1;if(o){const te=function p(P,z,Y){const ne=!0===Y.wireframe;let j=a[P.id];void 0===j&&(j={},a[P.id]=j);let J=j[z.id];void 0===J&&(J={},j[z.id]=J);let te=J[ne];return void 0===te&&(te=g(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),J[ne]=te),te}(ne,Y,z);c!==te&&(c=te,f(c.object)),J=function v(P,z,Y,ne){const j=c.attributes,J=z.attributes;let te=0;const _e=Y.getAttributes();for(const V in _e)if(_e[V].location>=0){const oe=j[V];let k=J[V];if(void 0===k&&("instanceMatrix"===V&&P.instanceMatrix&&(k=P.instanceMatrix),"instanceColor"===V&&P.instanceColor&&(k=P.instanceColor)),void 0===oe||oe.attribute!==k||k&&oe.data!==k.data)return!0;te++}return c.attributesNum!==te||c.index!==ne}(P,ne,Y,j),J&&function _(P,z,Y,ne){const j={},J=z.attributes;let te=0;const _e=Y.getAttributes();for(const V in _e)if(_e[V].location>=0){let oe=J[V];void 0===oe&&("instanceMatrix"===V&&P.instanceMatrix&&(oe=P.instanceMatrix),"instanceColor"===V&&P.instanceColor&&(oe=P.instanceColor));const k={};k.attribute=oe,oe&&oe.data&&(k.data=oe.data),j[V]=k,te++}c.attributes=j,c.attributesNum=te,c.index=ne}(P,ne,Y,j)}else{const te=!0===z.wireframe;(c.geometry!==ne.id||c.program!==Y.id||c.wireframe!==te)&&(c.geometry=ne.id,c.program=Y.id,c.wireframe=te,J=!0)}null!==j&&t.update(j,34963),(J||u)&&(u=!1,function w(P,z,Y,ne){if(!1===i.isWebGL2&&(P.isInstancedMesh||ne.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const j=ne.attributes,J=Y.getAttributes(),te=z.defaultAttributeValues;for(const _e in J){const V=J[_e];if(V.location>=0){let Q=j[_e];if(void 0===Q&&("instanceMatrix"===_e&&P.instanceMatrix&&(Q=P.instanceMatrix),"instanceColor"===_e&&P.instanceColor&&(Q=P.instanceColor)),void 0!==Q){const oe=Q.normalized,k=Q.itemSize,he=t.get(Q);if(void 0===he)continue;const me=he.buffer,xe=he.type,Ee=he.bytesPerElement;if(Q.isInterleavedBufferAttribute){const Me=Q.data,Ne=Me.stride,Z=Q.offset;if(Me.isInstancedInterleavedBuffer){for(let ee=0;ee<V.locationSize;ee++)b(V.location+ee,Me.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===ne._maxInstanceCount&&(ne._maxInstanceCount=Me.meshPerAttribute*Me.count)}else for(let ee=0;ee<V.locationSize;ee++)x(V.location+ee);n.bindBuffer(34962,me);for(let ee=0;ee<V.locationSize;ee++)A(V.location+ee,k/V.locationSize,xe,oe,Ne*Ee,(Z+k/V.locationSize*ee)*Ee)}else{if(Q.isInstancedBufferAttribute){for(let Me=0;Me<V.locationSize;Me++)b(V.location+Me,Q.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===ne._maxInstanceCount&&(ne._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let Me=0;Me<V.locationSize;Me++)x(V.location+Me);n.bindBuffer(34962,me);for(let Me=0;Me<V.locationSize;Me++)A(V.location+Me,k/V.locationSize,xe,oe,k*Ee,k/V.locationSize*Me*Ee)}}else if(void 0!==te){const oe=te[_e];if(void 0!==oe)switch(oe.length){case 2:n.vertexAttrib2fv(V.location,oe);break;case 3:n.vertexAttrib3fv(V.location,oe);break;case 4:n.vertexAttrib4fv(V.location,oe);break;default:n.vertexAttrib1fv(V.location,oe)}}}}M()}(P,z,Y,ne),null!==j&&n.bindBuffer(34963,t.get(j).buffer))},reset:H,resetDefaultState:N,dispose:function S(){H();for(const P in a){const z=a[P];for(const Y in z){const ne=z[Y];for(const j in ne)m(ne[j].object),delete ne[j];delete z[Y]}delete a[P]}},releaseStatesOfGeometry:function R(P){if(void 0===a[P.id])return;const z=a[P.id];for(const Y in z){const ne=z[Y];for(const j in ne)m(ne[j].object),delete ne[j];delete z[Y]}delete a[P.id]},releaseStatesOfProgram:function O(P){for(const z in a){const Y=a[z];if(void 0===Y[P.id])continue;const ne=Y[P.id];for(const j in ne)m(ne[j].object),delete ne[j];delete Y[P.id]}},initAttributes:y,enableAttribute:x,disableUnusedAttributes:M}}function ZG(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function KG(n,e,t){let i;function s(A){if("highp"===A){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return"mediump"===A&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),h=n.getParameter(35660),f=n.getParameter(3379),m=n.getParameter(34076),p=n.getParameter(34921),g=n.getParameter(36347),v=n.getParameter(36348),_=n.getParameter(36349),y=h>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const A=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:m,maxAttributes:p,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:_,vertexTextures:y,floatFragmentTextures:x,floatVertexTextures:y&&x,maxSamples:o?n.getParameter(36183):0}}function JG(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new uo,a=new Ln,l={value:null,needsUpdate:!1};function u(d,h,f,m){const p=null!==d?d.length:0;let g=null;if(0!==p){if(g=l.value,!0!==m||null===g){const v=f+4*p,_=h.matrixWorldInverse;a.getNormalMatrix(_),(null===g||g.length<v)&&(g=new Float32Array(v));for(let y=0,x=f;y!==p;++y,x+=4)o.copy(d[y]).applyMatrix4(_,a),o.normal.toArray(g,x),g[x+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const m=d.clippingPlanes,p=d.clipIntersection,g=d.clipShadows,v=n.get(d);if(!r||null===m||0===m.length||s&&!g)s?u(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const _=s?0:i,y=4*_;let x=v.clippingState||null;l.value=x,x=u(m,h,y,f);for(let b=0;b!==y;++b)x[b]=t[b];v.clippingState=x,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=_}}}function QG(n){let e=new WeakMap;function t(o,a){return a===_h?o.mapping=Ys:a===xh&&(o.mapping=Zs),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(a===_h||a===xh){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new $H(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}class Wh extends Jy{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const FC=[.125,.215,.35,.446,.526,.582],tv=new Wh,kC=new ge;let nv=null;const fo=(1+Math.sqrt(5))/2,tl=1/fo,BC=[new D(1,1,1),new D(-1,1,1),new D(1,1,-1),new D(-1,1,-1),new D(0,fo,tl),new D(0,fo,-tl),new D(tl,0,fo),new D(-tl,0,fo),new D(fo,tl,0),new D(-fo,tl,0)];class UC{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){nv=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=HC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=VC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(nv),e.scissorTest=!1,jh(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(e.mapping===Ys||e.mapping===Zs?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),nv=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Ht,minFilter:Ht,generateMipmaps:!1,type:Pc,format:Di,encoding:to,depthBuffer:!1},r=zC(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=zC(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function e5(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+FC.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=FC[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,m=6,p=3,g=2,v=1,_=new Float32Array(p*m*f),y=new Float32Array(g*m*f),x=new Float32Array(v*m*f);for(let M=0;M<f;M++){const A=M%3*2/3-1,w=M>2?0:-1;_.set([A,w,0,A+2/3,w,0,A+2/3,w+1,0,A,w,0,A+2/3,w+1,0,A,w+1,0],p*m*M),y.set(h,g*m*M),x.set([M,M,M,M,M,M],v*m*M)}const b=new st;b.setAttribute("position",new Gt(_,p)),b.setAttribute("uv",new Gt(y,g)),b.setAttribute("faceIndex",new Gt(x,v)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function t5(n,e,t){const i=new Float32Array(20),r=new D(0,1,0);return new vs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:us,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new On(this._lodPlanes[0],e);this._renderer.compile(t,tv)}_sceneToCubeUV(e,t,i,r){const a=new yn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(kC),u.toneMapping=Fr,u.autoClear=!1;const f=new Ci({name:"PMREM.Background",side:di,depthWrite:!1,depthTest:!1}),m=new On(new Ya,f);let p=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,p=!0):(f.color.copy(kC),p=!0);for(let v=0;v<6;v++){const _=v%3;0===_?(a.up.set(0,l[v],0),a.lookAt(c[v],0,0)):1===_?(a.up.set(0,0,l[v]),a.lookAt(0,c[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,c[v]));const y=this._cubeSize;jh(r,_*y,v>2?y:0,y,y),u.setRenderTarget(r),p&&u.render(m,a),u.render(e,a)}m.geometry.dispose(),m.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=g}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Ys||e.mapping===Zs;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=HC()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=VC());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new On(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;jh(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,tv)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,BC[(r-1)%BC.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new On(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,m=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,p=s/m,g=isFinite(s)?1+Math.floor(3*p):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const v=[];let _=0;for(let A=0;A<20;++A){const w=A/p,S=Math.exp(-w*w/2);v.push(S),0===A?_+=S:A<g&&(_+=2*S)}for(let A=0;A<v.length;A++)v[A]=v[A]/_;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=v,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:y}=this;h.dTheta.value=m,h.mipInt.value=y-i;const x=this._sizeLods[r];jh(t,3*x*(r>y-4?r-y+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(d,tv)}}function zC(n,e,t){const i=new so(n,e,t);return i.texture.mapping=Ac,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function jh(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function VC(){return new vs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:us,depthTest:!1,depthWrite:!1})}function HC(){return new vs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:us,depthTest:!1,depthWrite:!1})}function n5(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===_h||l===xh,u=l===Ys||l===Zs;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new UC(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new UC(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function i5(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function r5(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const m in h.attributes)e.remove(h.attributes[m]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,m=d.attributes.position;let p=0;if(null!==f){const _=f.array;p=f.version;for(let y=0,x=_.length;y<x;y+=3){const b=_[y+0],M=_[y+1],A=_[y+2];h.push(b,M,M,A,A,b)}}else{p=m.version;for(let y=0,x=m.array.length/3-1;y<x;y+=3){const b=y+0,M=y+1,A=y+2;h.push(b,M,M,A,A,b)}}const g=new(yC(h)?RC:IC)(h,1);g.version=p;const v=s.get(d);v&&e.remove(v),s.set(d,g)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const m in h)e.update(h[m],34962);const f=d.morphAttributes;for(const m in f){const p=f[m];for(let g=0,v=p.length;g<v;g++)e.update(p[g],34962)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function s5(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,m){if(0===m)return;let p,g;if(r)p=n,g="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[g](s,f,a,h*l,m),t.update(f,s,m)}}function o5(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function a5(n,e){return n[0]-e[0]}function l5(n,e){return Math.abs(e[1])-Math.abs(n[1])}function c5(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Dt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d){const h=c.morphTargetInfluences;if(!0===e.isWebGL2){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==f?f.length:0;let p=s.get(u);if(void 0===p||p.count!==m){let P=function(){H.dispose(),s.delete(u),u.removeEventListener("dispose",P)};void 0!==p&&p.texture.dispose();const _=void 0!==u.morphAttributes.position,y=void 0!==u.morphAttributes.normal,x=void 0!==u.morphAttributes.color,b=u.morphAttributes.position||[],M=u.morphAttributes.normal||[],A=u.morphAttributes.color||[];let w=0;!0===_&&(w=1),!0===y&&(w=2),!0===x&&(w=3);let S=u.attributes.position.count*w,R=1;S>e.maxTextureSize&&(R=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);const O=new Float32Array(S*R*4*m),H=new Fy(O,S,R,m);H.type=ds,H.needsUpdate=!0;const N=4*w;for(let z=0;z<m;z++){const Y=b[z],ne=M[z],j=A[z],J=S*R*4*z;for(let te=0;te<Y.count;te++){const _e=te*N;!0===_&&(o.fromBufferAttribute(Y,te),O[J+_e+0]=o.x,O[J+_e+1]=o.y,O[J+_e+2]=o.z,O[J+_e+3]=0),!0===y&&(o.fromBufferAttribute(ne,te),O[J+_e+4]=o.x,O[J+_e+5]=o.y,O[J+_e+6]=o.z,O[J+_e+7]=0),!0===x&&(o.fromBufferAttribute(j,te),O[J+_e+8]=o.x,O[J+_e+9]=o.y,O[J+_e+10]=o.z,O[J+_e+11]=4===j.itemSize?o.w:1)}}p={count:m,texture:H,size:new X(S,R)},s.set(u,p),u.addEventListener("dispose",P)}let g=0;for(let _=0;_<h.length;_++)g+=h[_];const v=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(n,"morphTargetBaseInfluence",v),d.getUniforms().setValue(n,"morphTargetInfluences",h),d.getUniforms().setValue(n,"morphTargetsTexture",p.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",p.size)}else{const f=void 0===h?0:h.length;let m=i[u.id];if(void 0===m||m.length!==f){m=[];for(let y=0;y<f;y++)m[y]=[y,0];i[u.id]=m}for(let y=0;y<f;y++){const x=m[y];x[0]=y,x[1]=h[y]}m.sort(l5);for(let y=0;y<8;y++)y<f&&m[y][1]?(a[y][0]=m[y][0],a[y][1]=m[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(a5);const p=u.morphAttributes.position,g=u.morphAttributes.normal;let v=0;for(let y=0;y<8;y++){const x=a[y],b=x[0],M=x[1];b!==Number.MAX_SAFE_INTEGER&&M?(p&&u.getAttribute("morphTarget"+y)!==p[b]&&u.setAttribute("morphTarget"+y,p[b]),g&&u.getAttribute("morphNormal"+y)!==g[b]&&u.setAttribute("morphNormal"+y,g[b]),r[y]=M,v+=M):(p&&!0===u.hasAttribute("morphTarget"+y)&&u.deleteAttribute("morphTarget"+y),g&&!0===u.hasAttribute("morphNormal"+y)&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const _=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(n,"morphTargetBaseInfluence",_),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function u5(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function o(){r=new WeakMap}}}const GC=new Wi,WC=new Fy,jC=new xC,$C=new zh,qC=[],XC=[],YC=new Float32Array(16),ZC=new Float32Array(9),KC=new Float32Array(4);function nl(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=qC[r];if(void 0===s&&(s=new Float32Array(r),qC[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function hn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function fn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function $h(n,e){let t=XC[e];void 0===t&&(t=new Int32Array(e),XC[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function d5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function h5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(hn(t,e))return;n.uniform2fv(this.addr,e),fn(t,e)}}function f5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(hn(t,e))return;n.uniform3fv(this.addr,e),fn(t,e)}}function p5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(hn(t,e))return;n.uniform4fv(this.addr,e),fn(t,e)}}function m5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(hn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),fn(t,e)}else{if(hn(t,i))return;KC.set(i),n.uniformMatrix2fv(this.addr,!1,KC),fn(t,i)}}function g5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(hn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),fn(t,e)}else{if(hn(t,i))return;ZC.set(i),n.uniformMatrix3fv(this.addr,!1,ZC),fn(t,i)}}function y5(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(hn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),fn(t,e)}else{if(hn(t,i))return;YC.set(i),n.uniformMatrix4fv(this.addr,!1,YC),fn(t,i)}}function v5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function _5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(hn(t,e))return;n.uniform2iv(this.addr,e),fn(t,e)}}function x5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(hn(t,e))return;n.uniform3iv(this.addr,e),fn(t,e)}}function w5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(hn(t,e))return;n.uniform4iv(this.addr,e),fn(t,e)}}function b5(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function M5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(hn(t,e))return;n.uniform2uiv(this.addr,e),fn(t,e)}}function S5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(hn(t,e))return;n.uniform3uiv(this.addr,e),fn(t,e)}}function E5(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(hn(t,e))return;n.uniform4uiv(this.addr,e),fn(t,e)}}function D5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||GC,r)}function C5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||jC,r)}function T5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||$C,r)}function A5(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||WC,r)}function R5(n,e){n.uniform1fv(this.addr,e)}function P5(n,e){const t=nl(e,this.size,2);n.uniform2fv(this.addr,t)}function L5(n,e){const t=nl(e,this.size,3);n.uniform3fv(this.addr,t)}function N5(n,e){const t=nl(e,this.size,4);n.uniform4fv(this.addr,t)}function O5(n,e){const t=nl(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function F5(n,e){const t=nl(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function k5(n,e){const t=nl(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function B5(n,e){n.uniform1iv(this.addr,e)}function U5(n,e){n.uniform2iv(this.addr,e)}function z5(n,e){n.uniform3iv(this.addr,e)}function V5(n,e){n.uniform4iv(this.addr,e)}function H5(n,e){n.uniform1uiv(this.addr,e)}function G5(n,e){n.uniform2uiv(this.addr,e)}function W5(n,e){n.uniform3uiv(this.addr,e)}function j5(n,e){n.uniform4uiv(this.addr,e)}function $5(n,e,t){const i=this.cache,r=e.length,s=$h(t,r);hn(i,s)||(n.uniform1iv(this.addr,s),fn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||GC,s[o])}function q5(n,e,t){const i=this.cache,r=e.length,s=$h(t,r);hn(i,s)||(n.uniform1iv(this.addr,s),fn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||jC,s[o])}function X5(n,e,t){const i=this.cache,r=e.length,s=$h(t,r);hn(i,s)||(n.uniform1iv(this.addr,s),fn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||$C,s[o])}function Y5(n,e,t){const i=this.cache,r=e.length,s=$h(t,r);hn(i,s)||(n.uniform1iv(this.addr,s),fn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||WC,s[o])}class K5{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function I5(n){switch(n){case 5126:return d5;case 35664:return h5;case 35665:return f5;case 35666:return p5;case 35674:return m5;case 35675:return g5;case 35676:return y5;case 5124:case 35670:return v5;case 35667:case 35671:return _5;case 35668:case 35672:return x5;case 35669:case 35673:return w5;case 5125:return b5;case 36294:return M5;case 36295:return S5;case 36296:return E5;case 35678:case 36198:case 36298:case 36306:case 35682:return D5;case 35679:case 36299:case 36307:return C5;case 35680:case 36300:case 36308:case 36293:return T5;case 36289:case 36303:case 36311:case 36292:return A5}}(t.type)}}class J5{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function Z5(n){switch(n){case 5126:return R5;case 35664:return P5;case 35665:return L5;case 35666:return N5;case 35674:return O5;case 35675:return F5;case 35676:return k5;case 5124:case 35670:return B5;case 35667:case 35671:return U5;case 35668:case 35672:return z5;case 35669:case 35673:return V5;case 5125:return H5;case 36294:return G5;case 36295:return W5;case 36296:return j5;case 35678:case 36198:case 36298:case 36306:case 35682:return $5;case 35679:case 36299:case 36307:return q5;case 35680:case 36300:case 36308:case 36293:return X5;case 36289:case 36303:case 36311:case 36292:return Y5}}(t.type)}}class Q5{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const rv=/(\w+)(\])?(\[|\.)?/g;function JC(n,e){n.seq.push(e),n.map[e.id]=e}function e6(n,e,t){const i=n.name,r=i.length;for(rv.lastIndex=0;;){const s=rv.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&rv.lastIndex+2===r){JC(t,void 0===c?new K5(a,n,e):new J5(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new Q5(a),JC(t,d)),t=d}}}class qh{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);e6(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function QC(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let t6=0;function eT(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function n6(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function r6(n,e){const t=function i6(n){switch(n){case to:return["Linear","( value )"];case St:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function s6(n,e){let t;switch(e){case NV:t="Linear";break;case OV:t="Reinhard";break;case FV:t="OptimizedCineon";break;case kV:t="ACESFilmic";break;case BV:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function jc(n){return""!==n}function tT(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function nT(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const c6=/^[ \t]*#include +<([\w\d./]+)>/gm;function sv(n){return n.replace(c6,u6)}function u6(n,e){const t=it[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return sv(t)}const d6=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function iT(n){return n.replace(d6,h6)}function h6(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function rT(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function v6(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function f6(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===PD?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===hV?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Tc&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function p6(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ys:case Zs:e="ENVMAP_TYPE_CUBE";break;case Ac:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function m6(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&n.envMapMode===Zs&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function g6(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case vh:e="ENVMAP_BLENDING_MULTIPLY";break;case PV:e="ENVMAP_BLENDING_MIX";break;case LV:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function y6(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function o6(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jc).join("\n")}(t),m=function a6(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),p=r.createProgram();let g,v,_=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[m].filter(jc).join("\n"),g.length>0&&(g+="\n"),v=[f,m].filter(jc).join("\n"),v.length>0&&(v+="\n")):(g=[rT(t),"#define SHADER_NAME "+t.shaderName,m,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(jc).join("\n"),v=[f,rT(t),"#define SHADER_NAME "+t.shaderName,m,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Fr?"#define TONE_MAPPING":"",t.toneMapping!==Fr?it.tonemapping_pars_fragment:"",t.toneMapping!==Fr?s6("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",it.encodings_pars_fragment,r6("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(jc).join("\n")),o=sv(o),o=tT(o,t),o=nT(o,t),a=sv(a),a=tT(a,t),a=nT(a,t),o=iT(o),a=iT(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(_="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",t.glslVersion===fC?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===fC?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const x=_+v+a,b=QC(r,35633,_+g+o),M=QC(r,35632,x);if(r.attachShader(p,b),r.attachShader(p,M),void 0!==t.index0AttributeName?r.bindAttribLocation(p,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),n.debug.checkShaderErrors){const S=r.getProgramInfoLog(p).trim(),R=r.getShaderInfoLog(b).trim(),O=r.getShaderInfoLog(M).trim();let H=!0,N=!0;if(!1===r.getProgramParameter(p,35714)){H=!1;const P=eT(r,b,"vertex"),z=eT(r,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,35715)+"\n\nProgram Info Log: "+S+"\n"+P+"\n"+z)}else""!==S?console.warn("THREE.WebGLProgram: Program Info Log:",S):(""===R||""===O)&&(N=!1);N&&(this.diagnostics={runnable:H,programLog:S,vertexShader:{log:R,prefix:g},fragmentShader:{log:O,prefix:v}})}let A,w;return r.deleteShader(b),r.deleteShader(M),this.getUniforms=function(){return void 0===A&&(A=new qh(r,p)),A},this.getAttributes=function(){return void 0===w&&(w=function l6(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,p)),w},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=t6++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=b,this.fragmentShader=M,this}let _6=0;class x6{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new w6(e),t.set(e,i)),i}}class w6{constructor(e){this.id=_6++,this.code=e,this.usedTimes=0}}function b6(n,e,t,i,r,s,o){const a=new Gy,l=new x6,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function p(w,S,R,O,H){const N=O.fog,P=H.geometry,Y=(w.isMeshStandardMaterial?t:e).get(w.envMap||(w.isMeshStandardMaterial?O.environment:null)),ne=Y&&Y.mapping===Ac?Y.image.height:null,j=m[w.type];null!==w.precision&&(f=r.getMaxPrecision(w.precision),f!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",f,"instead."));const J=P.morphAttributes.position||P.morphAttributes.normal||P.morphAttributes.color,te=void 0!==J?J.length:0;let V,Q,oe,k,_e=0;if(void 0!==P.morphAttributes.position&&(_e=1),void 0!==P.morphAttributes.normal&&(_e=2),void 0!==P.morphAttributes.color&&(_e=3),j){const Ne=dr[j];V=Ne.vertexShader,Q=Ne.fragmentShader}else V=w.vertexShader,Q=w.fragmentShader,l.update(w),oe=l.getVertexShaderID(w),k=l.getFragmentShaderID(w);const he=n.getRenderTarget(),xe=w.clearcoat>0,Ee=w.iridescence>0;return{isWebGL2:u,shaderID:j,shaderName:w.type,vertexShader:V,fragmentShader:Q,defines:w.defines,customVertexShaderID:oe,customFragmentShaderID:k,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:f,instancing:!0===H.isInstancedMesh,instancingColor:!0===H.isInstancedMesh&&null!==H.instanceColor,supportsVertexTextures:h,outputEncoding:null===he?n.outputEncoding:!0===he.isXRRenderTarget?he.texture.encoding:to,map:!!w.map,matcap:!!w.matcap,envMap:!!Y,envMapMode:Y&&Y.mapping,envMapCubeUVHeight:ne,lightMap:!!w.lightMap,aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,bumpMap:!!w.bumpMap,normalMap:!!w.normalMap,objectSpaceNormalMap:w.normalMapType===oH,tangentSpaceNormalMap:w.normalMapType===no,decodeVideoTexture:!!w.map&&!0===w.map.isVideoTexture&&w.map.encoding===St,clearcoat:xe,clearcoatMap:xe&&!!w.clearcoatMap,clearcoatRoughnessMap:xe&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:xe&&!!w.clearcoatNormalMap,iridescence:Ee,iridescenceMap:Ee&&!!w.iridescenceMap,iridescenceThicknessMap:Ee&&!!w.iridescenceThicknessMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,opaque:!1===w.transparent&&w.blending===Ia,alphaMap:!!w.alphaMap,alphaTest:w.alphaTest>0,gradientMap:!!w.gradientMap,sheen:w.sheen>0,sheenColorMap:!!w.sheenColorMap,sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:w.transmission>0,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!P.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!P.attributes.color&&4===P.attributes.color.itemSize,vertexUvs:!!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatMap||w.clearcoatRoughnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.displacementMap||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheenColorMap||w.sheenRoughnessMap),uvsVertexOnly:!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.transmission>0||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheen>0||w.sheenColorMap||w.sheenRoughnessMap||!w.displacementMap),fog:!!N,useFog:!0===w.fog,fogExp2:N&&N.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===H.isSkinnedMesh,morphTargets:void 0!==P.morphAttributes.position,morphNormals:void 0!==P.morphAttributes.normal,morphColors:void 0!==P.morphAttributes.color,morphTargetsCount:te,morphTextureStride:_e,numDirLights:S.directional.length,numPointLights:S.point.length,numSpotLights:S.spot.length,numSpotLightMaps:S.spotLightMap.length,numRectAreaLights:S.rectArea.length,numHemiLights:S.hemi.length,numDirLightShadows:S.directionalShadowMap.length,numPointLightShadows:S.pointShadowMap.length,numSpotLightShadows:S.spotShadowMap.length,numSpotLightShadowsWithMaps:S.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:w.toneMapped?n.toneMapping:Fr,useLegacyLights:n.useLegacyLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:w.side===Or,flipSided:w.side===di,useDepthPacking:!!w.depthPacking,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&w.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function g(w){const S=[];if(w.shaderID?S.push(w.shaderID):(S.push(w.customVertexShaderID),S.push(w.customFragmentShaderID)),void 0!==w.defines)for(const R in w.defines)S.push(R),S.push(w.defines[R]);return!1===w.isRawShaderMaterial&&(function v(w,S){w.push(S.precision),w.push(S.outputEncoding),w.push(S.envMapMode),w.push(S.envMapCubeUVHeight),w.push(S.combine),w.push(S.vertexUvs),w.push(S.fogExp2),w.push(S.sizeAttenuation),w.push(S.morphTargetsCount),w.push(S.morphAttributeCount),w.push(S.numDirLights),w.push(S.numPointLights),w.push(S.numSpotLights),w.push(S.numSpotLightMaps),w.push(S.numHemiLights),w.push(S.numRectAreaLights),w.push(S.numDirLightShadows),w.push(S.numPointLightShadows),w.push(S.numSpotLightShadows),w.push(S.numSpotLightShadowsWithMaps),w.push(S.shadowMapType),w.push(S.toneMapping),w.push(S.numClippingPlanes),w.push(S.numClipIntersection),w.push(S.depthPacking)}(S,w),function _(w,S){a.disableAll(),S.isWebGL2&&a.enable(0),S.supportsVertexTextures&&a.enable(1),S.instancing&&a.enable(2),S.instancingColor&&a.enable(3),S.map&&a.enable(4),S.matcap&&a.enable(5),S.envMap&&a.enable(6),S.lightMap&&a.enable(7),S.aoMap&&a.enable(8),S.emissiveMap&&a.enable(9),S.bumpMap&&a.enable(10),S.normalMap&&a.enable(11),S.objectSpaceNormalMap&&a.enable(12),S.tangentSpaceNormalMap&&a.enable(13),S.clearcoat&&a.enable(14),S.clearcoatMap&&a.enable(15),S.clearcoatRoughnessMap&&a.enable(16),S.clearcoatNormalMap&&a.enable(17),S.iridescence&&a.enable(18),S.iridescenceMap&&a.enable(19),S.iridescenceThicknessMap&&a.enable(20),S.displacementMap&&a.enable(21),S.specularMap&&a.enable(22),S.roughnessMap&&a.enable(23),S.metalnessMap&&a.enable(24),S.gradientMap&&a.enable(25),S.alphaMap&&a.enable(26),S.alphaTest&&a.enable(27),S.vertexColors&&a.enable(28),S.vertexAlphas&&a.enable(29),S.vertexUvs&&a.enable(30),S.vertexTangents&&a.enable(31),S.uvsVertexOnly&&a.enable(32),w.push(a.mask),a.disableAll(),S.fog&&a.enable(0),S.useFog&&a.enable(1),S.flatShading&&a.enable(2),S.logarithmicDepthBuffer&&a.enable(3),S.skinning&&a.enable(4),S.morphTargets&&a.enable(5),S.morphNormals&&a.enable(6),S.morphColors&&a.enable(7),S.premultipliedAlpha&&a.enable(8),S.shadowMapEnabled&&a.enable(9),S.useLegacyLights&&a.enable(10),S.doubleSided&&a.enable(11),S.flipSided&&a.enable(12),S.useDepthPacking&&a.enable(13),S.dithering&&a.enable(14),S.specularIntensityMap&&a.enable(15),S.specularColorMap&&a.enable(16),S.transmission&&a.enable(17),S.transmissionMap&&a.enable(18),S.thicknessMap&&a.enable(19),S.sheen&&a.enable(20),S.sheenColorMap&&a.enable(21),S.sheenRoughnessMap&&a.enable(22),S.decodeVideoTexture&&a.enable(23),S.opaque&&a.enable(24),w.push(a.mask)}(S,w),S.push(n.outputEncoding)),S.push(w.customProgramCacheKey),S.join()},getUniforms:function y(w){const S=m[w.type];let R;return R=S?HH.clone(dr[S].uniforms):w.uniforms,R},acquireProgram:function x(w,S){let R;for(let O=0,H=c.length;O<H;O++){const N=c[O];if(N.cacheKey===S){R=N,++R.usedTimes;break}}return void 0===R&&(R=new v6(n,S,w,s),c.push(R)),R},releaseProgram:function b(w){if(0==--w.usedTimes){const S=c.indexOf(w);c[S]=c[c.length-1],c.pop(),w.destroy()}},releaseShaderCache:function M(w){l.remove(w)},programs:c,dispose:function A(){l.dispose()}}}function M6(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function S6(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function sT(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function oT(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,m,p,g){let v=n[e];return void 0===v?(v={id:d.id,object:d,geometry:h,material:f,groupOrder:m,renderOrder:d.renderOrder,z:p,group:g},n[e]=v):(v.id=d.id,v.object=d,v.geometry=h,v.material=f,v.groupOrder=m,v.renderOrder=d.renderOrder,v.z=p,v.group=g),e++,v}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,m,p,g){const v=o(d,h,f,m,p,g);f.transmission>0?i.push(v):!0===f.transparent?r.push(v):t.push(v)},unshift:function l(d,h,f,m,p,g){const v=o(d,h,f,m,p,g);f.transmission>0?i.unshift(v):!0===f.transparent?r.unshift(v):t.unshift(v)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||S6),i.length>1&&i.sort(h||sT),r.length>1&&r.sort(h||sT)}}}function E6(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new oT,n.set(i,[o])):r>=s.length?(o=new oT,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function D6(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new D,color:new ge};break;case"SpotLight":t={position:new D,direction:new D,color:new ge,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new D,color:new ge,distance:0,decay:0};break;case"HemisphereLight":t={direction:new D,skyColor:new ge,groundColor:new ge};break;case"RectAreaLight":t={color:new ge,position:new D,halfWidth:new D,halfHeight:new D}}return n[e.id]=t,t}}}let T6=0;function A6(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function I6(n,e){const t=new D6,i=function C6(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new X,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new D);const s=new D,o=new Xe,a=new Xe;return{setup:function l(u,d){let h=0,f=0,m=0;for(let O=0;O<9;O++)r.probe[O].set(0,0,0);let p=0,g=0,v=0,_=0,y=0,x=0,b=0,M=0,A=0,w=0;u.sort(A6);const S=!0===d?Math.PI:1;for(let O=0,H=u.length;O<H;O++){const N=u[O],P=N.color,z=N.intensity,Y=N.distance,ne=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)h+=P.r*z*S,f+=P.g*z*S,m+=P.b*z*S;else if(N.isLightProbe)for(let j=0;j<9;j++)r.probe[j].addScaledVector(N.sh.coefficients[j],z);else if(N.isDirectionalLight){const j=t.get(N);if(j.color.copy(N.color).multiplyScalar(N.intensity*S),N.castShadow){const J=N.shadow,te=i.get(N);te.shadowBias=J.bias,te.shadowNormalBias=J.normalBias,te.shadowRadius=J.radius,te.shadowMapSize=J.mapSize,r.directionalShadow[p]=te,r.directionalShadowMap[p]=ne,r.directionalShadowMatrix[p]=N.shadow.matrix,x++}r.directional[p]=j,p++}else if(N.isSpotLight){const j=t.get(N);j.position.setFromMatrixPosition(N.matrixWorld),j.color.copy(P).multiplyScalar(z*S),j.distance=Y,j.coneCos=Math.cos(N.angle),j.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),j.decay=N.decay,r.spot[v]=j;const J=N.shadow;if(N.map&&(r.spotLightMap[A]=N.map,A++,J.updateMatrices(N),N.castShadow&&w++),r.spotLightMatrix[v]=J.matrix,N.castShadow){const te=i.get(N);te.shadowBias=J.bias,te.shadowNormalBias=J.normalBias,te.shadowRadius=J.radius,te.shadowMapSize=J.mapSize,r.spotShadow[v]=te,r.spotShadowMap[v]=ne,M++}v++}else if(N.isRectAreaLight){const j=t.get(N);j.color.copy(P).multiplyScalar(z),j.halfWidth.set(.5*N.width,0,0),j.halfHeight.set(0,.5*N.height,0),r.rectArea[_]=j,_++}else if(N.isPointLight){const j=t.get(N);if(j.color.copy(N.color).multiplyScalar(N.intensity*S),j.distance=N.distance,j.decay=N.decay,N.castShadow){const J=N.shadow,te=i.get(N);te.shadowBias=J.bias,te.shadowNormalBias=J.normalBias,te.shadowRadius=J.radius,te.shadowMapSize=J.mapSize,te.shadowCameraNear=J.camera.near,te.shadowCameraFar=J.camera.far,r.pointShadow[g]=te,r.pointShadowMap[g]=ne,r.pointShadowMatrix[g]=N.shadow.matrix,b++}r.point[g]=j,g++}else if(N.isHemisphereLight){const j=t.get(N);j.skyColor.copy(N.color).multiplyScalar(z*S),j.groundColor.copy(N.groundColor).multiplyScalar(z*S),r.hemi[y]=j,y++}}_>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=ue.LTC_FLOAT_1,r.rectAreaLTC2=ue.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=ue.LTC_HALF_1,r.rectAreaLTC2=ue.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=m;const R=r.hash;(R.directionalLength!==p||R.pointLength!==g||R.spotLength!==v||R.rectAreaLength!==_||R.hemiLength!==y||R.numDirectionalShadows!==x||R.numPointShadows!==b||R.numSpotShadows!==M||R.numSpotMaps!==A)&&(r.directional.length=p,r.spot.length=v,r.rectArea.length=_,r.point.length=g,r.hemi.length=y,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=b,r.spotLightMatrix.length=M+A-w,r.spotLightMap.length=A,r.numSpotLightShadowsWithMaps=w,R.directionalLength=p,R.pointLength=g,R.spotLength=v,R.rectAreaLength=_,R.hemiLength=y,R.numDirectionalShadows=x,R.numPointShadows=b,R.numSpotShadows=M,R.numSpotMaps=A,r.version=T6++)},setupView:function c(u,d){let h=0,f=0,m=0,p=0,g=0;const v=d.matrixWorldInverse;for(let _=0,y=u.length;_<y;_++){const x=u[_];if(x.isDirectionalLight){const b=r.directional[h];b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),h++}else if(x.isSpotLight){const b=r.spot[m];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(v),m++}else if(x.isRectAreaLight){const b=r.rectArea[p];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),a.identity(),o.copy(x.matrixWorld),o.premultiply(v),a.extractRotation(o),b.halfWidth.set(.5*x.width,0,0),b.halfHeight.set(0,.5*x.height,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),p++}else if(x.isPointLight){const b=r.point[f];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(v),f++}else if(x.isHemisphereLight){const b=r.hemi[g];b.direction.setFromMatrixPosition(x.matrixWorld),b.direction.transformDirection(v),g++}}},state:r}}function aT(n,e){const t=new I6(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function R6(n,e){let t=new WeakMap;return{get:function i(s,o=0){const a=t.get(s);let l;return void 0===a?(l=new aT(n,e),t.set(s,[l])):o>=a.length?(l=new aT(n,e),a.push(l)):l=a[o],l},dispose:function r(){t=new WeakMap}}}class lT extends Xi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class cT extends Xi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new D,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const P6="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",L6="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function N6(n,e,t){let i=new ev;const r=new X,s=new X,o=new Dt,a=new lT({depthPacking:sH}),l=new cT,c={},u=t.maxTextureSize,d={[Nr]:di,[di]:Nr,[Or]:Or},h=new vs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new X},radius:{value:4}},vertexShader:P6,fragmentShader:L6}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const m=new st;m.setAttribute("position",new Gt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new On(m,h),g=this;function v(x,b){const M=e.update(p);h.defines.VSM_SAMPLES!==x.blurSamples&&(h.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===x.mapPass&&(x.mapPass=new so(r.x,r.y)),h.uniforms.shadow_pass.value=x.map.texture,h.uniforms.resolution.value=x.mapSize,h.uniforms.radius.value=x.radius,n.setRenderTarget(x.mapPass),n.clear(),n.renderBufferDirect(b,null,M,h,p,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,n.setRenderTarget(x.map),n.clear(),n.renderBufferDirect(b,null,M,f,p,null)}function _(x,b,M,A,w,S){let R=null;const O=!0===M.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(void 0!==O)R=O;else if(R=!0===M.isPointLight?l:a,n.localClippingEnabled&&!0===b.clipShadows&&Array.isArray(b.clippingPlanes)&&0!==b.clippingPlanes.length||b.displacementMap&&0!==b.displacementScale||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){const H=R.uuid,N=b.uuid;let P=c[H];void 0===P&&(P={},c[H]=P);let z=P[N];void 0===z&&(z=R.clone(),P[N]=z),R=z}return R.visible=b.visible,R.wireframe=b.wireframe,R.side=S===Tc?null!==b.shadowSide?b.shadowSide:b.side:null!==b.shadowSide?b.shadowSide:d[b.side],R.alphaMap=b.alphaMap,R.alphaTest=b.alphaTest,R.map=b.map,R.clipShadows=b.clipShadows,R.clippingPlanes=b.clippingPlanes,R.clipIntersection=b.clipIntersection,R.displacementMap=b.displacementMap,R.displacementScale=b.displacementScale,R.displacementBias=b.displacementBias,R.wireframeLinewidth=b.wireframeLinewidth,R.linewidth=b.linewidth,!0===M.isPointLight&&!0===R.isMeshDistanceMaterial&&(R.referencePosition.setFromMatrixPosition(M.matrixWorld),R.nearDistance=A,R.farDistance=w),R}function y(x,b,M,A,w){if(!1===x.visible)return;if(x.layers.test(b.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&w===Tc)&&(!x.frustumCulled||i.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,x.matrixWorld);const O=e.update(x),H=x.material;if(Array.isArray(H)){const N=O.groups;for(let P=0,z=N.length;P<z;P++){const Y=N[P],ne=H[Y.materialIndex];if(ne&&ne.visible){const j=_(x,ne,A,M.near,M.far,w);n.renderBufferDirect(M,null,O,j,x,Y)}}}else if(H.visible){const N=_(x,H,A,M.near,M.far,w);n.renderBufferDirect(M,null,O,N,x,null)}}const R=x.children;for(let O=0,H=R.length;O<H;O++)y(R[O],b,M,A,w)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PD,this.render=function(x,b,M){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===x.length)return;const A=n.getRenderTarget(),w=n.getActiveCubeFace(),S=n.getActiveMipmapLevel(),R=n.state;R.setBlending(us),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let O=0,H=x.length;O<H;O++){const N=x[O],P=N.shadow;if(void 0===P){console.warn("THREE.WebGLShadowMap:",N,"has no shadow.");continue}if(!1===P.autoUpdate&&!1===P.needsUpdate)continue;r.copy(P.mapSize);const z=P.getFrameExtents();r.multiply(z),s.copy(P.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/z.x),r.x=s.x*z.x,P.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/z.y),r.y=s.y*z.y,P.mapSize.y=s.y)),null===P.map&&(P.map=new so(r.x,r.y,this.type!==Tc?{minFilter:Yt,magFilter:Yt}:{}),P.map.texture.name=N.name+".shadowMap",P.camera.updateProjectionMatrix()),n.setRenderTarget(P.map),n.clear();const Y=P.getViewportCount();for(let ne=0;ne<Y;ne++){const j=P.getViewport(ne);o.set(s.x*j.x,s.y*j.y,s.x*j.z,s.y*j.w),R.viewport(o),P.updateMatrices(N,ne),i=P.getFrustum(),y(b,M,P.camera,N,this.type)}!0!==P.isPointLightShadow&&this.type===Tc&&v(P,M),P.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(A,w,S)}}function O6(n,e,t){const i=t.isWebGL2,a=new function r(){let L=!1;const $=new Dt;let re=null;const Se=new Dt(0,0,0,0);return{setMask:function(Te){re!==Te&&!L&&(n.colorMask(Te,Te,Te,Te),re=Te)},setLocked:function(Te){L=Te},setClear:function(Te,Ft,vn,qn,mr){!0===mr&&(Te*=qn,Ft*=qn,vn*=qn),$.set(Te,Ft,vn,qn),!1===Se.equals($)&&(n.clearColor(Te,Ft,vn,qn),Se.copy($))},reset:function(){L=!1,re=null,Se.set(-1,0,0,0)}}},l=new function s(){let L=!1,$=null,re=null,Se=null;return{setTest:function(Te){Te?me(2929):xe(2929)},setMask:function(Te){$!==Te&&!L&&(n.depthMask(Te),$=Te)},setFunc:function(Te){if(re!==Te){switch(Te){case EV:n.depthFunc(512);break;case DV:n.depthFunc(519);break;case CV:n.depthFunc(513);break;case yy:n.depthFunc(515);break;case TV:n.depthFunc(514);break;case AV:n.depthFunc(518);break;case IV:n.depthFunc(516);break;case RV:n.depthFunc(517);break;default:n.depthFunc(515)}re=Te}},setLocked:function(Te){L=Te},setClear:function(Te){Se!==Te&&(n.clearDepth(Te),Se=Te)},reset:function(){L=!1,$=null,re=null,Se=null}}},c=new function o(){let L=!1,$=null,re=null,Se=null,Te=null,Ft=null,vn=null,qn=null,mr=null;return{setTest:function(Jt){L||(Jt?me(2960):xe(2960))},setMask:function(Jt){$!==Jt&&!L&&(n.stencilMask(Jt),$=Jt)},setFunc:function(Jt,Ri,gr){(re!==Jt||Se!==Ri||Te!==gr)&&(n.stencilFunc(Jt,Ri,gr),re=Jt,Se=Ri,Te=gr)},setOp:function(Jt,Ri,gr){(Ft!==Jt||vn!==Ri||qn!==gr)&&(n.stencilOp(Jt,Ri,gr),Ft=Jt,vn=Ri,qn=gr)},setLocked:function(Jt){L=Jt},setClear:function(Jt){mr!==Jt&&(n.clearStencil(Jt),mr=Jt)},reset:function(){L=!1,$=null,re=null,Se=null,Te=null,Ft=null,vn=null,qn=null,mr=null}}},u=new WeakMap,d=new WeakMap;let h={},f={},m=new WeakMap,p=[],g=null,v=!1,_=null,y=null,x=null,b=null,M=null,A=null,w=null,S=!1,R=null,O=null,H=null,N=null,P=null;const z=n.getParameter(35661);let Y=!1,ne=0;const j=n.getParameter(7938);-1!==j.indexOf("WebGL")?(ne=parseFloat(/^WebGL (\d)/.exec(j)[1]),Y=ne>=1):-1!==j.indexOf("OpenGL ES")&&(ne=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),Y=ne>=2);let J=null,te={};const _e=n.getParameter(3088),V=n.getParameter(2978),Q=(new Dt).fromArray(_e),oe=(new Dt).fromArray(V);function k(L,$,re){const Se=new Uint8Array(4),Te=n.createTexture();n.bindTexture(L,Te),n.texParameteri(L,10241,9728),n.texParameteri(L,10240,9728);for(let Ft=0;Ft<re;Ft++)n.texImage2D($+Ft,0,6408,1,1,0,6408,5121,Se);return Te}const he={};function me(L){!0!==h[L]&&(n.enable(L),h[L]=!0)}function xe(L){!1!==h[L]&&(n.disable(L),h[L]=!1)}he[3553]=k(3553,3553,1),he[34067]=k(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),me(2929),l.setFunc(yy),fe(!1),$e(RD),me(2884),ce(us);const Z={[Ra]:32774,[pV]:32778,[mV]:32779};if(i)Z[FD]=32775,Z[kD]=32776;else{const L=e.get("EXT_blend_minmax");null!==L&&(Z[FD]=L.MIN_EXT,Z[kD]=L.MAX_EXT)}const ee={[gV]:0,[yV]:1,[vV]:768,[BD]:770,[SV]:776,[bV]:774,[xV]:772,[_V]:769,[UD]:771,[MV]:775,[wV]:773};function ce(L,$,re,Se,Te,Ft,vn,qn){if(L!==us){if(!1===v&&(me(3042),v=!0),L===fV)Te=Te||$,Ft=Ft||re,vn=vn||Se,($!==y||Te!==M)&&(n.blendEquationSeparate(Z[$],Z[Te]),y=$,M=Te),(re!==x||Se!==b||Ft!==A||vn!==w)&&(n.blendFuncSeparate(ee[re],ee[Se],ee[Ft],ee[vn]),x=re,b=Se,A=Ft,w=vn),_=L,S=!1;else if(L!==_||qn!==S){if((y!==Ra||M!==Ra)&&(n.blendEquation(32774),y=Ra,M=Ra),qn)switch(L){case Ia:n.blendFuncSeparate(1,771,1,771);break;case LD:n.blendFunc(1,1);break;case ND:n.blendFuncSeparate(0,769,0,1);break;case OD:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",L)}else switch(L){case Ia:n.blendFuncSeparate(770,771,1,771);break;case LD:n.blendFunc(770,1);break;case ND:n.blendFuncSeparate(0,769,0,1);break;case OD:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",L)}x=null,b=null,A=null,w=null,_=L,S=qn}}else!0===v&&(xe(3042),v=!1)}function fe(L){R!==L&&(n.frontFace(L?2304:2305),R=L)}function $e(L){L!==uV?(me(2884),L!==O&&n.cullFace(L===RD?1029:L===dV?1028:1032)):xe(2884),O=L}function qe(L,$,re){L?(me(32823),(N!==$||P!==re)&&(n.polygonOffset($,re),N=$,P=re)):xe(32823)}return{buffers:{color:a,depth:l,stencil:c},enable:me,disable:xe,bindFramebuffer:function Ee(L,$){return f[L]!==$&&(n.bindFramebuffer(L,$),f[L]=$,i&&(36009===L&&(f[36160]=$),36160===L&&(f[36009]=$)),!0)},drawBuffers:function Me(L,$){let re=p,Se=!1;if(L)if(re=m.get($),void 0===re&&(re=[],m.set($,re)),L.isWebGLMultipleRenderTargets){const Te=L.texture;if(re.length!==Te.length||36064!==re[0]){for(let Ft=0,vn=Te.length;Ft<vn;Ft++)re[Ft]=36064+Ft;re.length=Te.length,Se=!0}}else 36064!==re[0]&&(re[0]=36064,Se=!0);else 1029!==re[0]&&(re[0]=1029,Se=!0);Se&&(t.isWebGL2?n.drawBuffers(re):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(re))},useProgram:function Ne(L){return g!==L&&(n.useProgram(L),g=L,!0)},setBlending:ce,setMaterial:function Ce(L,$){L.side===Or?xe(2884):me(2884);let re=L.side===di;$&&(re=!re),fe(re),L.blending===Ia&&!1===L.transparent?ce(us):ce(L.blending,L.blendEquation,L.blendSrc,L.blendDst,L.blendEquationAlpha,L.blendSrcAlpha,L.blendDstAlpha,L.premultipliedAlpha),l.setFunc(L.depthFunc),l.setTest(L.depthTest),l.setMask(L.depthWrite),a.setMask(L.colorWrite);const Se=L.stencilWrite;c.setTest(Se),Se&&(c.setMask(L.stencilWriteMask),c.setFunc(L.stencilFunc,L.stencilRef,L.stencilFuncMask),c.setOp(L.stencilFail,L.stencilZFail,L.stencilZPass)),qe(L.polygonOffset,L.polygonOffsetFactor,L.polygonOffsetUnits),!0===L.alphaToCoverage?me(32926):xe(32926)},setFlipSided:fe,setCullFace:$e,setLineWidth:function Oe(L){L!==H&&(Y&&n.lineWidth(L),H=L)},setPolygonOffset:qe,setScissorTest:function Et(L){L?me(3089):xe(3089)},activeTexture:function yt(L){void 0===L&&(L=33984+z-1),J!==L&&(n.activeTexture(L),J=L)},bindTexture:function T(L,$,re){void 0===re&&(re=null===J?33984+z-1:J);let Se=te[re];void 0===Se&&(Se={type:void 0,texture:void 0},te[re]=Se),(Se.type!==L||Se.texture!==$)&&(J!==re&&(n.activeTexture(re),J=re),n.bindTexture(L,$||he[L]),Se.type=L,Se.texture=$)},unbindTexture:function E(){const L=te[J];void 0!==L&&void 0!==L.type&&(n.bindTexture(L.type,null),L.type=void 0,L.texture=void 0)},compressedTexImage2D:function G(){try{n.compressedTexImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexImage3D:function ae(){try{n.compressedTexImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texImage2D:function pe(){try{n.texImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texImage3D:function Ie(){try{n.texImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},updateUBOMapping:function ut(L,$){let re=d.get($);void 0===re&&(re=new WeakMap,d.set($,re));let Se=re.get(L);void 0===Se&&(Se=n.getUniformBlockIndex($,L.name),re.set(L,Se))},uniformBlockBinding:function vt(L,$){const Se=d.get($).get(L);u.get($)!==Se&&(n.uniformBlockBinding($,Se,L.__bindingPointIndex),u.set($,Se))},texStorage2D:function F(){try{n.texStorage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texStorage3D:function we(){try{n.texStorage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texSubImage2D:function le(){try{n.texSubImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},texSubImage3D:function ye(){try{n.texSubImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexSubImage2D:function Re(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},compressedTexSubImage3D:function I(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(L){console.error("THREE.WebGLState:",L)}},scissor:function Le(L){!1===Q.equals(L)&&(n.scissor(L.x,L.y,L.z,L.w),Q.copy(L))},viewport:function Pe(L){!1===oe.equals(L)&&(n.viewport(L.x,L.y,L.z,L.w),oe.copy(L))},reset:function Ct(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},J=null,te={},f={},m=new WeakMap,p=[],g=null,v=!1,_=null,y=null,x=null,b=null,M=null,A=null,w=null,S=!1,R=null,O=null,H=null,N=null,P=null,Q.set(0,0,n.canvas.width,n.canvas.height),oe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function F6(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let p;const g=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(T,E){return v?new OffscreenCanvas(T,E):kc("canvas")}function y(T,E,G,ae){let le=1;if((T.width>ae||T.height>ae)&&(le=ae/Math.max(T.width,T.height)),le<1||!0===E){if(typeof HTMLImageElement<"u"&&T instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&T instanceof ImageBitmap){const ye=E?gC:Math.floor,Re=ye(le*T.width),I=ye(le*T.height);void 0===p&&(p=_(Re,I));const F=G?_(Re,I):p;return F.width=Re,F.height=I,F.getContext("2d").drawImage(T,0,0,Re,I),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+T.width+"x"+T.height+") to ("+Re+"x"+I+")."),F}return"data"in T&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+T.width+"x"+T.height+")."),T}return T}function x(T){return Ry(T.width)&&Ry(T.height)}function M(T,E){return T.generateMipmaps&&E&&T.minFilter!==Yt&&T.minFilter!==Ht}function A(T){n.generateMipmap(T)}function w(T,E,G,ae,le=!1){if(!1===a)return E;if(null!==T){if(void 0!==n[T])return n[T];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+T+"'")}let ye=E;return 6403===E&&(5126===G&&(ye=33326),5131===G&&(ye=33325),5121===G&&(ye=33321)),33319===E&&(5126===G&&(ye=33328),5131===G&&(ye=33327),5121===G&&(ye=33323)),6408===E&&(5126===G&&(ye=34836),5131===G&&(ye=34842),5121===G&&(ye=ae===St&&!1===le?35907:32856),32819===G&&(ye=32854),32820===G&&(ye=32855)),(33325===ye||33326===ye||33327===ye||33328===ye||34842===ye||34836===ye)&&e.get("EXT_color_buffer_float"),ye}function S(T,E,G){return!0===M(T,G)||T.isFramebufferTexture&&T.minFilter!==Yt&&T.minFilter!==Ht?Math.log2(Math.max(E.width,E.height))+1:void 0!==T.mipmaps&&T.mipmaps.length>0?T.mipmaps.length:T.isCompressedTexture&&Array.isArray(T.image)?E.mipmaps.length:1}function R(T){return T===Yt||T===wh||T===Rc?9728:9729}function O(T){const E=T.target;E.removeEventListener("dispose",O),function N(T){const E=i.get(T);if(void 0===E.__webglInit)return;const G=T.source,ae=g.get(G);if(ae){const le=ae[E.__cacheKey];le.usedTimes--,0===le.usedTimes&&P(T),0===Object.keys(ae).length&&g.delete(G)}i.remove(T)}(E),E.isVideoTexture&&m.delete(E)}function H(T){const E=T.target;E.removeEventListener("dispose",H),function z(T){const E=T.texture,G=i.get(T),ae=i.get(E);if(void 0!==ae.__webglTexture&&(n.deleteTexture(ae.__webglTexture),o.memory.textures--),T.depthTexture&&T.depthTexture.dispose(),T.isWebGLCubeRenderTarget)for(let le=0;le<6;le++)n.deleteFramebuffer(G.__webglFramebuffer[le]),G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer[le]);else{if(n.deleteFramebuffer(G.__webglFramebuffer),G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&n.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let le=0;le<G.__webglColorRenderbuffer.length;le++)G.__webglColorRenderbuffer[le]&&n.deleteRenderbuffer(G.__webglColorRenderbuffer[le]);G.__webglDepthRenderbuffer&&n.deleteRenderbuffer(G.__webglDepthRenderbuffer)}if(T.isWebGLMultipleRenderTargets)for(let le=0,ye=E.length;le<ye;le++){const Re=i.get(E[le]);Re.__webglTexture&&(n.deleteTexture(Re.__webglTexture),o.memory.textures--),i.remove(E[le])}i.remove(E),i.remove(T)}(E)}function P(T){const E=i.get(T);n.deleteTexture(E.__webglTexture),delete g.get(T.source)[E.__cacheKey],o.memory.textures--}let Y=0;function te(T,E){const G=i.get(T);if(T.isVideoTexture&&function Et(T){const E=o.render.frame;m.get(T)!==E&&(m.set(T,E),T.update())}(T),!1===T.isRenderTargetTexture&&T.version>0&&G.__version!==T.version){const ae=T.image;if(null===ae)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==ae.complete)return void xe(G,T,E);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(3553,G.__webglTexture,33984+E)}const oe={[Ks]:10497,[Rn]:33071,[Ic]:33648},k={[Yt]:9728,[wh]:9984,[Rc]:9986,[Ht]:9729,[_y]:9985,[kr]:9987};function he(T,E,G){if(G?(n.texParameteri(T,10242,oe[E.wrapS]),n.texParameteri(T,10243,oe[E.wrapT]),(32879===T||35866===T)&&n.texParameteri(T,32882,oe[E.wrapR]),n.texParameteri(T,10240,k[E.magFilter]),n.texParameteri(T,10241,k[E.minFilter])):(n.texParameteri(T,10242,33071),n.texParameteri(T,10243,33071),(32879===T||35866===T)&&n.texParameteri(T,32882,33071),(E.wrapS!==Rn||E.wrapT!==Rn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(T,10240,R(E.magFilter)),n.texParameteri(T,10241,R(E.minFilter)),E.minFilter!==Yt&&E.minFilter!==Ht&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const ae=e.get("EXT_texture_filter_anisotropic");if(E.magFilter===Yt||E.minFilter!==Rc&&E.minFilter!==kr||E.type===ds&&!1===e.has("OES_texture_float_linear")||!1===a&&E.type===Pc&&!1===e.has("OES_texture_half_float_linear"))return;(E.anisotropy>1||i.get(E).__currentAnisotropy)&&(n.texParameterf(T,ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,r.getMaxAnisotropy())),i.get(E).__currentAnisotropy=E.anisotropy)}}function me(T,E){let G=!1;void 0===T.__webglInit&&(T.__webglInit=!0,E.addEventListener("dispose",O));const ae=E.source;let le=g.get(ae);void 0===le&&(le={},g.set(ae,le));const ye=function J(T){const E=[];return E.push(T.wrapS),E.push(T.wrapT),E.push(T.wrapR||0),E.push(T.magFilter),E.push(T.minFilter),E.push(T.anisotropy),E.push(T.internalFormat),E.push(T.format),E.push(T.type),E.push(T.generateMipmaps),E.push(T.premultiplyAlpha),E.push(T.flipY),E.push(T.unpackAlignment),E.push(T.encoding),E.join()}(E);if(ye!==T.__cacheKey){void 0===le[ye]&&(le[ye]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,G=!0),le[ye].usedTimes++;const Re=le[T.__cacheKey];void 0!==Re&&(le[T.__cacheKey].usedTimes--,0===Re.usedTimes&&P(E)),T.__cacheKey=ye,T.__webglTexture=le[ye].texture}return G}function xe(T,E,G){let ae=3553;(E.isDataArrayTexture||E.isCompressedArrayTexture)&&(ae=35866),E.isData3DTexture&&(ae=32879);const le=me(T,E),ye=E.source;t.bindTexture(ae,T.__webglTexture,33984+G);const Re=i.get(ye);if(ye.version!==Re.__version||!0===le){t.activeTexture(33984+G),n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const I=function b(T){return!a&&(T.wrapS!==Rn||T.wrapT!==Rn||T.minFilter!==Yt&&T.minFilter!==Ht)}(E)&&!1===x(E.image);let F=y(E.image,I,!1,u);F=yt(E,F);const we=x(F)||a,pe=s.convert(E.format,E.encoding);let Pe,Ie=s.convert(E.type),Le=w(E.internalFormat,pe,Ie,E.encoding,E.isVideoTexture);he(ae,E,we);const ut=E.mipmaps,vt=a&&!0!==E.isVideoTexture,Ct=void 0===Re.__version||!0===le,L=S(E,F,we);if(E.isDepthTexture)Le=6402,a?Le=E.type===ds?36012:E.type===Qs?33190:E.type===Pa?35056:33189:E.type===ds&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),E.format===eo&&6402===Le&&E.type!==zD&&E.type!==Qs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),E.type=Qs,Ie=s.convert(E.type)),E.format===La&&6402===Le&&(Le=34041,E.type!==Pa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=Pa,Ie=s.convert(E.type))),Ct&&(vt?t.texStorage2D(3553,1,Le,F.width,F.height):t.texImage2D(3553,0,Le,F.width,F.height,0,pe,Ie,null));else if(E.isDataTexture)if(ut.length>0&&we){vt&&Ct&&t.texStorage2D(3553,L,Le,ut[0].width,ut[0].height);for(let $=0,re=ut.length;$<re;$++)Pe=ut[$],vt?t.texSubImage2D(3553,$,0,0,Pe.width,Pe.height,pe,Ie,Pe.data):t.texImage2D(3553,$,Le,Pe.width,Pe.height,0,pe,Ie,Pe.data);E.generateMipmaps=!1}else vt?(Ct&&t.texStorage2D(3553,L,Le,F.width,F.height),t.texSubImage2D(3553,0,0,0,F.width,F.height,pe,Ie,F.data)):t.texImage2D(3553,0,Le,F.width,F.height,0,pe,Ie,F.data);else if(E.isCompressedTexture)if(E.isCompressedArrayTexture){vt&&Ct&&t.texStorage3D(35866,L,Le,ut[0].width,ut[0].height,F.depth);for(let $=0,re=ut.length;$<re;$++)Pe=ut[$],E.format!==Di?null!==pe?vt?t.compressedTexSubImage3D(35866,$,0,0,0,Pe.width,Pe.height,F.depth,pe,Pe.data,0,0):t.compressedTexImage3D(35866,$,Le,Pe.width,Pe.height,F.depth,0,Pe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):vt?t.texSubImage3D(35866,$,0,0,0,Pe.width,Pe.height,F.depth,pe,Ie,Pe.data):t.texImage3D(35866,$,Le,Pe.width,Pe.height,F.depth,0,pe,Ie,Pe.data)}else{vt&&Ct&&t.texStorage2D(3553,L,Le,ut[0].width,ut[0].height);for(let $=0,re=ut.length;$<re;$++)Pe=ut[$],E.format!==Di?null!==pe?vt?t.compressedTexSubImage2D(3553,$,0,0,Pe.width,Pe.height,pe,Pe.data):t.compressedTexImage2D(3553,$,Le,Pe.width,Pe.height,0,Pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):vt?t.texSubImage2D(3553,$,0,0,Pe.width,Pe.height,pe,Ie,Pe.data):t.texImage2D(3553,$,Le,Pe.width,Pe.height,0,pe,Ie,Pe.data)}else if(E.isDataArrayTexture)vt?(Ct&&t.texStorage3D(35866,L,Le,F.width,F.height,F.depth),t.texSubImage3D(35866,0,0,0,0,F.width,F.height,F.depth,pe,Ie,F.data)):t.texImage3D(35866,0,Le,F.width,F.height,F.depth,0,pe,Ie,F.data);else if(E.isData3DTexture)vt?(Ct&&t.texStorage3D(32879,L,Le,F.width,F.height,F.depth),t.texSubImage3D(32879,0,0,0,0,F.width,F.height,F.depth,pe,Ie,F.data)):t.texImage3D(32879,0,Le,F.width,F.height,F.depth,0,pe,Ie,F.data);else if(E.isFramebufferTexture){if(Ct)if(vt)t.texStorage2D(3553,L,Le,F.width,F.height);else{let $=F.width,re=F.height;for(let Se=0;Se<L;Se++)t.texImage2D(3553,Se,Le,$,re,0,pe,Ie,null),$>>=1,re>>=1}}else if(ut.length>0&&we){vt&&Ct&&t.texStorage2D(3553,L,Le,ut[0].width,ut[0].height);for(let $=0,re=ut.length;$<re;$++)Pe=ut[$],vt?t.texSubImage2D(3553,$,0,0,pe,Ie,Pe):t.texImage2D(3553,$,Le,pe,Ie,Pe);E.generateMipmaps=!1}else vt?(Ct&&t.texStorage2D(3553,L,Le,F.width,F.height),t.texSubImage2D(3553,0,0,0,pe,Ie,F)):t.texImage2D(3553,0,Le,pe,Ie,F);M(E,we)&&A(ae),Re.__version=ye.version,E.onUpdate&&E.onUpdate(E)}T.__version=E.version}function Me(T,E,G,ae,le){const ye=s.convert(G.format,G.encoding),Re=s.convert(G.type),I=w(G.internalFormat,ye,Re,G.encoding);i.get(E).__hasExternalTextures||(32879===le||35866===le?t.texImage3D(le,0,I,E.width,E.height,E.depth,0,ye,Re,null):t.texImage2D(le,0,I,E.width,E.height,0,ye,Re,null)),t.bindFramebuffer(36160,T),qe(E)?h.framebufferTexture2DMultisampleEXT(36160,ae,le,i.get(G).__webglTexture,0,Oe(E)):(3553===le||le>=34069&&le<=34074)&&n.framebufferTexture2D(36160,ae,le,i.get(G).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ne(T,E,G){if(n.bindRenderbuffer(36161,T),E.depthBuffer&&!E.stencilBuffer){let ae=33189;if(G||qe(E)){const le=E.depthTexture;le&&le.isDepthTexture&&(le.type===ds?ae=36012:le.type===Qs&&(ae=33190));const ye=Oe(E);qe(E)?h.renderbufferStorageMultisampleEXT(36161,ye,ae,E.width,E.height):n.renderbufferStorageMultisample(36161,ye,ae,E.width,E.height)}else n.renderbufferStorage(36161,ae,E.width,E.height);n.framebufferRenderbuffer(36160,36096,36161,T)}else if(E.depthBuffer&&E.stencilBuffer){const ae=Oe(E);G&&!1===qe(E)?n.renderbufferStorageMultisample(36161,ae,35056,E.width,E.height):qe(E)?h.renderbufferStorageMultisampleEXT(36161,ae,35056,E.width,E.height):n.renderbufferStorage(36161,34041,E.width,E.height),n.framebufferRenderbuffer(36160,33306,36161,T)}else{const ae=!0===E.isWebGLMultipleRenderTargets?E.texture:[E.texture];for(let le=0;le<ae.length;le++){const ye=ae[le],Re=s.convert(ye.format,ye.encoding),I=s.convert(ye.type),F=w(ye.internalFormat,Re,I,ye.encoding),we=Oe(E);G&&!1===qe(E)?n.renderbufferStorageMultisample(36161,we,F,E.width,E.height):qe(E)?h.renderbufferStorageMultisampleEXT(36161,we,F,E.width,E.height):n.renderbufferStorage(36161,F,E.width,E.height)}}n.bindRenderbuffer(36161,null)}function ee(T){const E=i.get(T),G=!0===T.isWebGLCubeRenderTarget;if(T.depthTexture&&!E.__autoAllocateDepthBuffer){if(G)throw new Error("target.depthTexture not supported in Cube render targets");!function Z(T,E){if(E&&E.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,T),!E.depthTexture||!E.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(E.depthTexture).__webglTexture||E.depthTexture.image.width!==E.width||E.depthTexture.image.height!==E.height)&&(E.depthTexture.image.width=E.width,E.depthTexture.image.height=E.height,E.depthTexture.needsUpdate=!0),te(E.depthTexture,0);const ae=i.get(E.depthTexture).__webglTexture,le=Oe(E);if(E.depthTexture.format===eo)qe(E)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,ae,0,le):n.framebufferTexture2D(36160,36096,3553,ae,0);else{if(E.depthTexture.format!==La)throw new Error("Unknown depthTexture format");qe(E)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,ae,0,le):n.framebufferTexture2D(36160,33306,3553,ae,0)}}(E.__webglFramebuffer,T)}else if(G){E.__webglDepthbuffer=[];for(let ae=0;ae<6;ae++)t.bindFramebuffer(36160,E.__webglFramebuffer[ae]),E.__webglDepthbuffer[ae]=n.createRenderbuffer(),Ne(E.__webglDepthbuffer[ae],T,!1)}else t.bindFramebuffer(36160,E.__webglFramebuffer),E.__webglDepthbuffer=n.createRenderbuffer(),Ne(E.__webglDepthbuffer,T,!1);t.bindFramebuffer(36160,null)}function Oe(T){return Math.min(d,T.samples)}function qe(T){const E=i.get(T);return a&&T.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==E.__useRenderToTexture}function yt(T,E){const G=T.encoding,ae=T.format,le=T.type;return!0===T.isCompressedTexture||!0===T.isVideoTexture||T.format===Ay||G!==to&&(G===St?!1===a?!0===e.has("EXT_sRGB")&&ae===Di?(T.format=Ay,T.minFilter=Ht,T.generateMipmaps=!1):E=_C.sRGBToLinear(E):(ae!==Di||le!==Js)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",G)),E}this.allocateTextureUnit=function j(){const T=Y;return T>=l&&console.warn("THREE.WebGLTextures: Trying to use "+T+" texture units while this GPU supports only "+l),Y+=1,T},this.resetTextureUnits=function ne(){Y=0},this.setTexture2D=te,this.setTexture2DArray=function _e(T,E){const G=i.get(T);T.version>0&&G.__version!==T.version?xe(G,T,E):t.bindTexture(35866,G.__webglTexture,33984+E)},this.setTexture3D=function V(T,E){const G=i.get(T);T.version>0&&G.__version!==T.version?xe(G,T,E):t.bindTexture(32879,G.__webglTexture,33984+E)},this.setTextureCube=function Q(T,E){const G=i.get(T);T.version>0&&G.__version!==T.version?function Ee(T,E,G){if(6!==E.image.length)return;const ae=me(T,E),le=E.source;t.bindTexture(34067,T.__webglTexture,33984+G);const ye=i.get(le);if(le.version!==ye.__version||!0===ae){t.activeTexture(33984+G),n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const Re=E.isCompressedTexture||E.image[0].isCompressedTexture,I=E.image[0]&&E.image[0].isDataTexture,F=[];for(let $=0;$<6;$++)F[$]=Re||I?I?E.image[$].image:E.image[$]:y(E.image[$],!1,!0,c),F[$]=yt(E,F[$]);const we=F[0],pe=x(we)||a,Ie=s.convert(E.format,E.encoding),Le=s.convert(E.type),Pe=w(E.internalFormat,Ie,Le,E.encoding),ut=a&&!0!==E.isVideoTexture,vt=void 0===ye.__version||!0===ae;let L,Ct=S(E,we,pe);if(he(34067,E,pe),Re){ut&&vt&&t.texStorage2D(34067,Ct,Pe,we.width,we.height);for(let $=0;$<6;$++){L=F[$].mipmaps;for(let re=0;re<L.length;re++){const Se=L[re];E.format!==Di?null!==Ie?ut?t.compressedTexSubImage2D(34069+$,re,0,0,Se.width,Se.height,Ie,Se.data):t.compressedTexImage2D(34069+$,re,Pe,Se.width,Se.height,0,Se.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ut?t.texSubImage2D(34069+$,re,0,0,Se.width,Se.height,Ie,Le,Se.data):t.texImage2D(34069+$,re,Pe,Se.width,Se.height,0,Ie,Le,Se.data)}}}else{L=E.mipmaps,ut&&vt&&(L.length>0&&Ct++,t.texStorage2D(34067,Ct,Pe,F[0].width,F[0].height));for(let $=0;$<6;$++)if(I){ut?t.texSubImage2D(34069+$,0,0,0,F[$].width,F[$].height,Ie,Le,F[$].data):t.texImage2D(34069+$,0,Pe,F[$].width,F[$].height,0,Ie,Le,F[$].data);for(let re=0;re<L.length;re++){const Te=L[re].image[$].image;ut?t.texSubImage2D(34069+$,re+1,0,0,Te.width,Te.height,Ie,Le,Te.data):t.texImage2D(34069+$,re+1,Pe,Te.width,Te.height,0,Ie,Le,Te.data)}}else{ut?t.texSubImage2D(34069+$,0,0,0,Ie,Le,F[$]):t.texImage2D(34069+$,0,Pe,Ie,Le,F[$]);for(let re=0;re<L.length;re++){const Se=L[re];ut?t.texSubImage2D(34069+$,re+1,0,0,Ie,Le,Se.image[$]):t.texImage2D(34069+$,re+1,Pe,Ie,Le,Se.image[$])}}}M(E,pe)&&A(34067),ye.__version=le.version,E.onUpdate&&E.onUpdate(E)}T.__version=E.version}(G,T,E):t.bindTexture(34067,G.__webglTexture,33984+E)},this.rebindTextures=function ce(T,E,G){const ae=i.get(T);void 0!==E&&Me(ae.__webglFramebuffer,T,T.texture,36064,3553),void 0!==G&&ee(T)},this.setupRenderTarget=function Ce(T){const E=T.texture,G=i.get(T),ae=i.get(E);T.addEventListener("dispose",H),!0!==T.isWebGLMultipleRenderTargets&&(void 0===ae.__webglTexture&&(ae.__webglTexture=n.createTexture()),ae.__version=E.version,o.memory.textures++);const le=!0===T.isWebGLCubeRenderTarget,ye=!0===T.isWebGLMultipleRenderTargets,Re=x(T)||a;if(le){G.__webglFramebuffer=[];for(let I=0;I<6;I++)G.__webglFramebuffer[I]=n.createFramebuffer()}else{if(G.__webglFramebuffer=n.createFramebuffer(),ye)if(r.drawBuffers){const I=T.texture;for(let F=0,we=I.length;F<we;F++){const pe=i.get(I[F]);void 0===pe.__webglTexture&&(pe.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&T.samples>0&&!1===qe(T)){const I=ye?E:[E];G.__webglMultisampledFramebuffer=n.createFramebuffer(),G.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,G.__webglMultisampledFramebuffer);for(let F=0;F<I.length;F++){const we=I[F];G.__webglColorRenderbuffer[F]=n.createRenderbuffer(),n.bindRenderbuffer(36161,G.__webglColorRenderbuffer[F]);const pe=s.convert(we.format,we.encoding),Ie=s.convert(we.type),Le=w(we.internalFormat,pe,Ie,we.encoding,!0===T.isXRRenderTarget),Pe=Oe(T);n.renderbufferStorageMultisample(36161,Pe,Le,T.width,T.height),n.framebufferRenderbuffer(36160,36064+F,36161,G.__webglColorRenderbuffer[F])}n.bindRenderbuffer(36161,null),T.depthBuffer&&(G.__webglDepthRenderbuffer=n.createRenderbuffer(),Ne(G.__webglDepthRenderbuffer,T,!0)),t.bindFramebuffer(36160,null)}}if(le){t.bindTexture(34067,ae.__webglTexture),he(34067,E,Re);for(let I=0;I<6;I++)Me(G.__webglFramebuffer[I],T,E,36064,34069+I);M(E,Re)&&A(34067),t.unbindTexture()}else if(ye){const I=T.texture;for(let F=0,we=I.length;F<we;F++){const pe=I[F],Ie=i.get(pe);t.bindTexture(3553,Ie.__webglTexture),he(3553,pe,Re),Me(G.__webglFramebuffer,T,pe,36064+F,3553),M(pe,Re)&&A(3553)}t.unbindTexture()}else{let I=3553;(T.isWebGL3DRenderTarget||T.isWebGLArrayRenderTarget)&&(a?I=T.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(I,ae.__webglTexture),he(I,E,Re),Me(G.__webglFramebuffer,T,E,36064,I),M(E,Re)&&A(I),t.unbindTexture()}T.depthBuffer&&ee(T)},this.updateRenderTargetMipmap=function fe(T){const E=x(T)||a,G=!0===T.isWebGLMultipleRenderTargets?T.texture:[T.texture];for(let ae=0,le=G.length;ae<le;ae++){const ye=G[ae];if(M(ye,E)){const Re=T.isWebGLCubeRenderTarget?34067:3553,I=i.get(ye).__webglTexture;t.bindTexture(Re,I),A(Re),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function $e(T){if(a&&T.samples>0&&!1===qe(T)){const E=T.isWebGLMultipleRenderTargets?T.texture:[T.texture],G=T.width,ae=T.height;let le=16384;const ye=[],Re=T.stencilBuffer?33306:36096,I=i.get(T),F=!0===T.isWebGLMultipleRenderTargets;if(F)for(let we=0;we<E.length;we++)t.bindFramebuffer(36160,I.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+we,36161,null),t.bindFramebuffer(36160,I.__webglFramebuffer),n.framebufferTexture2D(36009,36064+we,3553,null,0);t.bindFramebuffer(36008,I.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,I.__webglFramebuffer);for(let we=0;we<E.length;we++){ye.push(36064+we),T.depthBuffer&&ye.push(Re);const pe=void 0!==I.__ignoreDepthValues&&I.__ignoreDepthValues;if(!1===pe&&(T.depthBuffer&&(le|=256),T.stencilBuffer&&(le|=1024)),F&&n.framebufferRenderbuffer(36008,36064,36161,I.__webglColorRenderbuffer[we]),!0===pe&&(n.invalidateFramebuffer(36008,[Re]),n.invalidateFramebuffer(36009,[Re])),F){const Ie=i.get(E[we]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,Ie,0)}n.blitFramebuffer(0,0,G,ae,0,0,G,ae,le,9728),f&&n.invalidateFramebuffer(36008,ye)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),F)for(let we=0;we<E.length;we++){t.bindFramebuffer(36160,I.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+we,36161,I.__webglColorRenderbuffer[we]);const pe=i.get(E[we]).__webglTexture;t.bindFramebuffer(36160,I.__webglFramebuffer),n.framebufferTexture2D(36009,36064+we,3553,pe,0)}t.bindFramebuffer(36009,I.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ee,this.setupFrameBufferTexture=Me,this.useMultisampledRTT=qe}function k6(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Js)return 5121;if(s===HV)return 32819;if(s===GV)return 32820;if(s===UV)return 5120;if(s===zV)return 5122;if(s===zD)return 5123;if(s===VV)return 5124;if(s===Qs)return 5125;if(s===ds)return 5126;if(s===Pc)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(s===WV)return 6406;if(s===Di)return 6408;if(s===jV)return 6409;if(s===$V)return 6410;if(s===eo)return 6402;if(s===La)return 34041;if(s===Ay)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(s===qV)return 6403;if(s===XV)return 36244;if(s===YV)return 33319;if(s===ZV)return 33320;if(s===KV)return 36249;if(s===xy||s===wy||s===by||s===My)if(o===St){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(s===xy)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===wy)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===by)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===My)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(s===xy)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===wy)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===by)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===My)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(s===VD||s===HD||s===GD||s===WD){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(s===VD)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===HD)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===GD)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===WD)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(s===JV)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===jD||s===$D){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(s===jD)return o===St?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===$D)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(s===qD||s===XD||s===YD||s===ZD||s===KD||s===JD||s===QD||s===eC||s===tC||s===nC||s===iC||s===rC||s===sC||s===oC){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(s===qD)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===XD)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===YD)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===ZD)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===KD)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===JD)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===QD)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===eC)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===tC)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===nC)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===iC)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===rC)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===sC)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===oC)return o===St?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(s===Sy){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(s===Sy)return o===St?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(s===QV||s===aC||s===lC||s===cC){if(a=e.get("EXT_texture_compression_rgtc"),null===a)return null;if(s===Sy)return a.COMPRESSED_RED_RGTC1_EXT;if(s===aC)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===lC)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===cC)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return s===Pa?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[s]?n[s]:null}}}class B6 extends yn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class _s extends dn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const U6={type:"move"};class ov{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new _s,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new _s,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new D,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new D),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new _s,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new D,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new D),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const p of e.hand.values()){const g=t.getJointPose(p,i),v=this._getHandJoint(c,p);null!==g&&(v.matrix.fromArray(g.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=g.radius),v.visible=null!==g}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,m=.005;c.inputState.pinching&&h>f+m?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-m&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(U6)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new _s;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class z6 extends Wi{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:eo)!==eo&&u!==La)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===eo&&(i=Qs),void 0===i&&u===La&&(i=Pa),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:Yt,this.minFilter=void 0!==l?l:Yt,this.flipY=!1,this.generateMipmaps=!1}}class V6 extends io{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,m=null;const p=t.getContextAttributes();let g=null,v=null;const _=[],y=[],x=new Set,b=new Map,M=new yn;M.layers.enable(1),M.viewport=new Dt;const A=new yn;A.layers.enable(2),A.viewport=new Dt;const w=[M,A],S=new B6;S.layers.enable(1),S.layers.enable(2);let R=null,O=null;function H(V){const Q=y.indexOf(V.inputSource);if(-1===Q)return;const oe=_[Q];void 0!==oe&&oe.dispatchEvent({type:V.type,data:V.inputSource})}function N(){r.removeEventListener("select",H),r.removeEventListener("selectstart",H),r.removeEventListener("selectend",H),r.removeEventListener("squeeze",H),r.removeEventListener("squeezestart",H),r.removeEventListener("squeezeend",H),r.removeEventListener("end",N),r.removeEventListener("inputsourceschange",P);for(let V=0;V<_.length;V++){const Q=y[V];null!==Q&&(y[V]=null,_[V].disconnect(Q))}R=null,O=null,e.setRenderTarget(g),f=null,h=null,d=null,r=null,v=null,_e.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function P(V){for(let Q=0;Q<V.removed.length;Q++){const oe=V.removed[Q],k=y.indexOf(oe);k>=0&&(y[k]=null,_[k].disconnect(oe))}for(let Q=0;Q<V.added.length;Q++){const oe=V.added[Q];let k=y.indexOf(oe);if(-1===k){for(let me=0;me<_.length;me++){if(me>=y.length){y.push(oe),k=me;break}if(null===y[me]){y[me]=oe,k=me;break}}if(-1===k)break}const he=_[k];he&&he.connect(oe)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(V){let Q=_[V];return void 0===Q&&(Q=new ov,_[V]=Q),Q.getTargetRaySpace()},this.getControllerGrip=function(V){let Q=_[V];return void 0===Q&&(Q=new ov,_[V]=Q),Q.getGripSpace()},this.getHand=function(V){let Q=_[V];return void 0===Q&&(Q=new ov,_[V]=Q),Q.getHandSpace()},this.setFramebufferScaleFactor=function(V){s=V,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(V){a=V,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(V){c=V},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=function(){var V=function cV(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){ID(s,i,r,o,a,"next",l)}function a(l){ID(s,i,r,o,a,"throw",l)}o(void 0)})}}(function*(Q){if(r=Q,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",H),r.addEventListener("selectstart",H),r.addEventListener("selectend",H),r.addEventListener("squeeze",H),r.addEventListener("squeezestart",H),r.addEventListener("squeezeend",H),r.addEventListener("end",N),r.addEventListener("inputsourceschange",P),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),v=new so(f.framebufferWidth,f.framebufferHeight,{format:Di,type:Js,encoding:e.outputEncoding,stencilBuffer:p.stencil});else{let oe=null,k=null,he=null;p.depth&&(he=p.stencil?35056:33190,oe=p.stencil?La:eo,k=p.stencil?Pa:Qs);const me={colorFormat:32856,depthFormat:he,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(me),r.updateRenderState({layers:[h]}),v=new so(h.textureWidth,h.textureHeight,{format:Di,type:Js,depthTexture:new z6(h.textureWidth,h.textureHeight,k,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(v).__ignoreDepthValues=h.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),_e.setContext(r),_e.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Q){return V.apply(this,arguments)}}();const z=new D,Y=new D;function j(V,Q){null===Q?V.matrixWorld.copy(V.matrix):V.matrixWorld.multiplyMatrices(Q.matrixWorld,V.matrix),V.matrixWorldInverse.copy(V.matrixWorld).invert()}this.updateCamera=function(V){if(null===r)return;S.near=A.near=M.near=V.near,S.far=A.far=M.far=V.far,(R!==S.near||O!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),R=S.near,O=S.far);const Q=V.parent,oe=S.cameras;j(S,Q);for(let he=0;he<oe.length;he++)j(oe[he],Q);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),V.matrix.copy(S.matrix),V.matrix.decompose(V.position,V.quaternion,V.scale);const k=V.children;for(let he=0,me=k.length;he<me;he++)k[he].updateMatrixWorld(!0);2===oe.length?function ne(V,Q,oe){z.setFromMatrixPosition(Q.matrixWorld),Y.setFromMatrixPosition(oe.matrixWorld);const k=z.distanceTo(Y),he=Q.projectionMatrix.elements,me=oe.projectionMatrix.elements,xe=he[14]/(he[10]-1),Ee=he[14]/(he[10]+1),Me=(he[9]+1)/he[5],Ne=(he[9]-1)/he[5],Z=(he[8]-1)/he[0],ee=(me[8]+1)/me[0],ce=xe*Z,Ce=xe*ee,fe=k/(-Z+ee),$e=fe*-Z;Q.matrixWorld.decompose(V.position,V.quaternion,V.scale),V.translateX($e),V.translateZ(fe),V.matrixWorld.compose(V.position,V.quaternion,V.scale),V.matrixWorldInverse.copy(V.matrixWorld).invert();const Oe=xe+fe,qe=Ee+fe;V.projectionMatrix.makePerspective(ce-$e,Ce+(k-$e),Me*Ee/qe*Oe,Ne*Ee/qe*Oe,Oe,qe)}(S,M,A):S.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(V){l=V,null!==h&&(h.fixedFoveation=V),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=V)},this.getPlanes=function(){return x};let J=null;const _e=new OC;_e.setAnimationLoop(function te(V,Q){if(u=Q.getViewerPose(c||o),m=Q,null!==u){const oe=u.views;null!==f&&(e.setRenderTargetFramebuffer(v,f.framebuffer),e.setRenderTarget(v));let k=!1;oe.length!==S.cameras.length&&(S.cameras.length=0,k=!0);for(let he=0;he<oe.length;he++){const me=oe[he];let xe=null;if(null!==f)xe=f.getViewport(me);else{const Me=d.getViewSubImage(h,me);xe=Me.viewport,0===he&&(e.setRenderTargetTextures(v,Me.colorTexture,h.ignoreDepthValues?void 0:Me.depthStencilTexture),e.setRenderTarget(v))}let Ee=w[he];void 0===Ee&&(Ee=new yn,Ee.layers.enable(he),Ee.viewport=new Dt,w[he]=Ee),Ee.matrix.fromArray(me.transform.matrix),Ee.projectionMatrix.fromArray(me.projectionMatrix),Ee.viewport.set(xe.x,xe.y,xe.width,xe.height),0===he&&S.matrix.copy(Ee.matrix),!0===k&&S.cameras.push(Ee)}}for(let oe=0;oe<_.length;oe++){const k=y[oe],he=_[oe];null!==k&&void 0!==he&&he.update(k,Q,c||o)}if(J&&J(V,Q),Q.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:Q.detectedPlanes});let oe=null;for(const k of x)Q.detectedPlanes.has(k)||(null===oe&&(oe=[]),oe.push(k));if(null!==oe)for(const k of oe)x.delete(k),b.delete(k),i.dispatchEvent({type:"planeremoved",data:k});for(const k of Q.detectedPlanes)if(x.has(k)){const he=b.get(k);k.lastChangedTime>he&&(b.set(k,k.lastChangedTime),i.dispatchEvent({type:"planechanged",data:k}))}else x.add(k),b.set(k,Q.lastChangedTime),i.dispatchEvent({type:"planeadded",data:k})}m=null}),this.setAnimationLoop=function(V){J=V},this.dispose=function(){}}}function H6(n,e){function r(p,g){p.opacity.value=g.opacity,g.color&&p.diffuse.value.copy(g.color),g.emissive&&p.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.bumpMap&&(p.bumpMap.value=g.bumpMap,p.bumpScale.value=g.bumpScale,g.side===di&&(p.bumpScale.value*=-1)),g.displacementMap&&(p.displacementMap.value=g.displacementMap,p.displacementScale.value=g.displacementScale,p.displacementBias.value=g.displacementBias),g.emissiveMap&&(p.emissiveMap.value=g.emissiveMap),g.normalMap&&(p.normalMap.value=g.normalMap,p.normalScale.value.copy(g.normalScale),g.side===di&&p.normalScale.value.negate()),g.specularMap&&(p.specularMap.value=g.specularMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest);const v=e.get(g).envMap;if(v&&(p.envMap.value=v,p.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,p.reflectivity.value=g.reflectivity,p.ior.value=g.ior,p.refractionRatio.value=g.refractionRatio),g.lightMap){p.lightMap.value=g.lightMap;const x=!0===n.useLegacyLights?Math.PI:1;p.lightMapIntensity.value=g.lightMapIntensity*x}let _,y;g.aoMap&&(p.aoMap.value=g.aoMap,p.aoMapIntensity.value=g.aoMapIntensity),g.map?_=g.map:g.specularMap?_=g.specularMap:g.displacementMap?_=g.displacementMap:g.normalMap?_=g.normalMap:g.bumpMap?_=g.bumpMap:g.roughnessMap?_=g.roughnessMap:g.metalnessMap?_=g.metalnessMap:g.alphaMap?_=g.alphaMap:g.emissiveMap?_=g.emissiveMap:g.clearcoatMap?_=g.clearcoatMap:g.clearcoatNormalMap?_=g.clearcoatNormalMap:g.clearcoatRoughnessMap?_=g.clearcoatRoughnessMap:g.iridescenceMap?_=g.iridescenceMap:g.iridescenceThicknessMap?_=g.iridescenceThicknessMap:g.specularIntensityMap?_=g.specularIntensityMap:g.specularColorMap?_=g.specularColorMap:g.transmissionMap?_=g.transmissionMap:g.thicknessMap?_=g.thicknessMap:g.sheenColorMap?_=g.sheenColorMap:g.sheenRoughnessMap&&(_=g.sheenRoughnessMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix)),g.aoMap?y=g.aoMap:g.lightMap&&(y=g.lightMap),void 0!==y&&(y.isWebGLRenderTarget&&(y=y.texture),!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uv2Transform.value.copy(y.matrix))}return{refreshFogUniforms:function t(p,g){g.color.getRGB(p.fogColor.value,NC(n)),g.isFog?(p.fogNear.value=g.near,p.fogFar.value=g.far):g.isFogExp2&&(p.fogDensity.value=g.density)},refreshMaterialUniforms:function i(p,g,v,_,y){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(p,g):g.isMeshToonMaterial?(r(p,g),function u(p,g){g.gradientMap&&(p.gradientMap.value=g.gradientMap)}(p,g)):g.isMeshPhongMaterial?(r(p,g),function c(p,g){p.specular.value.copy(g.specular),p.shininess.value=Math.max(g.shininess,1e-4)}(p,g)):g.isMeshStandardMaterial?(r(p,g),function d(p,g){p.roughness.value=g.roughness,p.metalness.value=g.metalness,g.roughnessMap&&(p.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(p.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(p.envMapIntensity.value=g.envMapIntensity)}(p,g),g.isMeshPhysicalMaterial&&function h(p,g,v){p.ior.value=g.ior,g.sheen>0&&(p.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),p.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(p.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(p.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(p.clearcoat.value=g.clearcoat,p.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(p.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),p.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===di&&p.clearcoatNormalScale.value.negate())),g.iridescence>0&&(p.iridescence.value=g.iridescence,p.iridescenceIOR.value=g.iridescenceIOR,p.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(p.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(p.transmission.value=g.transmission,p.transmissionSamplerMap.value=v.texture,p.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(p.transmissionMap.value=g.transmissionMap),p.thickness.value=g.thickness,g.thicknessMap&&(p.thicknessMap.value=g.thicknessMap),p.attenuationDistance.value=g.attenuationDistance,p.attenuationColor.value.copy(g.attenuationColor)),p.specularIntensity.value=g.specularIntensity,p.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(p.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(p.specularColorMap.value=g.specularColorMap)}(p,g,y)):g.isMeshMatcapMaterial?(r(p,g),function f(p,g){g.matcap&&(p.matcap.value=g.matcap)}(p,g)):g.isMeshDepthMaterial?r(p,g):g.isMeshDistanceMaterial?(r(p,g),function m(p,g){p.referencePosition.value.copy(g.referencePosition),p.nearDistance.value=g.nearDistance,p.farDistance.value=g.farDistance}(p,g)):g.isMeshNormalMaterial?r(p,g):g.isLineBasicMaterial?(function s(p,g){p.diffuse.value.copy(g.color),p.opacity.value=g.opacity}(p,g),g.isLineDashedMaterial&&function o(p,g){p.dashSize.value=g.dashSize,p.totalSize.value=g.dashSize+g.gapSize,p.scale.value=g.scale}(p,g)):g.isPointsMaterial?function a(p,g,v,_){let y;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.size.value=g.size*v,p.scale.value=.5*_,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uvTransform.value.copy(y.matrix))}(p,g,v,_):g.isSpriteMaterial?function l(p,g){let v;p.diffuse.value.copy(g.color),p.opacity.value=g.opacity,p.rotation.value=g.rotation,g.map&&(p.map.value=g.map),g.alphaMap&&(p.alphaMap.value=g.alphaMap),g.alphaTest>0&&(p.alphaTest.value=g.alphaTest),g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),void 0!==v&&(!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uvTransform.value.copy(v.matrix))}(p,g):g.isShadowMaterial?(p.color.value.copy(g.color),p.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function G6(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(35375):0;function f(_,y,x){const b=_.value;if(void 0===x[y]){if("number"==typeof b)x[y]=b;else{const M=Array.isArray(b)?b:[b],A=[];for(let w=0;w<M.length;w++)A.push(M[w].clone());x[y]=A}return!0}if("number"==typeof b){if(x[y]!==b)return x[y]=b,!0}else{const M=Array.isArray(x[y])?x[y]:[x[y]],A=Array.isArray(b)?b:[b];for(let w=0;w<M.length;w++){const S=M[w];if(!1===S.equals(A[w]))return S.copy(A[w]),!0}}return!1}function p(_){const y={boundary:0,storage:0};return"number"==typeof _?(y.boundary=4,y.storage=4):_.isVector2?(y.boundary=8,y.storage=8):_.isVector3||_.isColor?(y.boundary=16,y.storage=12):_.isVector4?(y.boundary=16,y.storage=16):_.isMatrix3?(y.boundary=48,y.storage=48):_.isMatrix4?(y.boundary=64,y.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),y}function g(_){const y=_.target;y.removeEventListener("dispose",g);const x=o.indexOf(y.__bindingPointIndex);o.splice(x,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}return{bind:function l(_,y){i.uniformBlockBinding(_,y.program)},update:function c(_,y){let x=r[_.id];void 0===x&&(function m(_){const y=_.uniforms;let x=0;let M=0;for(let A=0,w=y.length;A<w;A++){const S=y[A],R={boundary:0,storage:0},O=Array.isArray(S.value)?S.value:[S.value];for(let H=0,N=O.length;H<N;H++){const z=p(O[H]);R.boundary+=z.boundary,R.storage+=z.storage}S.__data=new Float32Array(R.storage/Float32Array.BYTES_PER_ELEMENT),S.__offset=x,A>0&&(M=x%16,0!==M&&16-M-R.boundary<0&&(x+=16-M,S.__offset=x)),x+=R.storage}M=x%16,M>0&&(x+=16-M),_.__size=x,_.__cache={}}(_),x=function u(_){const y=function d(){for(let _=0;_<a;_++)if(-1===o.indexOf(_))return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();_.__bindingPointIndex=y;const x=n.createBuffer(),b=_.__size,M=_.usage;return n.bindBuffer(35345,x),n.bufferData(35345,b,M),n.bindBuffer(35345,null),n.bindBufferBase(35345,y,x),x}(_),r[_.id]=x,_.addEventListener("dispose",g)),i.updateUBOMapping(_,y.program);const M=e.render.frame;s[_.id]!==M&&(function h(_){const x=_.uniforms,b=_.__cache;n.bindBuffer(35345,r[_.id]);for(let M=0,A=x.length;M<A;M++){const w=x[M];if(!0===f(w,M,b)){const S=w.__offset,R=Array.isArray(w.value)?w.value:[w.value];let O=0;for(let H=0;H<R.length;H++){const N=R[H],P=p(N);"number"==typeof N?(w.__data[0]=N,n.bufferSubData(35345,S+O,w.__data)):N.isMatrix3?(w.__data[0]=N.elements[0],w.__data[1]=N.elements[1],w.__data[2]=N.elements[2],w.__data[3]=N.elements[0],w.__data[4]=N.elements[3],w.__data[5]=N.elements[4],w.__data[6]=N.elements[5],w.__data[7]=N.elements[0],w.__data[8]=N.elements[6],w.__data[9]=N.elements[7],w.__data[10]=N.elements[8],w.__data[11]=N.elements[0]):(N.toArray(w.__data,O),O+=P.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(35345,S,w.__data)}}n.bindBuffer(35345,null)}(_),s[_.id]=M)},dispose:function v(){for(const _ in r)n.deleteBuffer(r[_]);o=[],r={},s={}}}}function av(n={}){this.isWebGLRenderer=!0;const e=void 0!==n.canvas?n.canvas:function W6(){const n=kc("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,h=null;const f=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=to,this.useLegacyLights=!0,this.toneMapping=Fr,this.toneMappingExposure=1;const p=this;let g=!1,v=0,_=0,y=null,x=-1,b=null;const M=new Dt,A=new Dt;let w=null,S=e.width,R=e.height,O=1,H=null,N=null;const P=new Dt(0,0,S,R),z=new Dt(0,0,S,R);let Y=!1;const ne=new ev;let j=!1,J=!1,te=null;const _e=new Xe,V=new D,Q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function oe(){return null===y?O:1}let me,xe,Ee,Me,Ne,Z,ee,ce,Ce,fe,$e,Oe,qe,Et,yt,T,E,G,ae,le,ye,Re,I,F,k=t;function he(C,U){for(let W=0;W<C.length;W++){const q=e.getContext(C[W],U);if(null!==q)return q}return null}try{const C={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${gy}`),e.addEventListener("webglcontextlost",Ie,!1),e.addEventListener("webglcontextrestored",Le,!1),e.addEventListener("webglcontextcreationerror",Pe,!1),null===k){const U=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&U.shift(),k=he(U,C),null===k)throw he(U)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===k.getShaderPrecisionFormat&&(k.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(C){throw console.error("THREE.WebGLRenderer: "+C.message),C}function we(){me=new i5(k),xe=new KG(k,me,n),me.init(xe),Re=new k6(k,me,xe),Ee=new O6(k,me,xe),Me=new o5,Ne=new M6,Z=new F6(k,me,Ee,Ne,xe,Re,Me),ee=new QG(p),ce=new n5(p),Ce=new YH(k,xe),I=new YG(k,me,Ce,xe),fe=new r5(k,Ce,Me,I),$e=new u5(k,fe,Ce,Me),ae=new c5(k,xe,Z),T=new JG(Ne),Oe=new b6(p,ee,ce,me,xe,I,T),qe=new H6(p,Ne),Et=new E6,yt=new R6(me,xe),G=new XG(p,ee,ce,Ee,$e,u,o),E=new N6(p,$e,xe),F=new G6(k,Me,xe,Ee),le=new ZG(k,me,Me,xe),ye=new s5(k,me,Me,xe),Me.programs=Oe.programs,p.capabilities=xe,p.extensions=me,p.properties=Ne,p.renderLists=Et,p.shadowMap=E,p.state=Ee,p.info=Me}we();const pe=new V6(p,k);function Ie(C){C.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Le(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const C=Me.autoReset,U=E.enabled,W=E.autoUpdate,B=E.needsUpdate,q=E.type;we(),Me.autoReset=C,E.enabled=U,E.autoUpdate=W,E.needsUpdate=B,E.type=q}function Pe(C){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",C.statusMessage)}function ut(C){const U=C.target;U.removeEventListener("dispose",ut),function vt(C){(function Ct(C){const U=Ne.get(C).programs;void 0!==U&&(U.forEach(function(W){Oe.releaseProgram(W)}),C.isShaderMaterial&&Oe.releaseShaderCache(C))})(C),Ne.remove(C)}(U)}this.xr=pe,this.getContext=function(){return k},this.getContextAttributes=function(){return k.getContextAttributes()},this.forceContextLoss=function(){const C=me.get("WEBGL_lose_context");C&&C.loseContext()},this.forceContextRestore=function(){const C=me.get("WEBGL_lose_context");C&&C.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(C){void 0!==C&&(O=C,this.setSize(S,R,!1))},this.getSize=function(C){return C.set(S,R)},this.setSize=function(C,U,W=!0){pe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=C,R=U,e.width=Math.floor(C*O),e.height=Math.floor(U*O),!0===W&&(e.style.width=C+"px",e.style.height=U+"px"),this.setViewport(0,0,C,U))},this.getDrawingBufferSize=function(C){return C.set(S*O,R*O).floor()},this.setDrawingBufferSize=function(C,U,W){S=C,R=U,O=W,e.width=Math.floor(C*W),e.height=Math.floor(U*W),this.setViewport(0,0,C,U)},this.getCurrentViewport=function(C){return C.copy(M)},this.getViewport=function(C){return C.copy(P)},this.setViewport=function(C,U,W,B){C.isVector4?P.set(C.x,C.y,C.z,C.w):P.set(C,U,W,B),Ee.viewport(M.copy(P).multiplyScalar(O).floor())},this.getScissor=function(C){return C.copy(z)},this.setScissor=function(C,U,W,B){C.isVector4?z.set(C.x,C.y,C.z,C.w):z.set(C,U,W,B),Ee.scissor(A.copy(z).multiplyScalar(O).floor())},this.getScissorTest=function(){return Y},this.setScissorTest=function(C){Ee.setScissorTest(Y=C)},this.setOpaqueSort=function(C){H=C},this.setTransparentSort=function(C){N=C},this.getClearColor=function(C){return C.copy(G.getClearColor())},this.setClearColor=function(){G.setClearColor.apply(G,arguments)},this.getClearAlpha=function(){return G.getClearAlpha()},this.setClearAlpha=function(){G.setClearAlpha.apply(G,arguments)},this.clear=function(C=!0,U=!0,W=!0){let B=0;C&&(B|=16384),U&&(B|=256),W&&(B|=1024),k.clear(B)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ie,!1),e.removeEventListener("webglcontextrestored",Le,!1),e.removeEventListener("webglcontextcreationerror",Pe,!1),Et.dispose(),yt.dispose(),Ne.dispose(),ee.dispose(),ce.dispose(),$e.dispose(),I.dispose(),F.dispose(),Oe.dispose(),pe.dispose(),pe.removeEventListener("sessionstart",re),pe.removeEventListener("sessionend",Se),te&&(te.dispose(),te=null),Te.stop()},this.renderBufferDirect=function(C,U,W,B,q,ze){null===U&&(U=Q);const Qe=q.isMesh&&q.matrixWorld.determinant()<0,ot=function bj(C,U,W,B,q){!0!==U.isScene&&(U=Q),Z.resetTextureUnits();const ze=U.fog,ot=null===y?p.outputEncoding:!0===y.isXRRenderTarget?y.texture.encoding:to,lt=(B.isMeshStandardMaterial?ce:ee).get(B.envMap||(B.isMeshStandardMaterial?U.environment:null)),_t=!0===B.vertexColors&&!!W.attributes.color&&4===W.attributes.color.itemSize,pt=!!B.normalMap&&!!W.attributes.tangent,mt=!!W.morphAttributes.position,sn=!!W.morphAttributes.normal,mi=!!W.morphAttributes.color,qr=B.toneMapped?p.toneMapping:Fr,Eo=W.morphAttributes.position||W.morphAttributes.normal||W.morphAttributes.color,on=void 0!==Eo?Eo.length:0,gt=Ne.get(B),s0=h.state.lights;!0!==j||!0!==J&&C===b||T.setState(B,C,C===b&&B.id===x);let _n=!1;B.version===gt.__version?(gt.needsLights&&gt.lightsStateVersion!==s0.state.version||gt.outputEncoding!==ot||q.isInstancedMesh&&!1===gt.instancing||!q.isInstancedMesh&&!0===gt.instancing||q.isSkinnedMesh&&!1===gt.skinning||!q.isSkinnedMesh&&!0===gt.skinning||gt.envMap!==lt||!0===B.fog&&gt.fog!==ze||void 0!==gt.numClippingPlanes&&(gt.numClippingPlanes!==T.numPlanes||gt.numIntersection!==T.numIntersection)||gt.vertexAlphas!==_t||gt.vertexTangents!==pt||gt.morphTargets!==mt||gt.morphNormals!==sn||gt.morphColors!==mi||gt.toneMapping!==qr||!0===xe.isWebGL2&&gt.morphTargetsCount!==on)&&(_n=!0):(_n=!0,gt.__version=B.version);let Do=gt.currentProgram;!0===_n&&(Do=Ri(B,U,q));let UA=!1,gu=!1,o0=!1;const Xn=Do.getUniforms(),Co=gt.uniforms;if(Ee.useProgram(Do.program)&&(UA=!0,gu=!0,o0=!0),B.id!==x&&(x=B.id,gu=!0),UA||b!==C){if(Xn.setValue(k,"projectionMatrix",C.projectionMatrix),xe.logarithmicDepthBuffer&&Xn.setValue(k,"logDepthBufFC",2/(Math.log(C.far+1)/Math.LN2)),b!==C&&(b=C,gu=!0,o0=!0),B.isShaderMaterial||B.isMeshPhongMaterial||B.isMeshToonMaterial||B.isMeshStandardMaterial||B.envMap){const gi=Xn.map.cameraPosition;void 0!==gi&&gi.setValue(k,V.setFromMatrixPosition(C.matrixWorld))}(B.isMeshPhongMaterial||B.isMeshToonMaterial||B.isMeshLambertMaterial||B.isMeshBasicMaterial||B.isMeshStandardMaterial||B.isShaderMaterial)&&Xn.setValue(k,"isOrthographic",!0===C.isOrthographicCamera),(B.isMeshPhongMaterial||B.isMeshToonMaterial||B.isMeshLambertMaterial||B.isMeshBasicMaterial||B.isMeshStandardMaterial||B.isShaderMaterial||B.isShadowMaterial||q.isSkinnedMesh)&&Xn.setValue(k,"viewMatrix",C.matrixWorldInverse)}if(q.isSkinnedMesh){Xn.setOptional(k,q,"bindMatrix"),Xn.setOptional(k,q,"bindMatrixInverse");const gi=q.skeleton;gi&&(xe.floatVertexTextures?(null===gi.boneTexture&&gi.computeBoneTexture(),Xn.setValue(k,"boneTexture",gi.boneTexture,Z),Xn.setValue(k,"boneTextureSize",gi.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const a0=W.morphAttributes;if((void 0!==a0.position||void 0!==a0.normal||void 0!==a0.color&&!0===xe.isWebGL2)&&ae.update(q,W,Do),(gu||gt.receiveShadow!==q.receiveShadow)&&(gt.receiveShadow=q.receiveShadow,Xn.setValue(k,"receiveShadow",q.receiveShadow)),B.isMeshGouraudMaterial&&null!==B.envMap&&(Co.envMap.value=lt,Co.flipEnvMap.value=lt.isCubeTexture&&!1===lt.isRenderTargetTexture?-1:1),gu&&(Xn.setValue(k,"toneMappingExposure",p.toneMappingExposure),gt.needsLights&&function Mj(C,U){C.ambientLightColor.needsUpdate=U,C.lightProbe.needsUpdate=U,C.directionalLights.needsUpdate=U,C.directionalLightShadows.needsUpdate=U,C.pointLights.needsUpdate=U,C.pointLightShadows.needsUpdate=U,C.spotLights.needsUpdate=U,C.spotLightShadows.needsUpdate=U,C.rectAreaLights.needsUpdate=U,C.hemisphereLights.needsUpdate=U}(Co,o0),ze&&!0===B.fog&&qe.refreshFogUniforms(Co,ze),qe.refreshMaterialUniforms(Co,B,O,R,te),qh.upload(k,gt.uniformsList,Co,Z)),B.isShaderMaterial&&!0===B.uniformsNeedUpdate&&(qh.upload(k,gt.uniformsList,Co,Z),B.uniformsNeedUpdate=!1),B.isSpriteMaterial&&Xn.setValue(k,"center",q.center),Xn.setValue(k,"modelViewMatrix",q.modelViewMatrix),Xn.setValue(k,"normalMatrix",q.normalMatrix),Xn.setValue(k,"modelMatrix",q.matrixWorld),B.isShaderMaterial||B.isRawShaderMaterial){const gi=B.uniformsGroups;for(let l0=0,Ej=gi.length;l0<Ej;l0++)if(xe.isWebGL2){const zA=gi[l0];F.update(zA,Do),F.bind(zA,Do)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Do}(C,U,W,B,q);Ee.setMaterial(B,Qe);let lt=W.index,_t=1;!0===B.wireframe&&(lt=fe.getWireframeAttribute(W),_t=2);const pt=W.drawRange,mt=W.attributes.position;let sn=pt.start*_t,mi=(pt.start+pt.count)*_t;null!==ze&&(sn=Math.max(sn,ze.start*_t),mi=Math.min(mi,(ze.start+ze.count)*_t)),null!==lt?(sn=Math.max(sn,0),mi=Math.min(mi,lt.count)):null!=mt&&(sn=Math.max(sn,0),mi=Math.min(mi,mt.count));const qr=mi-sn;if(qr<0||qr===1/0)return;I.setup(q,B,ot,W,lt);let Eo,on=le;if(null!==lt&&(Eo=Ce.get(lt),on=ye,on.setIndex(Eo)),q.isMesh)!0===B.wireframe?(Ee.setLineWidth(B.wireframeLinewidth*oe()),on.setMode(1)):on.setMode(4);else if(q.isLine){let gt=B.linewidth;void 0===gt&&(gt=1),Ee.setLineWidth(gt*oe()),on.setMode(q.isLineSegments?1:q.isLineLoop?2:3)}else q.isPoints?on.setMode(0):q.isSprite&&on.setMode(4);if(q.isInstancedMesh)on.renderInstances(sn,qr,q.count);else if(W.isInstancedBufferGeometry){const s0=Math.min(W.instanceCount,void 0!==W._maxInstanceCount?W._maxInstanceCount:1/0);on.renderInstances(sn,qr,s0)}else on.render(sn,qr)},this.compile=function(C,U){function W(B,q,ze){!0===B.transparent&&B.side===Or&&!1===B.forceSinglePass?(B.side=di,B.needsUpdate=!0,Ri(B,q,ze),B.side=Nr,B.needsUpdate=!0,Ri(B,q,ze),B.side=Or):Ri(B,q,ze)}h=yt.get(C),h.init(),m.push(h),C.traverseVisible(function(B){B.isLight&&B.layers.test(U.layers)&&(h.pushLight(B),B.castShadow&&h.pushShadow(B))}),h.setupLights(p.useLegacyLights),C.traverse(function(B){const q=B.material;if(q)if(Array.isArray(q))for(let ze=0;ze<q.length;ze++)W(q[ze],C,B);else W(q,C,B)}),m.pop(),h=null};let L=null;function re(){Te.stop()}function Se(){Te.start()}const Te=new OC;function Ft(C,U,W,B){if(!1===C.visible)return;if(C.layers.test(U.layers))if(C.isGroup)W=C.renderOrder;else if(C.isLOD)!0===C.autoUpdate&&C.update(U);else if(C.isLight)h.pushLight(C),C.castShadow&&h.pushShadow(C);else if(C.isSprite){if(!C.frustumCulled||ne.intersectsSprite(C)){B&&V.setFromMatrixPosition(C.matrixWorld).applyMatrix4(_e);const Qe=$e.update(C),ot=C.material;ot.visible&&d.push(C,Qe,ot,W,V.z,null)}}else if((C.isMesh||C.isLine||C.isPoints)&&(C.isSkinnedMesh&&C.skeleton.frame!==Me.render.frame&&(C.skeleton.update(),C.skeleton.frame=Me.render.frame),!C.frustumCulled||ne.intersectsObject(C))){B&&V.setFromMatrixPosition(C.matrixWorld).applyMatrix4(_e);const Qe=$e.update(C),ot=C.material;if(Array.isArray(ot)){const lt=Qe.groups;for(let _t=0,pt=lt.length;_t<pt;_t++){const mt=lt[_t],sn=ot[mt.materialIndex];sn&&sn.visible&&d.push(C,Qe,sn,W,V.z,mt)}}else ot.visible&&d.push(C,Qe,ot,W,V.z,null)}const ze=C.children;for(let Qe=0,ot=ze.length;Qe<ot;Qe++)Ft(ze[Qe],U,W,B)}function vn(C,U,W,B){const q=C.opaque,ze=C.transmissive,Qe=C.transparent;h.setupLightsView(W),!0===j&&T.setGlobalState(p.clippingPlanes,W),ze.length>0&&function qn(C,U,W){const B=xe.isWebGL2;null===te&&(te=new so(1024,1024,{generateMipmaps:!0,type:me.has("EXT_color_buffer_half_float")?Pc:Js,minFilter:kr,samples:B&&!0===s?4:0}));const q=p.getRenderTarget();p.setRenderTarget(te),p.clear();const ze=p.toneMapping;p.toneMapping=Fr,mr(C,U,W),p.toneMapping=ze,Z.updateMultisampleRenderTarget(te),Z.updateRenderTargetMipmap(te),p.setRenderTarget(q)}(q,U,W),B&&Ee.viewport(M.copy(B)),q.length>0&&mr(q,U,W),ze.length>0&&mr(ze,U,W),Qe.length>0&&mr(Qe,U,W),Ee.buffers.depth.setTest(!0),Ee.buffers.depth.setMask(!0),Ee.buffers.color.setMask(!0),Ee.setPolygonOffset(!1)}function mr(C,U,W){const B=!0===U.isScene?U.overrideMaterial:null;for(let q=0,ze=C.length;q<ze;q++){const Qe=C[q],ot=Qe.object,lt=Qe.geometry,_t=null===B?Qe.material:B,pt=Qe.group;ot.layers.test(W.layers)&&Jt(ot,U,W,lt,_t,pt)}}function Jt(C,U,W,B,q,ze){C.onBeforeRender(p,U,W,B,q,ze),C.modelViewMatrix.multiplyMatrices(W.matrixWorldInverse,C.matrixWorld),C.normalMatrix.getNormalMatrix(C.modelViewMatrix),q.onBeforeRender(p,U,W,B,C,ze),!0===q.transparent&&q.side===Or&&!1===q.forceSinglePass?(q.side=di,q.needsUpdate=!0,p.renderBufferDirect(W,U,B,q,C,ze),q.side=Nr,q.needsUpdate=!0,p.renderBufferDirect(W,U,B,q,C,ze),q.side=Or):p.renderBufferDirect(W,U,B,q,C,ze),C.onAfterRender(p,U,W,B,q,ze)}function Ri(C,U,W){!0!==U.isScene&&(U=Q);const B=Ne.get(C),q=h.state.lights,Qe=q.state.version,ot=Oe.getParameters(C,q.state,h.state.shadowsArray,U,W),lt=Oe.getProgramCacheKey(ot);let _t=B.programs;B.environment=C.isMeshStandardMaterial?U.environment:null,B.fog=U.fog,B.envMap=(C.isMeshStandardMaterial?ce:ee).get(C.envMap||B.environment),void 0===_t&&(C.addEventListener("dispose",ut),_t=new Map,B.programs=_t);let pt=_t.get(lt);if(void 0!==pt){if(B.currentProgram===pt&&B.lightsStateVersion===Qe)return gr(C,ot),pt}else ot.uniforms=Oe.getUniforms(C),C.onBuild(W,ot,p),C.onBeforeCompile(ot,p),pt=Oe.acquireProgram(ot,lt),_t.set(lt,pt),B.uniforms=ot.uniforms;const mt=B.uniforms;(!C.isShaderMaterial&&!C.isRawShaderMaterial||!0===C.clipping)&&(mt.clippingPlanes=T.uniform),gr(C,ot),B.needsLights=function Sj(C){return C.isMeshLambertMaterial||C.isMeshToonMaterial||C.isMeshPhongMaterial||C.isMeshStandardMaterial||C.isShadowMaterial||C.isShaderMaterial&&!0===C.lights}(C),B.lightsStateVersion=Qe,B.needsLights&&(mt.ambientLightColor.value=q.state.ambient,mt.lightProbe.value=q.state.probe,mt.directionalLights.value=q.state.directional,mt.directionalLightShadows.value=q.state.directionalShadow,mt.spotLights.value=q.state.spot,mt.spotLightShadows.value=q.state.spotShadow,mt.rectAreaLights.value=q.state.rectArea,mt.ltc_1.value=q.state.rectAreaLTC1,mt.ltc_2.value=q.state.rectAreaLTC2,mt.pointLights.value=q.state.point,mt.pointLightShadows.value=q.state.pointShadow,mt.hemisphereLights.value=q.state.hemi,mt.directionalShadowMap.value=q.state.directionalShadowMap,mt.directionalShadowMatrix.value=q.state.directionalShadowMatrix,mt.spotShadowMap.value=q.state.spotShadowMap,mt.spotLightMatrix.value=q.state.spotLightMatrix,mt.spotLightMap.value=q.state.spotLightMap,mt.pointShadowMap.value=q.state.pointShadowMap,mt.pointShadowMatrix.value=q.state.pointShadowMatrix);const sn=pt.getUniforms(),mi=qh.seqWithValue(sn.seq,mt);return B.currentProgram=pt,B.uniformsList=mi,pt}function gr(C,U){const W=Ne.get(C);W.outputEncoding=U.outputEncoding,W.instancing=U.instancing,W.skinning=U.skinning,W.morphTargets=U.morphTargets,W.morphNormals=U.morphNormals,W.morphColors=U.morphColors,W.morphTargetsCount=U.morphTargetsCount,W.numClippingPlanes=U.numClippingPlanes,W.numIntersection=U.numClipIntersection,W.vertexAlphas=U.vertexAlphas,W.vertexTangents=U.vertexTangents,W.toneMapping=U.toneMapping}Te.setAnimationLoop(function $(C){L&&L(C)}),typeof self<"u"&&Te.setContext(self),this.setAnimationLoop=function(C){L=C,pe.setAnimationLoop(C),null===C?Te.stop():Te.start()},pe.addEventListener("sessionstart",re),pe.addEventListener("sessionend",Se),this.render=function(C,U){if(void 0===U||!0===U.isCamera){if(!0!==g){if(!0===C.matrixWorldAutoUpdate&&C.updateMatrixWorld(),null===U.parent&&!0===U.matrixWorldAutoUpdate&&U.updateMatrixWorld(),!0===pe.enabled&&!0===pe.isPresenting&&(!0===pe.cameraAutoUpdate&&pe.updateCamera(U),U=pe.getCamera()),!0===C.isScene&&C.onBeforeRender(p,C,U,y),h=yt.get(C,m.length),h.init(),m.push(h),_e.multiplyMatrices(U.projectionMatrix,U.matrixWorldInverse),ne.setFromProjectionMatrix(_e),J=this.localClippingEnabled,j=T.init(this.clippingPlanes,J),d=Et.get(C,f.length),d.init(),f.push(d),Ft(C,U,0,p.sortObjects),d.finish(),!0===p.sortObjects&&d.sort(H,N),!0===j&&T.beginShadows(),E.render(h.state.shadowsArray,C,U),!0===j&&T.endShadows(),!0===this.info.autoReset&&this.info.reset(),G.render(d,C),h.setupLights(p.useLegacyLights),U.isArrayCamera){const B=U.cameras;for(let q=0,ze=B.length;q<ze;q++){const Qe=B[q];vn(d,C,Qe,Qe.viewport)}}else vn(d,C,U);null!==y&&(Z.updateMultisampleRenderTarget(y),Z.updateRenderTargetMipmap(y)),!0===C.isScene&&C.onAfterRender(p,C,U),I.resetDefaultState(),x=-1,b=null,m.pop(),h=m.length>0?m[m.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(C,U,W){Ne.get(C.texture).__webglTexture=U,Ne.get(C.depthTexture).__webglTexture=W;const B=Ne.get(C);B.__hasExternalTextures=!0,B.__hasExternalTextures&&(B.__autoAllocateDepthBuffer=void 0===W,B.__autoAllocateDepthBuffer||!0===me.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),B.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(C,U){const W=Ne.get(C);W.__webglFramebuffer=U,W.__useDefaultFramebuffer=void 0===U},this.setRenderTarget=function(C,U=0,W=0){y=C,v=U,_=W;let B=!0,q=null,ze=!1,Qe=!1;if(C){const lt=Ne.get(C);void 0!==lt.__useDefaultFramebuffer?(Ee.bindFramebuffer(36160,null),B=!1):void 0===lt.__webglFramebuffer?Z.setupRenderTarget(C):lt.__hasExternalTextures&&Z.rebindTextures(C,Ne.get(C.texture).__webglTexture,Ne.get(C.depthTexture).__webglTexture);const _t=C.texture;(_t.isData3DTexture||_t.isDataArrayTexture||_t.isCompressedArrayTexture)&&(Qe=!0);const pt=Ne.get(C).__webglFramebuffer;C.isWebGLCubeRenderTarget?(q=pt[U],ze=!0):q=xe.isWebGL2&&C.samples>0&&!1===Z.useMultisampledRTT(C)?Ne.get(C).__webglMultisampledFramebuffer:pt,M.copy(C.viewport),A.copy(C.scissor),w=C.scissorTest}else M.copy(P).multiplyScalar(O).floor(),A.copy(z).multiplyScalar(O).floor(),w=Y;if(Ee.bindFramebuffer(36160,q)&&xe.drawBuffers&&B&&Ee.drawBuffers(C,q),Ee.viewport(M),Ee.scissor(A),Ee.setScissorTest(w),ze){const lt=Ne.get(C.texture);k.framebufferTexture2D(36160,36064,34069+U,lt.__webglTexture,W)}else if(Qe){const lt=Ne.get(C.texture);k.framebufferTextureLayer(36160,36064,lt.__webglTexture,W||0,U||0)}x=-1},this.readRenderTargetPixels=function(C,U,W,B,q,ze,Qe){if(!C||!C.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ot=Ne.get(C).__webglFramebuffer;if(C.isWebGLCubeRenderTarget&&void 0!==Qe&&(ot=ot[Qe]),ot){Ee.bindFramebuffer(36160,ot);try{const lt=C.texture,_t=lt.format,pt=lt.type;if(_t!==Di&&Re.convert(_t)!==k.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const mt=pt===Pc&&(me.has("EXT_color_buffer_half_float")||xe.isWebGL2&&me.has("EXT_color_buffer_float"));if(!(pt===Js||Re.convert(pt)===k.getParameter(35738)||pt===ds&&(xe.isWebGL2||me.has("OES_texture_float")||me.has("WEBGL_color_buffer_float"))||mt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");U>=0&&U<=C.width-B&&W>=0&&W<=C.height-q&&k.readPixels(U,W,B,q,Re.convert(_t),Re.convert(pt),ze)}finally{const lt=null!==y?Ne.get(y).__webglFramebuffer:null;Ee.bindFramebuffer(36160,lt)}}},this.copyFramebufferToTexture=function(C,U,W=0){const B=Math.pow(2,-W),q=Math.floor(U.image.width*B),ze=Math.floor(U.image.height*B);Z.setTexture2D(U,0),k.copyTexSubImage2D(3553,W,0,0,C.x,C.y,q,ze),Ee.unbindTexture()},this.copyTextureToTexture=function(C,U,W,B=0){const q=U.image.width,ze=U.image.height,Qe=Re.convert(W.format),ot=Re.convert(W.type);Z.setTexture2D(W,0),k.pixelStorei(37440,W.flipY),k.pixelStorei(37441,W.premultiplyAlpha),k.pixelStorei(3317,W.unpackAlignment),U.isDataTexture?k.texSubImage2D(3553,B,C.x,C.y,q,ze,Qe,ot,U.image.data):U.isCompressedTexture?k.compressedTexSubImage2D(3553,B,C.x,C.y,U.mipmaps[0].width,U.mipmaps[0].height,Qe,U.mipmaps[0].data):k.texSubImage2D(3553,B,C.x,C.y,Qe,ot,U.image),0===B&&W.generateMipmaps&&k.generateMipmap(3553),Ee.unbindTexture()},this.copyTextureToTexture3D=function(C,U,W,B,q=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const ze=C.max.x-C.min.x+1,Qe=C.max.y-C.min.y+1,ot=C.max.z-C.min.z+1,lt=Re.convert(B.format),_t=Re.convert(B.type);let pt;if(B.isData3DTexture)Z.setTexture3D(B,0),pt=32879;else{if(!B.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Z.setTexture2DArray(B,0),pt=35866}k.pixelStorei(37440,B.flipY),k.pixelStorei(37441,B.premultiplyAlpha),k.pixelStorei(3317,B.unpackAlignment);const mt=k.getParameter(3314),sn=k.getParameter(32878),mi=k.getParameter(3316),qr=k.getParameter(3315),Eo=k.getParameter(32877),on=W.isCompressedTexture?W.mipmaps[0]:W.image;k.pixelStorei(3314,on.width),k.pixelStorei(32878,on.height),k.pixelStorei(3316,C.min.x),k.pixelStorei(3315,C.min.y),k.pixelStorei(32877,C.min.z),W.isDataTexture||W.isData3DTexture?k.texSubImage3D(pt,q,U.x,U.y,U.z,ze,Qe,ot,lt,_t,on.data):W.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),k.compressedTexSubImage3D(pt,q,U.x,U.y,U.z,ze,Qe,ot,lt,on.data)):k.texSubImage3D(pt,q,U.x,U.y,U.z,ze,Qe,ot,lt,_t,on),k.pixelStorei(3314,mt),k.pixelStorei(32878,sn),k.pixelStorei(3316,mi),k.pixelStorei(3315,qr),k.pixelStorei(32877,Eo),0===q&&B.generateMipmaps&&k.generateMipmap(pt),Ee.unbindTexture()},this.initTexture=function(C){C.isCubeTexture?Z.setTextureCube(C,0):C.isData3DTexture?Z.setTexture3D(C,0):C.isDataArrayTexture||C.isCompressedArrayTexture?Z.setTexture2DArray(C,0):Z.setTexture2D(C,0),Ee.unbindTexture()},this.resetState=function(){v=0,_=0,y=null,Ee.reset(),I.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(av.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(n){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!n}}}),class j6 extends av{}.prototype.isWebGL1Renderer=!0;class uT extends dn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class uv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=hi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=hi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=hi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const $n=new D;class po{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)$n.fromBufferAttribute(this,t),$n.applyMatrix4(e),this.setXYZ(t,$n.x,$n.y,$n.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)$n.fromBufferAttribute(this,t),$n.applyNormalMatrix(e),this.setXYZ(t,$n.x,$n.y,$n.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)$n.fromBufferAttribute(this,t),$n.transformDirection(e),this.setXYZ(t,$n.x,$n.y,$n.z);return this}setX(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=At(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Br(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Br(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Br(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Br(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=At(t,this.array),i=At(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=At(t,this.array),i=At(i,this.array),r=At(r,this.array),s=At(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Gt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new po(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const gT=new D,yT=new Dt,vT=new Dt,X6=new D,_T=new Xe;class xT extends On{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Xe,this.bindMatrixInverse=new Xe}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Dt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;yT.fromBufferAttribute(r.attributes.skinIndex,e),vT.fromBufferAttribute(r.attributes.skinWeight,e),gT.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=vT.getComponent(s);if(0!==o){const a=yT.getComponent(s);_T.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(X6.copy(gT).applyMatrix4(_T),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class hv extends dn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Yc extends Wi{constructor(e=null,t=1,i=1,r,s,o,a,l,c=Yt,u=Yt,d,h){super(null,o,a,l,c,u,r,s,d,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const wT=new Xe,Y6=new Xe;class Jh{constructor(e=[],t=[]){this.uuid=hi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Xe)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Xe;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)wT.multiplyMatrices(e[s]?e[s].matrixWorld:Y6,t[s]),wT.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new Jh(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=mC(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Yc(t,e,e,Di,ds);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new hv),this.bones.push(o),this.boneInverses.push((new Xe).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class Zc extends Gt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const bT=new Xe,MT=new Xe,Qh=[],Z6=new Xe,Kc=new On;class ST extends On{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Zc(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let r=0;r<i;r++)this.setMatrixAt(r,Z6)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Kc.geometry=this.geometry,Kc.material=this.material,void 0!==Kc.material)for(let s=0;s<r;s++){this.getMatrixAt(s,bT),MT.multiplyMatrices(i,bT),Kc.matrixWorld=MT,Kc.raycast(e,Qh);for(let o=0,a=Qh.length;o<a;o++){const l=Qh[o];l.instanceId=s,l.object=this,t.push(l)}Qh.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Zc(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ei extends Xi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ge(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ET=new D,DT=new D,CT=new Xe,fv=new Th,ef=new co;class mo extends dn{constructor(e=new st,t=new ei){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)ET.fromBufferAttribute(t,r-1),DT.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=ET.distanceTo(DT);e.setAttribute("lineDistance",new De(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),ef.copy(i.boundingSphere),ef.applyMatrix4(r),ef.radius+=s,!1===e.ray.intersectsSphere(ef))return;CT.copy(r).invert(),fv.copy(e.ray).applyMatrix4(CT);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new D,u=new D,d=new D,h=new D,f=this.isLineSegments?2:1,m=i.index,g=i.attributes.position;if(null!==m)for(let y=Math.max(0,o.start),x=Math.min(m.count,o.start+o.count)-1;y<x;y+=f){const b=m.getX(y),M=m.getX(y+1);if(c.fromBufferAttribute(g,b),u.fromBufferAttribute(g,M),fv.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(h);w<e.near||w>e.far||t.push({distance:w,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count)-1;y<x;y+=f){if(c.fromBufferAttribute(g,y),u.fromBufferAttribute(g,y+1),fv.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(h);M<e.near||M>e.far||t.push({distance:M,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const TT=new D,AT=new D;class pv extends mo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)TT.fromBufferAttribute(t,r),AT.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+TT.distanceTo(AT);e.setAttribute("lineDistance",new De(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class IT extends mo{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class mv extends Xi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ge(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const RT=new Xe,gv=new Th,tf=new co,nf=new D;class PT extends dn{constructor(e=new st,t=new mv){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),tf.copy(i.boundingSphere),tf.applyMatrix4(r),tf.radius+=s,!1===e.ray.intersectsSphere(tf))return;RT.copy(r).invert(),gv.copy(e.ray).applyMatrix4(RT);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(null!==c)for(let m=Math.max(0,o.start),p=Math.min(c.count,o.start+o.count);m<p;m++){const g=c.getX(m);nf.fromBufferAttribute(d,g),LT(nf,g,l,r,e,t,this)}else for(let m=Math.max(0,o.start),p=Math.min(d.count,o.start+o.count);m<p;m++)nf.fromBufferAttribute(d,m),LT(nf,m,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function LT(n,e,t,i,r,s,o){const a=gv.distanceSqToPoint(n);if(a<t){const l=new D;gv.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class gf extends Xi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ge(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=no,this.normalScale=new X(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xs extends gf{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new X(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Zt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ge(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ge(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ge(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function Ai(n,e,t){return Uv(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)}function vo(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}function Uv(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function qT(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i}function zv(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function Vv(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)}class ru{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class HW extends ru{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,m=(i-t)/(r-t),p=m*m,g=p*m,v=-h*g+2*h*p-h*m,_=(1+h)*g+(-1.5-2*h)*p+(-.5+h)*m+1,y=(-1-f)*g+(1.5+f)*p+.5*m,x=f*g-f*p;for(let b=0;b!==a;++b)s[b]=v*o[u+b]+_*o[c+b]+y*o[l+b]+x*o[d+b];return s}}class XT extends ru{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class GW extends ru{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class fr{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=vo(t,this.TimeBufferType),this.values=vo(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:vo(e.times,Array),values:vo(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new GW(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new XT(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new HW(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Lc:t=this.InterpolantFactoryMethodDiscrete;break;case Na:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Lc;case this.InterpolantFactoryMethodLinear:return Na;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Ai(i,s,o),this.values=Ai(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Uv(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Ai(this.times),t=Ai(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let m=0;m!==i;++m){const p=t[d+m];if(p!==t[h+m]||p!==t[f+m]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Ai(e,0,o),this.values=Ai(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=Ai(this.times,0),t=Ai(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}fr.prototype.TimeBufferType=Float32Array,fr.prototype.ValueBufferType=Float32Array,fr.prototype.DefaultInterpolation=Na;class cl extends fr{}cl.prototype.ValueTypeName="bool",cl.prototype.ValueBufferType=Array,cl.prototype.DefaultInterpolation=Lc,cl.prototype.InterpolantFactoryMethodLinear=void 0,cl.prototype.InterpolantFactoryMethodSmooth=void 0;class YT extends fr{}YT.prototype.ValueTypeName="color";class su extends fr{}su.prototype.ValueTypeName="number";class WW extends ru{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Sn.slerpFlat(s,0,o,c-a,o,c,l);return s}}class _o extends fr{InterpolantFactoryMethodLinear(e){return new WW(this.times,this.values,this.getValueSize(),e)}}_o.prototype.ValueTypeName="quaternion",_o.prototype.DefaultInterpolation=Na,_o.prototype.InterpolantFactoryMethodSmooth=void 0;class ul extends fr{}ul.prototype.ValueTypeName="string",ul.prototype.ValueBufferType=Array,ul.prototype.DefaultInterpolation=Lc,ul.prototype.InterpolantFactoryMethodLinear=void 0,ul.prototype.InterpolantFactoryMethodSmooth=void 0;class ou extends fr{}ou.prototype.ValueTypeName="vector";class au{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=hi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push($W(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(fr.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=qT(l);l=zv(l,1,u),c=zv(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new su(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,m,p){if(0!==f.length){const g=[],v=[];Vv(f,g,v,m),0!==g.length&&p.push(new d(h,g,v))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let m;for(m=0;m<h.length;m++)if(h[m].morphTargets)for(let p=0;p<h[m].morphTargets.length;p++)f[h[m].morphTargets[p]]=-1;for(const p in f){const g=[],v=[];for(let _=0;_!==h[m].morphTargets.length;++_){const y=h[m];g.push(y.time),v.push(y.morphTarget===p?1:0)}r.push(new su(".morphTargetInfluence["+p+"]",g,v))}l=f.length*o}else{const f=".bones["+t[d].name+"]";i(ou,f+".position",h,"pos",r),i(_o,f+".quaternion",h,"rot",r),i(ou,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function $W(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function jW(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return su;case"vector":case"vector2":case"vector3":case"vector4":return ou;case"color":return YT;case"quaternion":return _o;case"bool":case"boolean":return cl;case"string":return ul}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];Vv(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const dl={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class ZT{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],m=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return m}return null}}}const qW=new ZT;class lu{constructor(e){this.manager=void 0!==e?e:qW,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const jr={};class XW extends Error{constructor(e,t){super(e),this.response=t}}class pr extends lu{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=dl.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==jr[e])return void jr[e].push({onLoad:t,onProgress:i,onError:r});jr[e]=[],jr[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;const u=jr[e],d=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,m=0!==f;let p=0;const g=new ReadableStream({start(v){!function _(){d.read().then(({done:y,value:x})=>{if(y)v.close();else{p+=x.byteLength;const b=new ProgressEvent("progress",{lengthComputable:m,loaded:p,total:f});for(let M=0,A=u.length;M<A;M++){const w=u[M];w.onProgress&&w.onProgress(b)}v.enqueue(x),_()}})}()}});return new Response(g)}throw new XW(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(m=>f.decode(m))}}}).then(c=>{dl.add(e,c);const u=jr[e];delete jr[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=jr[e];if(void 0===u)throw this.manager.itemError(e),c;delete jr[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class yf extends lu{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=dl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=kc("img");function l(){u(),dl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class YW extends lu{constructor(e){super(e)}load(e,t,i,r){const s=new Wi,o=new yf(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class vf extends dn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ge(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const Hv=new Xe,KT=new D,JT=new D;class Gv{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new X(512,512),this.map=null,this.mapPass=null,this.matrix=new Xe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ev,this._frameExtents=new X(1,1),this._viewportCount=1,this._viewports=[new Dt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;KT.setFromMatrixPosition(e.matrixWorld),t.position.copy(KT),JT.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(JT),t.updateMatrixWorld(),Hv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hv),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Hv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class KW extends Gv{constructor(){super(new yn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=2*Oc*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class QT extends vf{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(dn.DEFAULT_UP),this.updateMatrix(),this.target=new dn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new KW}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const eA=new Xe,cu=new D,Wv=new D;class JW extends Gv{constructor(){super(new yn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new X(4,2),this._viewportCount=6,this._viewports=[new Dt(2,1,1,1),new Dt(0,1,1,1),new Dt(3,1,1,1),new Dt(1,1,1,1),new Dt(3,0,1,1),new Dt(1,0,1,1)],this._cubeDirections=[new D(1,0,0),new D(-1,0,0),new D(0,0,1),new D(0,0,-1),new D(0,1,0),new D(0,-1,0)],this._cubeUps=[new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,0,1),new D(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),cu.setFromMatrixPosition(e.matrixWorld),i.position.copy(cu),Wv.copy(i.position),Wv.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Wv),i.updateMatrixWorld(),r.makeTranslation(-cu.x,-cu.y,-cu.z),eA.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(eA)}}class hl extends vf{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new JW}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class QW extends Gv{constructor(){super(new Wh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class jv extends vf{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(dn.DEFAULT_UP),this.updateMatrix(),this.target=new dn,this.shadow=new QW}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class tA extends vf{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class uu{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class o8 extends lu{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=dl.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){dl.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const qv="\\[\\]\\.:\\/",d8=new RegExp("["+qv+"]","g"),Xv="[^"+qv+"]",h8="[^"+qv.replace("\\.","")+"]",y8=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Xv)+/(WCOD+)?/.source.replace("WCOD",h8)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Xv)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Xv)+"$"),v8=["material","materials","bones","map"];class _8{constructor(e,t,i){const r=i||Lt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Lt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(d8,"")}static parseTrackName(t){const i=y8.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==v8.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=_8,n})();Lt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Lt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Lt.prototype.GetterByBindingType=[Lt.prototype._getValue_direct,Lt.prototype._getValue_array,Lt.prototype._getValue_arrayElement,Lt.prototype._getValue_toArray],Lt.prototype.SetterByBindingTypeAndVersioning=[[Lt.prototype._setValue_direct,Lt.prototype._setValue_direct_setNeedsUpdate,Lt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_array,Lt.prototype._setValue_array_setNeedsUpdate,Lt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_arrayElement,Lt.prototype._setValue_arrayElement_setNeedsUpdate,Lt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Lt.prototype._setValue_fromArray,Lt.prototype._setValue_fromArray_setNeedsUpdate,Lt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class hA{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Zt(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}function MA(n,e){if(e===iH)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===Cy||e===dC){let t=n.getIndex();if(null===t){const o=[],a=n.getAttribute("position");if(void 0===a)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n;for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}const i=t.count-2,r=[];if(e===Cy)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:gy}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=gy);class C8 extends lu{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new P8(t)}),this.register(function(t){return new U8(t)}),this.register(function(t){return new z8(t)}),this.register(function(t){return new V8(t)}),this.register(function(t){return new N8(t)}),this.register(function(t){return new O8(t)}),this.register(function(t){return new F8(t)}),this.register(function(t){return new k8(t)}),this.register(function(t){return new R8(t)}),this.register(function(t){return new B8(t)}),this.register(function(t){return new L8(t)}),this.register(function(t){return new A8(t)}),this.register(function(t){return new H8(t)}),this.register(function(t){return new G8(t)})}load(e,t,i,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:uu.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new pr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===SA){try{o[ft.KHR_BINARY_GLTF]=new W8(e)}catch(d){return void(r&&r(d))}s=JSON.parse(o[ft.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new ij(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);a[d.name]=d,o[d.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const d=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(d){case ft.KHR_MATERIALS_UNLIT:o[d]=new I8;break;case ft.KHR_DRACO_MESH_COMPRESSION:o[d]=new j8(s,this.dracoLoader);break;case ft.KHR_TEXTURE_TRANSFORM:o[d]=new $8;break;case ft.KHR_MESH_QUANTIZATION:o[d]=new q8;break;default:h.indexOf(d)>=0&&void 0===a[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function T8(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const ft={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class A8{constructor(e){this.parser=e,this.name=ft.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new ge(16777215);void 0!==l.color&&u.fromArray(l.color);const d=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new jv(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new hl(u),c.distance=d;break;case"spot":c=new QT(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Ms(c,l),void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(i,r),r}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return i._getNodeRef(t.cache,a,l)})}}class I8{constructor(){this.name=ft.KHR_MATERIALS_UNLIT}getMaterialType(){return Ci}extendParams(e,t,i){const r=[];e.color=new ge(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(i.assignTexture(e,"map",s.baseColorTexture,St))}return Promise.all(r)}}class R8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class P8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?xs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new X(a,a)}return Promise.all(s)}}class L8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?xs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class N8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?xs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new ge(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,St)),void 0!==o.sheenRoughnessTexture&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class O8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?xs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class F8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?xs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new ge(a[0],a[1],a[2]),Promise.all(s)}}class k8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?xs:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class B8{constructor(e){this.parser=e,this.name=ft.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?xs:null}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new ge(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,St)),Promise.all(s)}}class U8{constructor(e){this.parser=e,this.name=ft.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class z8{constructor(e){this.parser=e,this.name=ft.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class V8{constructor(e){this.parser=e,this.name=ft.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class H8{constructor(e){this.name=ft.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const u=r.count,d=r.byteStride,h=new Uint8Array(a,r.byteOffset||0,r.byteLength||0);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,d,h,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*d);return o.decodeGltfBuffer(new Uint8Array(f),u,d,h,r.mode,r.filter),f})})}return null}}class G8{constructor(e){this.name=ft.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||void 0===i.mesh)return null;const r=t.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==Ii.TRIANGLES&&c.mode!==Ii.TRIANGLE_STRIP&&c.mode!==Ii.TRIANGLE_FAN&&void 0!==c.mode)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),d=u.isGroup?u.children:[u],h=c[0].count,f=[];for(const m of d){const p=new Xe,g=new D,v=new Sn,_=new D(1,1,1),y=new ST(m.geometry,m.material,h);for(let x=0;x<h;x++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,x),l.ROTATION&&v.fromBufferAttribute(l.ROTATION,x),l.SCALE&&_.fromBufferAttribute(l.SCALE,x),y.setMatrixAt(x,p.compose(g,v,_));for(const x in l)"TRANSLATION"!==x&&"ROTATION"!==x&&"SCALE"!==x&&m.geometry.setAttribute(x,l[x]);dn.prototype.copy.call(y,m),y.frustumCulled=!1,this.parser.assignFinalMaterial(y),f.push(y)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}}const SA="glTF";class W8{constructor(e){this.name=ft.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==SA)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,s=new DataView(e,12);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,1313821514===l){const c=new Uint8Array(e,12+o,a);this.content=i.decode(c)}else if(5130562===l){const c=12+o;this.body=e.slice(c,c+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class j8{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ft.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const d=e0[u]||u.toLowerCase();a[d]=o[u]}for(const u in e.attributes){const d=e0[u]||u.toLowerCase();if(void 0!==o[u]){const h=i.accessors[e.attributes[u]];c[d]=fl[h.componentType].name,l[d]=!0===h.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(d){r.decodeDracoFile(u,function(h){for(const f in h.attributes){const p=l[f];void 0!==p&&(h.attributes[f].normalized=p)}d(h)},a,c)})})}}class $8{constructor(){this.name=ft.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class q8{constructor(){this.name=ft.KHR_MESH_QUANTIZATION}}class DA extends ru{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=2*a,c=3*a,u=r-t,d=(i-t)/u,h=d*d,f=h*d,m=e*c,p=m-c,g=-2*f+3*h,v=f-h,_=1-g,y=v-h+d;for(let x=0;x!==a;x++)s[x]=_*o[p+x+a]+y*(o[p+x+l]*u)+g*o[m+x+a]+v*(o[m+x]*u);return s}}const X8=new Sn;class Y8 extends DA{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return X8.fromArray(s).normalize().toArray(s),s}}const Ii={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},fl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},CA={9728:Yt,9729:Ht,9984:wh,9985:_y,9986:Rc,9987:kr},TA={33071:Rn,33648:Ic,10497:Ks},Qv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},e0={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},bs={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Z8={CUBICSPLINE:void 0,LINEAR:Na,STEP:Lc};function hu(n,e,t){for(const i in t.extensions)void 0===n[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Ms(n,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Q8(n,e){if(n.updateMorphTargets(),void 0!==e.weights)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ej(n){const e=n.extensions&&n.extensions[ft.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+AA(e.attributes):n.indices+":"+AA(n.attributes)+":"+n.mode,t}function AA(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function n0(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const nj=new Xe;class ij{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new T8,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),this.textureLoader=typeof createImageBitmap>"u"||i||r&&s<98?new YW(this.options.manager):new o8(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new pr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};hu(s,a,r),Ms(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(i[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e)}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[ft.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(uu.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const s=t.byteOffset||0;return i.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse){const o=Qv[r.type],l=!0===r.normalized,c=new(0,fl[r.componentType])(r.count*o);return Promise.resolve(new Gt(c,o,l))}const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=Qv[r.type],c=fl[r.componentType],u=c.BYTES_PER_ELEMENT,h=r.byteOffset||0,f=void 0!==r.bufferView?i.bufferViews[r.bufferView].byteStride:void 0,m=!0===r.normalized;let p,g;if(f&&f!==u*l){const v=Math.floor(h/f),_="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+v+":"+r.count;let y=t.cache.get(_);y||(p=new c(a,v*f,r.count*f/u),y=new uv(p,f/u),t.cache.add(_,y)),g=new po(y,l,h%f/u,m)}else p=null===a?new c(r.count*l):new c(a,h,r.count*l),g=new Gt(p,l,m);if(void 0!==r.sparse){const x=r.sparse.values.byteOffset||0,b=new(0,fl[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*Qv.SCALAR),M=new c(o[2],x,r.sparse.count*l);null!==a&&(g=new Gt(g.array.slice(),g.itemSize,g.normalized));for(let A=0,w=b.length;A<w;A++){const S=b[A];if(g.setX(S,M[A*l]),l>=2&&g.setY(S,M[A*l+1]),l>=3&&g.setZ(S,M[A*l+2]),l>=4&&g.setW(S,M[A*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"";const h=(s.samplers||{})[o.sampler]||{};return u.magFilter=CA[h.magFilter]||Ht,u.minFilter=CA[h.minFilter]||kr,u.wrapS=TA[h.wrapS]||Ks,u.wrapT=TA[h.wrapT]||Ks,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(d=>d.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(d){c=!0;const h=new Blob([d],{type:o.mimeType});return l=a.createObjectURL(h),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(h,f){let m=h;!0===t.isImageBitmapLoader&&(m=function(p){const g=new Wi(p);g.needsUpdate=!0,h(g)}),t.load(uu.resolveURL(d,s.path),m,void 0,f)})}).then(function(d){return!0===c&&a.revokeObjectURL(l),d.userData.mimeType=o.mimeType||function tj(n){return n.search(/\.jpe?g($|\?)/i)>0||0===n.search(/^data\:image\/jpeg/)?"image/jpeg":n.search(/\.webp($|\?)/i)>0||0===n.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(void 0!==i.texCoord&&0!=i.texCoord&&!("aoMap"===t&&1==i.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),s.extensions[ft.KHR_TEXTURE_TRANSFORM]){const a=void 0!==i.extensions?i.extensions[ft.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[ft.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new mv,Xi.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new ei,Xi.prototype.copy.call(l,i),l.color.copy(i.color),this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return gf}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},c=[];if((s.extensions||{})[ft.KHR_MATERIALS_UNLIT]){const d=r[ft.KHR_MATERIALS_UNLIT];o=d.getMaterialType(),c.push(d.extendParams(a,s,t))}else{const d=s.pbrMetallicRoughness||{};if(a.color=new ge(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){const h=d.baseColorFactor;a.color.fromArray(h),a.opacity=h[3]}void 0!==d.baseColorTexture&&c.push(t.assignTexture(a,"map",d.baseColorTexture,St)),a.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,a.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),o=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=Or);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Ci&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new X(1,1),void 0!==s.normalTexture.scale)){const d=s.normalTexture.scale;a.normalScale.set(d,d)}return void 0!==s.occlusionTexture&&o!==Ci&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Ci&&(a.emissive=(new ge).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==Ci&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,St)),Promise.all(c).then(function(){const d=new o(a);return s.name&&(d.name=s.name),Ms(d,s),t.associations.set(d,{materials:e}),s.extensions&&hu(r,d,s),d})}createUniqueName(e){const t=Lt.sanitizeNodeName(e||"");let i=t;for(let r=1;this.nodeNamesUsed[i];++r)i=t+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[ft.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return IA(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=ej(c),d=r[u];if(d)o.push(d.promise);else{let h;h=c.extensions&&c.extensions[ft.KHR_DRACO_MESH_COMPRESSION]?s(c):IA(new st,c,t),r[u]={primitive:c,promise:h},o.push(h)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(n=this.cache).DefaultMaterial&&(n.DefaultMaterial=new gf({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Nr})),n.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var n;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let f=0,m=u.length;f<m;f++){const p=u[f],g=o[f];let v;const _=c[f];if(g.mode===Ii.TRIANGLES||g.mode===Ii.TRIANGLE_STRIP||g.mode===Ii.TRIANGLE_FAN||void 0===g.mode)v=!0===s.isSkinnedMesh?new xT(p,_):new On(p,_),!0===v.isSkinnedMesh&&v.normalizeSkinWeights(),g.mode===Ii.TRIANGLE_STRIP?v.geometry=MA(v.geometry,dC):g.mode===Ii.TRIANGLE_FAN&&(v.geometry=MA(v.geometry,Cy));else if(g.mode===Ii.LINES)v=new pv(p,_);else if(g.mode===Ii.LINE_STRIP)v=new mo(p,_);else if(g.mode===Ii.LINE_LOOP)v=new IT(p,_);else{if(g.mode!==Ii.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);v=new PT(p,_)}Object.keys(v.geometry.morphAttributes).length>0&&Q8(v,s),v.name=t.createUniqueName(s.name||"mesh_"+e),Ms(v,s),g.extensions&&hu(r,v,g),t.assignFinalMaterial(v),d.push(v)}for(let f=0,m=d.length;f<m;f++)t.associations.set(d[f],{meshes:e,primitives:f});if(1===d.length)return d[0];const h=new _s;t.associations.set(h,{meshes:e});for(let f=0,m=d.length;f<m;f++)h.add(d[f]);return h})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(r)return"perspective"===i.type?t=new yn(wH_radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===i.type&&(t=new Wh(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Ms(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return i.push(void 0!==t.inverseBindMatrices?this.getDependency("accessor",t.inverseBindMatrices):null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const d=o[c];if(d){a.push(d);const h=new Xe;null!==s&&h.fromArray(s.array,16*c),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new Jh(a,l)})}loadAnimation(e){const i=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,u=i.channels.length;c<u;c++){const d=i.channels[c],h=i.samplers[d.sampler],f=d.target,p=void 0!==i.parameters?i.parameters[h.input]:h.input,g=void 0!==i.parameters?i.parameters[h.output]:h.output;r.push(this.getDependency("node",f.node)),s.push(this.getDependency("accessor",p)),o.push(this.getDependency("accessor",g)),a.push(h),l.push(f)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],h=c[2],f=c[3],m=c[4],p=[];for(let v=0,_=u.length;v<_;v++){const y=u[v],x=d[v],b=h[v],M=f[v],A=m[v];if(void 0===y)continue;let w;switch(y.updateMatrix(),bs[A.path]){case bs.weights:w=su;break;case bs.rotation:w=_o;break;default:w=ou}const S=y.name?y.name:y.uuid,R=void 0!==M.interpolation?Z8[M.interpolation]:Na,O=[];bs[A.path]===bs.weights?y.traverse(function(N){N.morphTargetInfluences&&O.push(N.name?N.name:N.uuid)}):O.push(S);let H=b.array;if(b.normalized){const N=n0(H.constructor),P=new Float32Array(H.length);for(let z=0,Y=H.length;z<Y;z++)P[z]=H[z]*N;H=P}for(let N=0,P=O.length;N<P;N++){const z=new w(O[N]+"."+bs[A.path],x.array,H,R);"CUBICSPLINE"===M.interpolation&&(z.createInterpolant=function(ne){return new(this instanceof _o?Y8:DA)(this.times,this.values,this.getValueSize()/3,ne)},z.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),p.push(z)}}return new au(i.name?i.name:"animation_"+e,void 0,p)})}createNodeMesh(e){const i=this,r=this.json.nodes[e];return void 0===r.mesh?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const i=this,r=this.json.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,u=a.length;c<u;c++)o.push(i.getDependency("node",a[c]));const l=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],d=c[1],h=c[2];null!==h&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(h,nj)});for(let f=0,m=d.length;f<m;f++)u.add(d[f]);return u})}_loadNodeShallow(e){const i=this.extensions,r=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(u=!0===s.isBone?new hv:c.length>1?new _s:1===c.length?c[0]:new dn,u!==c[0])for(let d=0,h=c.length;d<h;d++)u.add(c[d]);if(s.name&&(u.userData.name=s.name,u.name=o),Ms(u,s),s.extensions&&hu(i,u,s),void 0!==s.matrix){const d=new Xe;d.fromArray(s.matrix),u.applyMatrix4(d)}else void 0!==s.translation&&u.position.fromArray(s.translation),void 0!==s.rotation&&u.quaternion.fromArray(s.rotation),void 0!==s.scale&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new _s;i.name&&(s.name=r.createUniqueName(i.name)),Ms(s,i),i.extensions&&hu(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,d=l.length;u<d;u++)s.add(l[u]);return r.associations=(u=>{const d=new Map;for(const[h,f]of r.associations)(h instanceof Xi||h instanceof Wi)&&d.set(h,f);return u.traverse(h=>{const f=r.associations.get(h);null!=f&&d.set(h,f)}),d})(s),s})}}function IA(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=e0[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(void 0!==e.indices&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return Ms(n,e),function rj(n,e,t){const i=e.attributes,r=new fs;if(void 0===i.POSITION)return;{const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new D(l[0],l[1],l[2]),new D(c[0],c[1],c[2])),a.normalized){const u=n0(fl[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new D,l=new D;for(let c=0,u=s.length;c<u;c++){const d=s[c];if(void 0!==d.POSITION){const h=t.json.accessors[d.POSITION],f=h.min,m=h.max;if(void 0!==f&&void 0!==m){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(m[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(m[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(m[2]))),h.normalized){const p=n0(fl[h.componentType]);l.multiplyScalar(p)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new co;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}(n,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function J8(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(void 0!==d.POSITION&&(i=!0),void 0!==d.NORMAL&&(r=!0),void 0!==d.COLOR_0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(i){const h=void 0!==d.POSITION?t.getDependency("accessor",d.POSITION):n.attributes.position;o.push(h)}if(r){const h=void 0!==d.NORMAL?t.getDependency("accessor",d.NORMAL):n.attributes.normal;a.push(h)}if(s){const h=void 0!==d.COLOR_0?t.getDependency("accessor",d.COLOR_0):n.attributes.color;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const d=c[1],h=c[2];return i&&(n.morphAttributes.position=c[0]),r&&(n.morphAttributes.normal=d),s&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}(n,e.targets,t):n})}const RA={type:"change"},r0={type:"start"},PA={type:"end"};class sj extends io{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new D,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ta.ROTATE,MIDDLE:Ta.DOLLY,RIGHT:Ta.PAN},this.touches={ONE:Aa.ROTATE,TWO:Aa.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(I){I.addEventListener("keydown",yt),this._domElementKeyEvents=I},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",yt),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(RA),i.update(),s=r.NONE},this.update=function(){const I=new D,F=(new Sn).setFromUnitVectors(e.up,new D(0,1,0)),we=F.clone().invert(),pe=new D,Ie=new Sn,Le=2*Math.PI;return function(){const ut=i.object.position;I.copy(ut).sub(i.target),I.applyQuaternion(F),a.setFromVector3(I),i.autoRotate&&s===r.NONE&&S(function A(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let vt=i.minAzimuthAngle,Ct=i.maxAzimuthAngle;return isFinite(vt)&&isFinite(Ct)&&(vt<-Math.PI?vt+=Le:vt>Math.PI&&(vt-=Le),Ct<-Math.PI?Ct+=Le:Ct>Math.PI&&(Ct-=Le),a.theta=vt<=Ct?Math.max(vt,Math.min(Ct,a.theta)):a.theta>(vt+Ct)/2?Math.max(vt,a.theta):Math.min(Ct,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),I.setFromSpherical(a),I.applyQuaternion(we),ut.copy(i.target).add(I),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(d||pe.distanceToSquared(i.object.position)>o||8*(1-Ie.dot(i.object.quaternion))>o)&&(i.dispatchEvent(RA),pe.copy(i.object.position),Ie.copy(i.object.quaternion),d=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",G),i.domElement.removeEventListener("pointerdown",ce),i.domElement.removeEventListener("pointercancel",$e),i.domElement.removeEventListener("wheel",Et),i.domElement.removeEventListener("pointermove",Ce),i.domElement.removeEventListener("pointerup",fe),null!==i._domElementKeyEvents&&(i._domElementKeyEvents.removeEventListener("keydown",yt),i._domElementKeyEvents=null)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new hA,l=new hA;let c=1;const u=new D;let d=!1;const h=new X,f=new X,m=new X,p=new X,g=new X,v=new X,_=new X,y=new X,x=new X,b=[],M={};function w(){return Math.pow(.95,i.zoomSpeed)}function S(I){l.theta-=I}function R(I){l.phi-=I}const O=function(){const I=new D;return function(we,pe){I.setFromMatrixColumn(pe,0),I.multiplyScalar(-we),u.add(I)}}(),H=function(){const I=new D;return function(we,pe){!0===i.screenSpacePanning?I.setFromMatrixColumn(pe,1):(I.setFromMatrixColumn(pe,0),I.crossVectors(i.object.up,I)),I.multiplyScalar(we),u.add(I)}}(),N=function(){const I=new D;return function(we,pe){const Ie=i.domElement;if(i.object.isPerspectiveCamera){I.copy(i.object.position).sub(i.target);let Pe=I.length();Pe*=Math.tan(i.object.fov/2*Math.PI/180),O(2*we*Pe/Ie.clientHeight,i.object.matrix),H(2*pe*Pe/Ie.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(O(we*(i.object.right-i.object.left)/i.object.zoom/Ie.clientWidth,i.object.matrix),H(pe*(i.object.top-i.object.bottom)/i.object.zoom/Ie.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function P(I){i.object.isPerspectiveCamera?c/=I:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*I)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function z(I){i.object.isPerspectiveCamera?c*=I:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/I)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Y(I){h.set(I.clientX,I.clientY)}function j(I){p.set(I.clientX,I.clientY)}function oe(){1===b.length?h.set(b[0].pageX,b[0].pageY):h.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function k(){1===b.length?p.set(b[0].pageX,b[0].pageY):p.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function he(){const I=b[0].pageX-b[1].pageX,F=b[0].pageY-b[1].pageY,we=Math.sqrt(I*I+F*F);_.set(0,we)}function Ee(I){if(1==b.length)f.set(I.pageX,I.pageY);else{const we=Re(I);f.set(.5*(I.pageX+we.x),.5*(I.pageY+we.y))}m.subVectors(f,h).multiplyScalar(i.rotateSpeed);const F=i.domElement;S(2*Math.PI*m.x/F.clientHeight),R(2*Math.PI*m.y/F.clientHeight),h.copy(f)}function Me(I){if(1===b.length)g.set(I.pageX,I.pageY);else{const F=Re(I);g.set(.5*(I.pageX+F.x),.5*(I.pageY+F.y))}v.subVectors(g,p).multiplyScalar(i.panSpeed),N(v.x,v.y),p.copy(g)}function Ne(I){const F=Re(I),we=I.pageX-F.x,pe=I.pageY-F.y,Ie=Math.sqrt(we*we+pe*pe);y.set(0,Ie),x.set(0,Math.pow(y.y/_.y,i.zoomSpeed)),P(x.y),_.copy(y)}function ce(I){!1!==i.enabled&&(0===b.length&&(i.domElement.setPointerCapture(I.pointerId),i.domElement.addEventListener("pointermove",Ce),i.domElement.addEventListener("pointerup",fe)),function ae(I){b.push(I)}(I),"touch"===I.pointerType?function T(I){switch(ye(I),b.length){case 1:switch(i.touches.ONE){case Aa.ROTATE:if(!1===i.enableRotate)return;oe(),s=r.TOUCH_ROTATE;break;case Aa.PAN:if(!1===i.enablePan)return;k(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case Aa.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function me(){i.enableZoom&&he(),i.enablePan&&k()})(),s=r.TOUCH_DOLLY_PAN;break;case Aa.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function xe(){i.enableZoom&&he(),i.enableRotate&&oe()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(r0)}(I):function Oe(I){let F;switch(I.button){case 0:F=i.mouseButtons.LEFT;break;case 1:F=i.mouseButtons.MIDDLE;break;case 2:F=i.mouseButtons.RIGHT;break;default:F=-1}switch(F){case Ta.DOLLY:if(!1===i.enableZoom)return;(function ne(I){_.set(I.clientX,I.clientY)})(I),s=r.DOLLY;break;case Ta.ROTATE:if(I.ctrlKey||I.metaKey||I.shiftKey){if(!1===i.enablePan)return;j(I),s=r.PAN}else{if(!1===i.enableRotate)return;Y(I),s=r.ROTATE}break;case Ta.PAN:if(I.ctrlKey||I.metaKey||I.shiftKey){if(!1===i.enableRotate)return;Y(I),s=r.ROTATE}else{if(!1===i.enablePan)return;j(I),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(r0)}(I))}function Ce(I){!1!==i.enabled&&("touch"===I.pointerType?function E(I){switch(ye(I),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Ee(I),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;Me(I),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Z(I){i.enableZoom&&Ne(I),i.enablePan&&Me(I)})(I),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ee(I){i.enableZoom&&Ne(I),i.enableRotate&&Ee(I)})(I),i.update();break;default:s=r.NONE}}(I):function qe(I){switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function J(I){f.set(I.clientX,I.clientY),m.subVectors(f,h).multiplyScalar(i.rotateSpeed);const F=i.domElement;S(2*Math.PI*m.x/F.clientHeight),R(2*Math.PI*m.y/F.clientHeight),h.copy(f),i.update()}(I);break;case r.DOLLY:if(!1===i.enableZoom)return;!function te(I){y.set(I.clientX,I.clientY),x.subVectors(y,_),x.y>0?P(w()):x.y<0&&z(w()),_.copy(y),i.update()}(I);break;case r.PAN:if(!1===i.enablePan)return;!function _e(I){g.set(I.clientX,I.clientY),v.subVectors(g,p).multiplyScalar(i.panSpeed),N(v.x,v.y),p.copy(g),i.update()}(I)}}(I))}function fe(I){le(I),0===b.length&&(i.domElement.releasePointerCapture(I.pointerId),i.domElement.removeEventListener("pointermove",Ce),i.domElement.removeEventListener("pointerup",fe)),i.dispatchEvent(PA),s=r.NONE}function $e(I){le(I)}function Et(I){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(I.preventDefault(),i.dispatchEvent(r0),function V(I){I.deltaY<0?z(w()):I.deltaY>0&&P(w()),i.update()}(I),i.dispatchEvent(PA))}function yt(I){!1===i.enabled||!1===i.enablePan||function Q(I){let F=!1;switch(I.code){case i.keys.UP:I.ctrlKey||I.metaKey||I.shiftKey?R(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(0,i.keyPanSpeed),F=!0;break;case i.keys.BOTTOM:I.ctrlKey||I.metaKey||I.shiftKey?R(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(0,-i.keyPanSpeed),F=!0;break;case i.keys.LEFT:I.ctrlKey||I.metaKey||I.shiftKey?S(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(i.keyPanSpeed,0),F=!0;break;case i.keys.RIGHT:I.ctrlKey||I.metaKey||I.shiftKey?S(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):N(-i.keyPanSpeed,0),F=!0}F&&(I.preventDefault(),i.update())}(I)}function G(I){!1!==i.enabled&&I.preventDefault()}function le(I){delete M[I.pointerId];for(let F=0;F<b.length;F++)if(b[F].pointerId==I.pointerId)return void b.splice(F,1)}function ye(I){let F=M[I.pointerId];void 0===F&&(F=new X,M[I.pointerId]=F),F.set(I.pageX,I.pageY)}function Re(I){return M[(I.pointerId===b[0].pointerId?b[1]:b[0]).pointerId]}i.domElement.addEventListener("contextmenu",G),i.domElement.addEventListener("pointerdown",ce),i.domElement.addEventListener("pointercancel",$e),i.domElement.addEventListener("wheel",Et,{passive:!1}),this.update()}}class oj extends dn{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&null!==t.element.parentNode&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const pl=new D,LA=new Xe,NA=new Xe,OA=new D,FA=new D;class aj{constructor(e={}){const t=this;let i,r,s,o;const a={objects:new WeakMap},l=void 0!==e.element?e.element:document.createElement("div");function c(f,m,p){if(f.isCSS2DObject){pl.setFromMatrixPosition(f.matrixWorld),pl.applyMatrix4(NA);const g=!0===f.visible&&pl.z>=-1&&pl.z<=1&&!0===f.layers.test(p.layers);if(f.element.style.display=!0===g?"":"none",!0===g){f.onBeforeRender(t,m,p);const _=f.element;_.style.transform="translate(-50%,-50%) translate("+(pl.x*s+s)+"px,"+(-pl.y*o+o)+"px)",_.parentNode!==l&&l.appendChild(_),f.onAfterRender(t,m,p)}const v={distanceToCameraSquared:u(p,f)};a.objects.set(f,v)}for(let g=0,v=f.children.length;g<v;g++)c(f.children[g],m,p)}function u(f,m){return OA.setFromMatrixPosition(f.matrixWorld),FA.setFromMatrixPosition(m.matrixWorld),OA.distanceToSquared(FA)}l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:i,height:r}},this.render=function(f,m){!0===f.matrixWorldAutoUpdate&&f.updateMatrixWorld(),null===m.parent&&!0===m.matrixWorldAutoUpdate&&m.updateMatrixWorld(),LA.copy(m.matrixWorldInverse),NA.multiplyMatrices(m.projectionMatrix,LA),c(f,f,m),function h(f){const m=function d(f){const m=[];return f.traverse(function(p){p.isCSS2DObject&&m.push(p)}),m}(f).sort(function(g,v){return g.renderOrder!==v.renderOrder?v.renderOrder-g.renderOrder:a.objects.get(g).distanceToCameraSquared-a.objects.get(v).distanceToCameraSquared}),p=m.length;for(let g=0,v=m.length;g<v;g++)m[g].element.style.zIndex=p-g}(f)},this.setSize=function(f,m){i=f,r=m,s=i/2,o=r/2,l.style.width=f+"px",l.style.height=m+"px"}}}class lj extends ti{constructor(e,t){super()}schedule(e,t=0){return this}}const Df={setInterval(n,e,...t){const{delegate:i}=Df;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=Df;return(e?.clearInterval||clearInterval)(n)},delegate:void 0},kA={now:()=>(kA.delegate||Date).now(),delegate:void 0};class fu{constructor(e,t=fu.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}fu.now=kA.now;const BA=new class uj extends fu{constructor(e,t=fu.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class cj extends lj{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return Df.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&Df.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,To(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),dj=BA;const mj=["canvas"],gj=["container"];class pu{get canvas(){return this.canvasRef.nativeElement}animateModel(){this.model&&(this.model.rotation.z+=.005)}createScene(){this.scene=new uT,this.scene.background=new ge(13948120),this.loaderGLTF.load("assets/washing-machine/scene.gltf",t=>{this.model=t.scene.children[0],console.log(this.model),this.model.scale.set(.08,.08,.08),(new fs).setFromObject(this.model).getCenter(this.model.position),this.model.position.multiplyScalar(-1),this.scene.add(this.model),this.addLabels()});let e=this.getAspectRatio();this.camera=new yn(this.fieldOfView,e,this.nearClippingPane,this.farClippingPane),this.camera.position.x=115,this.camera.position.y=115,this.camera.position.z=115,this.ambientLight=new tA(16777190,.4),this.scene.add(this.ambientLight),this.directionalLight=new jv(16777190,.3),this.directionalLight.position.set(0,1,0),this.directionalLight.castShadow=!0,this.scene.add(this.directionalLight),this.light1=new hl(16777190,.3),this.light1.position.set(0,200,400),this.scene.add(this.light1),this.light2=new hl(16777190,.3),this.light2.position.set(500,100,0),this.scene.add(this.light2),this.light3=new hl(16777190,.3),this.light3.position.set(0,100,-500),this.scene.add(this.light3),this.light4=new hl(16777190,.3),this.light4.position.set(-500,300,500),this.scene.add(this.light4)}addLabels(){this.labels.forEach(e=>{const t=document.createElement("div");t.className="label",t.textContent=`${e.code}`,t.addEventListener("pointerdown",()=>{this.showInfo(e.code)});const i=new oj(t);i.position.set(e.x,e.y,e.z),this.scene.add(i)})}getAspectRatio(){return this.canvas.clientWidth/this.canvas.clientHeight}startRenderingLoop(){this.renderer=new av({canvas:this.canvas,antialias:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight);let e=this;!function t(){requestAnimationFrame(t),e.renderer.render(e.scene,e.camera),e.labelRenderer.render(e.scene,e.camera)}()}constructor(e){this.interactionService=e,this.labels=[{x:.6,y:.7,z:.4,code:1},{x:.6,y:.7,z:-.5,code:3},{x:.6,y:.7,z:0,code:2},{x:-.6,y:.7,z:.4,code:4},{x:.6,y:0,z:0,code:5}],this.fieldOfView=1,this.nearClippingPane=1,this.farClippingPane=1e3,this.loaderGLTF=new C8,this.createControls=()=>{this.labelRenderer=new aj,this.labelRenderer.setSize(this.containerRef.nativeElement.offsetWidth,this.containerRef.nativeElement.offsetHeight),this.labelRenderer.domElement.style.position="absolute",this.labelRenderer.domElement.style.top="0px",this.containerRef.nativeElement.appendChild(this.labelRenderer.domElement),this.controls=new sj(this.camera,this.labelRenderer.domElement),this.controls.autoRotate=!0,this.controls.enableZoom=!0,this.controls.enablePan=!1,this.controls.update()},this.testText=100}ngOnInit(){(function pj(n=0,e=BA){return n<0&&(n=0),function fj(n=0,e,t=dj){let i=-1;return null!=e&&(R0(e)?t=e:i=e),new Qt(r=>{let s=function hj(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,n,e)})(1e3).subscribe(()=>{this.testText+=10})}ngAfterViewInit(){this.annotation=document.querySelector(".annotation"),this.createScene(),this.createControls(),this.startRenderingLoop()}showInfo(e){this.interactionService.setInfo(e)}}function yj(n,e){1&n&&(Ae(0,"div",9)(1,"div",4)(2,"h5",10),se(3,"Eco Connection"),ie(),Ae(4,"p",11),se(5," Having access to sustainable and economical hot springs can save energy by connecting your machine directly to the water source. Ideal for district heating, heat pumps and solar panels. "),ie()()())}function vj(n,e){1&n&&(Ae(0,"div",9)(1,"div",4)(2,"h5",10),se(3,"Full color display"),ie(),Ae(4,"p",11),se(5," The TFT color display guides you in making the right choices with every wash. The display, as well as the rest of the machine, has low energy consumption. "),ie()()())}function _j(n,e){1&n&&(Ae(0,"div",9)(1,"div",4)(2,"h5",10),se(3,"Dose Assist"),ie(),Ae(4,"p",11),se(5," It recommends right amount of detergent by calculating the weight "),ie()()())}function xj(n,e){1&n&&(Ae(0,"div",9)(1,"div",4)(2,"h5",10),se(3,"General characteristics"),ie(),Ae(4,"ul",12)(5,"li",13)(6,"b"),se(7,"Steel Seal TM:"),ie(),se(8," No rubber makes the washing more hygienic. "),ie(),Ae(9,"li",13),se(10," 31 cm door makes the loading and unloading easier "),ie(),Ae(11,"li",13),se(12," Stainless steel Outer drum and Steel base. "),ie(),Ae(13,"li",13),se(14,"4 Shock Absorbers"),ie(),Ae(15,"li",13),se(16,"Longer life span"),ie(),Ae(17,"li",13),se(18,"Minimal vibrations"),ie(),Ae(19,"li",13),se(20,"Higher speed spin"),ie(),Ae(21,"li",13),se(22," Rotating drum prevents water from soaking the clothes. Water is heated and steam is created. "),ie(),Ae(23,"li",13),se(24," Automatic Soap Dosing, large detergent tanks 2x 1.5 liters (benefits: environment, money, fabric, excellent results at all temperatures) "),ie(),Ae(25,"li",13)(26,"b"),se(27,"Brushless Motor:"),ie(),se(28," We have equipped our washing machines with extra reliable and quiet brushless motors. No brushes means one less part that can break. It makes the engine quieter and more durable. "),ie(),Ae(29,"li",13)(30,"b"),se(31,"Sustainable:"),ie(),se(32," Most manufacturers stabilize their washing machines with concrete. We strengthen and stabilize our washing machines with robust cast iron counterweights at the front and a cast iron bearing cross at the rear. An ASKO is therefore stronger, more stable and more durable. "),ie(),Ae(33,"li",13)(34,"b"),se(35,"Quick Mode:"),ie(),se(36," When selecting the speed mode, set the washing machine to achieve a perfect washing and rinsing result in less time than usual. To achieve this, both more water is added to the washing cycle and more energy is consumed. "),ie(),Ae(37,"li",13)(38,"b"),se(39,"Night mode:"),ie(),se(40," Use night mode when you want to make the washing machine quieter. Drum movements are more cautious and final centrifugation occurs at a lower rev. Extra time is added to ensure the load is washed perfectly. "),ie(),Ae(41,"li",13)(42,"b"),se(43,"Removable Washer:"),ie(),se(44," Keeping your devices in good condition should be easy. All ASKO washing machines have easily removable drum ribs to ensure nothing gets stuck. Simple. "),ie(),Ae(45,"li",13)(46,"b"),se(47,"Childproof lock:"),ie(),se(48," Keeps your children safe: Lock the control panel so that the washing machine does not accidentally start. "),ie(),Ae(49,"li",13)(50,"b"),se(51,"Load LightTM:"),ie(),se(52," Load LightTM illuminates the inside of the drum for easy loading and unloading. For example, a leftover sock is not overlooked. Load LightTM is integrated into the door hinge and is designed to last the entire life of the machine "),ie(),Ae(53,"li",13)(54,"b"),se(55,"Sensi SaveTM:"),ie(),se(56," The Sensi SaveTM function reduces the carbon footprint by calculating how much water and energy each charge needs. The optimized washing program also saves your precious time. Meaningful, right? "),ie()()()())}function wj(n,e){1&n&&(Ae(0,"div",9)(1,"div",4)(2,"h5",10),se(3,"Programs"),ie(),Ae(4,"ul",12)(5,"li",13)(6,"b"),se(7,"Hygiene:"),ie(),se(8," The hygiene program is designed for all situations where a thorough hygienic wash is necessary. It is perfect for home cooks looking to clean their aprons, tea towels and other textiles that come into contact with raw food. It is also suitable for washing baby clothes, bedding and clothing used by people with skin allergies. In the latter case, we recommend turning the garments inside out, as this will also thoroughly wash out any skin residue or residues of skin products. The program is characterized by longer heating sequences in combination with additional flushes. "),ie(),Ae(9,"li",13)(10,"b"),se(11,"Pro:"),ie(),se(12," This is a fast program, but with a high washing efficiency. The program washes with gentle drum movements and lower spin speed and lasts just under an hour. "),ie(),Ae(13,"li",13)(14,"b"),se(15,"Super Rinse TM:"),ie(),se(16," Dirt is not good for your clothes, but detergents are not good for your skin. As a preventive measure for people with very sensitive skin, ASKO washing machines have an additional flushing function: Super Rinse. This feature is particularly important in soft water countries and involves flushing the machine up to seven times. "),ie(),Ae(17,"li",13)(18,"b"),se(19,"Allergy fashion:"),ie(),se(20," In this mode, additional water is added to rinse all detergent residues from the laundry and detergent compartment. More water is used in Allergy Mode and energy and time is also added to achieve optimal washing and rinsing result. The selected temperature is kept at the same level for an extended period of time. "),ie(),Ae(21,"li",13)(22,"b"),se(23,"Washing Program:"),ie(),se(24," With the Anti-wrinkle option, the laundry is washed quietly and centrifuges with fewer creases as a result. Be careful with your clothes and save time ironing "),ie(),Ae(25,"li",13)(26,"b"),se(27,"Aqua Safe:"),ie(),se(28," Nobody wants water damage at home. Even the smallest leakage that goes unnoticed can cause major problems. That's why we have the Aqua SafeTM system. An advanced water protection with solid constructions such as a PEX hose and a seamlessly welded container. But also smart systems such as a bottom sensor, overflow protection and water leak detection. Steel SealTM - Door Seal Without Rubber Door Cuff Stainless Steel Inner and Outer Drum Overflow Protection Anti BlockTM Bottom Sensor PEX Supply Hose Maximum Water Inflow Duration "),ie(),Ae(29,"li",13)(30,"b"),se(31,"Auto Program:"),ie(),se(32," The automatic program optimizes washing time and the number of rinses depending on the load and program you choose. Now you can turn a small laundry without feeling guilty. "),ie(),Ae(33,"li",13)(34,"b"),se(35,"Bedding Program:"),ie(),se(36," A weekly wash for your bedding removes skin debris and mites that cause allergies. This program is intended to wash bedding, pillows and other larger items. Follow the instructions for washing and care. The program adds a large amount of water and additional rinse. "),ie(),Ae(37,"li",13)(38,"b"),se(39,"Treat:"),ie(),se(40," This is a short program for adding water repellents to substances. The program uses only cold water and a gentle washing mechanism. For use with a water repellent. "),ie(),Ae(41,"li",13)(42,"b"),se(43,"Dark Wax:"),ie(),se(44," Developed for dark wax, this program prevents detergents from leaving stains on the fabric. Additional rinses are added, and at the same time a gentle washing mechanism and low revs ensure that your dark laundry is gently washed and rinsed thoroughly. "),ie(),Ae(45,"li",13)(46,"b"),se(47,"Drum Cleaning:"),ie(),se(48," If the drum cleaning program is used regularly, this will extend the freshness of your laundry and the life of your washing machine. One button, two advantages. "),ie(),Ae(49,"li",13)(50,"b"),se(51,"Universal Program:"),ie(),se(52," The Universal Washing Program takes care of your daily laundry by automatically adjusting the water level and duration to the load. Because every day should be the best day for your laundry. "),ie(),Ae(53,"li",13)(54,"b"),se(55,"Green Fashion:"),ie(),se(56," In order to achieve the best washing and rinsing result, while reducing water and energy consumption, each stage of the washing program is extended. The total program time is therefore longer compared to normal mode "),ie(),Ae(57,"li",13)(58,"b"),se(59,"Intensive Program:"),ie(),se(60," The Intensive program ensures that your heavily soiled laundry is clean quickly again. The program time and amount of water are set depending on the amount of laundry. An extra rinse removes the dissolved dirt, clean in no time! "),ie(),Ae(61,"li",13)(62,"b"),se(63,"Intensive:"),ie(),se(64," In this mode, the washing machine uses more time to wash the load than in normal mode. And to really ensure a perfect result for highly contaminated clothing, more water and energy is also used. In intensive mode, the selected temperature is maintained at the same level for an extended period of time. "),ie(),Ae(65,"li",13)(66,"b"),se(67,"Mixed/Synt Syntetic wash program:"),ie(),se(68," This program for sensitive mixed fiber clothing and for easy cotton care is faster than the Daily and Cotton washing program. The highest spin speed is 1200 rpm, which you can lower as desired. "),ie(),Ae(69,"li",13)(70,"b"),se(71,"Quick Program:"),ie(),se(72," Quick program for lightly soiled laundry. The program works at certain temperature, so take into account the directions on the clothes. A lower temperature shortens the duration of the program. You can choose the spin speed yourself. "),ie(),Ae(73,"li",13)(74,"b"),se(75,"Flush Program:"),ie(),se(76," Use the rinse program to refresh your favorite garment. A thorough rinse and a short centrifuge and your clothes are like new again. "),ie(),Ae(77,"li",13)(78,"b"),se(79,"Shirts:"),ie(),se(80," Have you also experienced that it is difficult to clean collars and cuffs from shirts? Then try the shirt program. It is a gentle but effective program that uses more water and repeated rinses to clean even the thicker parts of the shirt properly. "),ie(),Ae(81,"li",13)(82,"b"),se(83,"Spin-Dry:"),ie(),se(84," Choose this program if you just want to spin "),ie(),Ae(85,"li",13)(86,"b"),se(87,"Sportswear:"),ie(),se(88," A program for clothing with membranes, such as water-repellent clothing and breathable fabrics. This program is also ideal for sportswear made from mixed materials. The program is short and uses fewer rinses to reduce wear on water repellents. "),ie(),Ae(89,"li",13)(90,"b"),se(91,"Stains Program:"),ie(),se(92," Special stains program. Choose the type of stain and the washing program will ensure the right result. "),ie(),Ae(93,"li",13)(94,"b"),se(95,"Cotton:"),ie(),se(96," The Cotton program is the best program washing cotton. Tailored for waxes with visible stains for plain or heavily soiled laundry, white or fur. The program will adjust the duration and water consumption according to the load. "),ie(),Ae(97,"li",13)(98,"b"),se(99,"Time Program:"),ie(),se(100," Using the time program, you can wash as clean as possible in the time you have available. The washing machine ensures an optimal washing result based on your chosen time from 30 minutes to 3 hours: that is flexible, smart and time-saving. "),ie(),Ae(101,"li",13)(102,"b"),se(103,"Wool/ Hand:"),ie(),se(104," wash Program Hand and wool wash programs allow delicate garments to be washed at 40\xb0C before briefly centrifugation at low speed. We promise your favorite wool sweater has never looked so good. "),ie()()()())}pu.\u0275fac=function(e){return new(e||pu)(ke(Xs))},pu.\u0275cmp=Ml({type:pu,selectors:[["app-object-viewer"]],viewQuery:function(e,t){if(1&e&&(Wm(mj,5),Wm(gj,5)),2&e){let i;Md(i=Sd())&&(t.canvasRef=i.first),Md(i=Sd())&&(t.containerRef=i.first)}},inputs:{fieldOfView:"fieldOfView",nearClippingPane:["nearClipping","nearClippingPane"],farClippingPane:["farClipping","farClippingPane"]},decls:5,vars:0,consts:[[2,"position","relative","height","50vh","width","100%"],["container",""],["id","canvas",2,"height","50vh","width","100%"],["canvas",""]],template:function(e,t){1&e&&(Ae(0,"div",0,1),es(2,"canvas",2,3),ie(),es(4,"router-outlet"))},dependencies:[lh]});class mu{constructor(e){this.interactionService=e,this.selectedInfo=0}ngOnInit(){this.interactionService.selectedInfo$.subscribe(e=>{this.selectedInfo=e})}}mu.\u0275fac=function(e){return new(e||mu)(ke(Xs))},mu.\u0275cmp=Ml({type:mu,selectors:[["app-root"]],decls:18,vars:5,consts:[[1,"container"],[1,"mb-4","mt-4"],[1,"badge","bg-secondary"],[1,"card","mb-2"],[1,"card-body"],["role","alert",1,"alert","alert-info"],[1,"bi","bi-info-circle"],[1,"viewer"],["class","card mt-3 mb-3",4,"ngIf"],[1,"card","mt-3","mb-3"],[1,"card-title"],[1,"card-text"],[1,"card-text","list-group"],[1,"list-group-item"]],template:function(e,t){1&e&&(Ae(0,"div",0)(1,"h1",1),se(2," Digital Twin - Retail"),Ae(3,"span",2),se(4,"Beta"),ie()(),Ae(5,"div",3)(6,"div",4),se(7,"Proof of concept - design is subject to change"),ie()(),Ae(8,"div",5),es(9,"i",6),se(10," Click on a label of the model to discover more information about it "),ie(),es(11,"app-object-viewer",7),ua(12,yj,6,0,"div",8),ua(13,vj,6,0,"div",8),ua(14,_j,6,0,"div",8),ua(15,xj,57,0,"div",8),ua(16,wj,105,0,"div",8),es(17,"router-outlet"),ie()),2&e&&(Jo(12),Bs("ngIf",4==t.selectedInfo),Jo(1),Bs("ngIf",2==t.selectedInfo),Jo(1),Bs("ngIf",1==t.selectedInfo),Jo(1),Bs("ngIf",5==t.selectedInfo),Jo(1),Bs("ngIf",3==t.selectedInfo))},dependencies:[HS,lh,pu],styles:[".viewer[_ngcontent-%COMP%]{width:100%;height:50vh;display:block;overflow:hidden;margin:auto}"]});class ml{}ml.\u0275fac=function(e){return new(e||ml)},ml.\u0275mod=Ts({type:ml,bootstrap:[mu]}),ml.\u0275inj=Yr({imports:[pB,Ca]}),fB().bootstrapModule(ml).catch(n=>console.error(n))}},It=>{It(It.s=41)}]);